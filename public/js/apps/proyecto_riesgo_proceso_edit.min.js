(function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c="function"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error("Cannot find module '"+i+"'");throw a.code="MODULE_NOT_FOUND",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u="function"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()({1:[function(require,module,exports){
'use strict';

var DRAW_IFRAME_URL = 'https://www.draw.io/?embed=1&proto=json&lang=es';
var graph = null;
var xml = null;
var doc = document.documentElement.outerHTML;
function edit(target) {
    $.blockUI();
    setTimeout(function () {
        $.unblockUI();
    }, 3000);
    var border = 0;
    var iframe = document.createElement('iframe');
    iframe.style.zIndex = '9999';
    iframe.style.position = 'absolute';
    iframe.style.top = border + 'px';
    iframe.style.left = border + 'px';
    if (border == 0) {
        iframe.setAttribute('frameborder', '0');
    }
    var close = function close() {
        window.removeEventListener('message', receive);
        document.body.removeChild(iframe);
    };
    var resize = function resize() {
        iframe.setAttribute('width', "" + (document.body.clientWidth - 2 * border));
        iframe.setAttribute('height', "" + (document.body.clientHeight - 2 * border));
    };
    window.addEventListener('resize', resize);
    resize();
    var receive = function receive(evt) {
        if (evt.data.length > 0) {
            var msg = JSON.parse(evt.data);
            if (msg.event == "init") {
                var imgdata = '';
                if ($("#procesoimgcontainer-" + target + " img").length > 0) {
                    imgdata = $("#procesoimgcontainer-" + target + " img").attr('src');
                }
                iframe.contentWindow.postMessage(JSON.stringify({ action: 'load', autosave: 1, xmlpng: imgdata }), '*');
                resize();
            } else if (msg.event == 'export') {
                $("#procesoimg-" + target).val(msg.data);
                $("#procesoimgcontainer-" + target).html("<img src=\"" + msg.data + "\" />");
                var form = $("#procesoimg-" + target).closest('form');
                form.find('button').show();
                form.addClass('changed');
            } else if (msg.event == 'autosave' || msg.event == "save") {
                iframe.contentWindow.postMessage(JSON.stringify({ action: 'export', format: 'xmlpng', xml: msg.xml }), '*');
            } else if (msg.event == 'exit') {
                close();
            }
        }
    };
    window.addEventListener('message', receive);
    iframe.setAttribute('src', DRAW_IFRAME_URL);
    document.body.appendChild(iframe);
}
$('#tabpane-procesos').on('click', '.btn-edit-procesomap', function () {
    edit($(this).attr('data-href').substr(1));
});
$('#tabpane-procesos').on('click', '.btn-submit', function () {
    $(this).closest('form').removeClass('changed');
});

},{}]},{},[1]);
