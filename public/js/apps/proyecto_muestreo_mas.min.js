!function s(n,u,i){function c(e,a){if(!u[e]){if(!n[e]){var t="function"==typeof require&&require;if(!a&&t){return t(e,!0)}if(l){return l(e,!0)}var r=new Error("Cannot find module '"+e+"'");throw r.code="MODULE_NOT_FOUND",r}var o=u[e]={exports:{}};n[e][0].call(o.exports,function(a){return c(n[e][1][a]||a)},o,o.exports,s,n,u,i)}return u[e].exports}for(var l="function"==typeof require&&require,a=0;a<i.length;a++){c(i[a])}return c}({1:[function(a,e,t){"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),(r=t.MuestreoType||(t.MuestreoType={})).Mas="mas",r.Mum="mum";var o=(n.formatNumber=function(a,e){return void 0===e&&(e=0),isNaN(a)?"0":accounting.formatNumber(a,e)},n.prototype.configurar_wizard=function(){var e=this;$("#pane-"+this.type+"-evaluacion .btn-next").on("click",function(a){a.preventDefault(),0<$("#table-muestreo-"+e.type+"-evaluacion .muestra-v-real input").filter(function(){return""==$(this).val()}).length?bootbox.alert("Debe ingresar el Valor según Auditoría de <u>TODOS</u> los documentos de la muestra para continuar."):$(this.hash).tab("show")}),$("#mainpane-"+this.type).find(".btn-next, .btn-back").not("#pane-"+this.type+"-evaluacion .btn-next").on("click",function(a){a.preventDefault(),$(this.hash).tab("show")})},n.prototype.completar_cache_muestras=function(a){var e=this;_.forEach(a,function(a){void 0!==e.cache_muestras[a.cod]&&""!==e.cache_muestras[a.cod]||(e.cache_muestras[a.cod]=a.r)})},n.prototype.calcular_valor_error_en_evaluacion=function(a){a.find(".muestra-v-diff, .muestra-v-diff-p").html("");var e=a.find(".muestra-cod input:hidden").val();if(""!==a.find(".muestra-v-real input").val()){var t=+a.find(".muestra-v input:hidden").val(),r=+a.find(".muestra-v-real input").autoNumeric("get");if(!isNaN(r)){var o=t-r,s=0!=t?100*o/t:0;a.find(".muestra-v-diff").html(n.formatNumber(o)).data("valor",o),a.find(".muestra-v-diff-p").html(Math.floor(s)+"%"),this.cache_muestras[e]=r}}else{this.cache_muestras[e]=""}},n.prototype.guardar_cambios_muestras=function(){var a=url_for("proyecto_muestreo/"+app.vars.ID_MUESTREO+"/config"),o=[];$("#table-muestreo-"+this.type+"-evaluacion tbody tr").each(function(a){var e=$(this).find(".muestra-cod input").val(),t=_.find(app.vars.muestras,{cod:e}).v,r=$(this).find(".muestra-v-real input").autoNumeric("get");o.push({cod:e,v:t,r:r})}),$.post(a,{muestras:o,t:this.type},$.noop,"json")},n);function n(a){this.cache_muestras={},this.guardar_cambios_muestreo=function(a,e){void 0===e&&(e=!0);var t=this,r=url_for("proyecto_muestreo/"+app.vars.ID_MUESTREO+"/config"),o={};if(1<a.length){o={fields:[],t:this.type},a.each(function(){o.fields.push({field:$(this).prop("name").substr(7),value:$(this).val()})})}else{if(1!=a.length){return}o={field:a.prop("name").substr(7),value:a.val(),t:this.type}}$.post(r,o,function(){e&&t.guardar_cambios_muestras()})},this.type=a,this.configurar_wizard()}t.BaseMuestreo=o},{}],2:[function(a,e,t){"use strict";var r,o=(r=function(a,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,e){a.__proto__=e}||function(a,e){for(var t in e){e.hasOwnProperty(t)&&(a[t]=e[t])}})(a,e)},function(a,e){function t(){this.constructor=a}r(a,e),a.prototype=null===e?Object.create(e):(t.prototype=e.prototype,new t)});Object.defineProperty(t,"__esModule",{value:!0});var s,c=a("./_proyecto_muestreo_base"),n=(s=c.BaseMuestreo,o(u,s),u.prototype.calcular_tamano_muestra=function(){$("#mainpane-mas .cf-1").html('<span class="ajax-loader-snake"></span> ');var a=+$("#cf-n").data("valor"),e=+$("#cf-p select").val(),t=Math.round(10*(1-e))/10,r=+$("#cf-z select").val(),o=+$("#cf-e select").val(),s=e*t,n=Math.abs(jStat.studentt.inv((1-r)/2,1e5)),u=Math.pow(o/100/n,2),i=s/a,c=Math.round(s/(u+i));return $("#mainpane-mas .cf-1").html(""+c),$("#mas-config_cf_1").val(c),$("#cf-q").html(t+"%"),c},u.prototype.generar_tabla_muestra=function(a){var e=$("#table-muestreo-mas-evaluacion"),t=$("#muestreo-evaluacion-row-template").html();e.find("tbody").html("");var r=[];a instanceof Array?(r=_.clone(a,!0),a=a.length):(r=_.clone(app.vars.muestras,!0),r=_.shuffle(r),r=_.take(r,a),r=_.sortBy(r,"cod"));for(var o=0,s=0;s<a;s++){var n=r[s];n.r&&""+n.r!=""||!this.cache_muestras[n.cod]||(n.r=this.cache_muestras[n.cod]);var u=_.template(t)({item:n,k:s,type:this.type}),i=$(u).appendTo(e.find("tbody"));i.find(".muestra-v-real input").autoNumeric("init",{decimalCharacter:",",minimumValue:-9999999999999,maximumValue:9999999999999,digitGroupSeparator:".",unformatOnSubmit:!0}),o+=Math.floor(n.v),n.r&&this.calcular_valor_error_en_evaluacion(i)}$(".total-v").html(c.BaseMuestreo.formatNumber(o)).data("valor",o),this.calcular_totales_en_evaluacion()},u.prototype.calcular_totales_en_evaluacion=function(){var a=this,e=$("#mainpane-"+this.type),t=0;$("#"+this.type+"-total-v-real").html(function(){return $("#table-muestreo-"+a.type+"-evaluacion").find(".muestra-v-real input").each(function(){var a=+$(this).autoNumeric("get");isNaN(a)||(t+=a)}),c.BaseMuestreo.formatNumber(t)});var r=0;$("#table-muestreo-"+this.type+"-evaluacion").find(".muestra-v-diff").each(function(){var a=+$(this).data("valor");isNaN(a)||(r+=a)}),e.find(".total-v-diff").html(c.BaseMuestreo.formatNumber(r));var o=+$("#"+this.type+"-total-v").data("valor"),s=0!=o?100*r/o:0,n=+$("#cf-m").data("valor");e.find(".error_tolerable").html(c.BaseMuestreo.formatNumber(n*$("#cf-e select").val()/100)),$("#"+this.type+"-total-v-real-diff-p").html(Math.floor(s)+"%");var u=n*r/o;$("#pry-1").html(c.BaseMuestreo.formatNumber(u)),$("#mas-config_pry_1").val(u);var i=100*u/n;$("#pry-2").html(c.BaseMuestreo.formatNumber(i)+"%"),$("#mas-config_pry_2").val(i),n*$("#cf-e select").val()/100<u?($("#pry-3").html("SI").addClass("error_muestral"),$("#mas-config_pry_3").val("SI")):($("#pry-3").html("NO").removeClass("error_muestral"),$("#mas-config_pry_3").val("NO")),a.guardar_cambios_muestreo($("#mas-hidden_config_values input"),!1)},u);function u(){return s.call(this,c.MuestreoType.Mas)||this}$(function(){var e=new n;if($("#table-muestreo-mas").on("change",".col-numeric input, .col-numeric select",function(){var a=e.calcular_tamano_muestra();e.generar_tabla_muestra(a),e.guardar_cambios_muestreo($(this))}),_.has(app.vars.muestreo_config,"muestras.mas")){var a=app.vars.muestreo_config.muestras.mas;e.calcular_tamano_muestra(),_.has(app.vars.muestreo_config,"muestras.mum")&&e.completar_cache_muestras(app.vars.muestreo_config.muestras.mum),e.generar_tabla_muestra(a)}else{var t=e.calcular_tamano_muestra();_.has(app.vars.muestreo_config,"muestras.mum")&&e.completar_cache_muestras(app.vars.muestreo_config.muestras.mum),e.generar_tabla_muestra(t)}$("#table-muestreo-mas-evaluacion").on("change","input",function(){e.calcular_valor_error_en_evaluacion($(this).closest("tr")),e.calcular_totales_en_evaluacion(),e.guardar_cambios_muestras()}),$("#table-muestreo-mas").on("change","#cf-e select",function(){e.calcular_totales_en_evaluacion()}),$("#mas-conclusion-custom").on("change",function(){e.guardar_cambios_muestreo($(this),!1)}),$("#tab-mas-conclusion").on("click",function(a){if(0<$("#table-muestreo-mas-evaluacion .muestra-v-real input").filter(function(){return""==$(this).val()}).length){return a.preventDefault(),a.stopPropagation(),bootbox.alert("Debe ingresar primero el Valor según Auditoría de <u>TODAS</u> las operaciones de la muestra para continuar."),$("#tab-mas-evaluacion").tab("show"),!1}})})},{"./_proyecto_muestreo_base":1}]},{},[2]);
//# sourceMappingURL=proyecto_muestreo_mas.min.js.map
