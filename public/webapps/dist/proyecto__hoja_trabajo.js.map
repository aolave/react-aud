{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./src/global/AuthorIconLog.tsx","webpack:///./src/global/ButtonEdit.tsx","webpack:///./src/global/EditorPreview.tsx","webpack:///./src/global/ErrorHandler.tsx","webpack:///./src/global/InputAutoNumeric.tsx","webpack:///./src/global/StatusButtonAction.tsx","webpack:///./src/global/Tooltip.tsx","webpack:///./src/proyecto__hoja_trabajo/App.tsx","webpack:///./src/proyecto__hoja_trabajo/AppPeriodo.tsx","webpack:///./src/proyecto__hoja_trabajo/AppVisitaTab.tsx","webpack:///./src/proyecto__hoja_trabajo/Attachments.tsx","webpack:///./src/proyecto__hoja_trabajo/HojaTrabajoContext.ts","webpack:///./src/proyecto__hoja_trabajo/MenuSidebarVisita.tsx","webpack:///./src/proyecto__hoja_trabajo/TabPaneVisita.tsx","webpack:///./src/proyecto__hoja_trabajo/TabPaneVisitaBase.tsx","webpack:///./src/proyecto__hoja_trabajo/TabPaneVisitaModals.tsx","webpack:///./src/proyecto__hoja_trabajo/TableRowInstruccion.tsx","webpack:///./src/proyecto__hoja_trabajo/index.tsx","webpack:///./src/proyecto__hoja_trabajo/sidebar/ajuste_list.tsx","webpack:///./src/proyecto__hoja_trabajo/sidebar/ajuste_modal.tsx","webpack:///./src/proyecto__hoja_trabajo/sidebar/hallazgo_edit.tsx","webpack:///./src/proyecto__hoja_trabajo/sidebar/hallazgo_list.tsx","webpack:///./src/proyecto__hoja_trabajo/sidebar/hallazgo_modal.tsx","webpack:///./src/proyecto__hoja_trabajo/sidebar/menuitem.tsx","webpack:///./src/proyecto__hoja_trabajo/sidebar/menuitem__model_manager.ts","webpack:///./src/proyecto__hoja_trabajo/sidebar/menuitem__new.tsx","webpack:///./src/proyecto__hoja_trabajo/sidebar/menuitem_ajuste.tsx","webpack:///./src/proyecto__hoja_trabajo/sidebar/menuitem_ajuste_context.ts","webpack:///./src/proyecto__hoja_trabajo/sidebar/menuitem_hallazgo.tsx","webpack:///./src/proyecto__hoja_trabajo/sidebar/menuitem_muestreo.tsx","webpack:///./src/proyecto__hoja_trabajo/sidebar/menuitem_revision.tsx","webpack:///./src/proyecto__hoja_trabajo/sidebar/panel_header.tsx","webpack:///./src/proyecto__hoja_trabajo/sidebar/revision_list.tsx","webpack:///./src/proyecto__hoja_trabajo/utils.ts","webpack:///./src/proyecto__hoja_trabajo/utils_ajuste.ts","webpack:///./src/proyecto__hoja_trabajo/utils_hallazgo.ts","webpack:///./src/proyecto__hoja_trabajo/utils_truncate.ts","webpack:///./src/proyecto__muestreo/AppMuestreoMas.tsx","webpack:///./src/proyecto__muestreo/AppMuestreoMum.tsx","webpack:///./src/proyecto__muestreo/TableMuestra.tsx","webpack:///./src/proyecto__muestreo/utils_mas.ts","webpack:///./src/proyecto__muestreo/utils_mum.ts","webpack:///./src/proyecto__muestreo/utis.ts","webpack:///external \"React\"","webpack:///external \"ReactDOM\""],"names":[],"mappings":"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","file":"proyecto__hoja_trabajo.js","sourcesContent":[" \t// install a JSONP callback for chunk loading\n \tfunction webpackJsonpCallback(data) {\n \t\tvar chunkIds = data[0];\n \t\tvar moreModules = data[1];\n \t\tvar executeModules = data[2];\n\n \t\t// add \"moreModules\" to the modules object,\n \t\t// then flag all \"chunkIds\" as loaded and fire callback\n \t\tvar moduleId, chunkId, i = 0, resolves = [];\n \t\tfor(;i < chunkIds.length; i++) {\n \t\t\tchunkId = chunkIds[i];\n \t\t\tif(Object.prototype.hasOwnProperty.call(installedChunks, chunkId) && installedChunks[chunkId]) {\n \t\t\t\tresolves.push(installedChunks[chunkId][0]);\n \t\t\t}\n \t\t\tinstalledChunks[chunkId] = 0;\n \t\t}\n \t\tfor(moduleId in moreModules) {\n \t\t\tif(Object.prototype.hasOwnProperty.call(moreModules, moduleId)) {\n \t\t\t\tmodules[moduleId] = moreModules[moduleId];\n \t\t\t}\n \t\t}\n \t\tif(parentJsonpFunction) parentJsonpFunction(data);\n\n \t\twhile(resolves.length) {\n \t\t\tresolves.shift()();\n \t\t}\n\n \t\t// add entry modules from loaded chunk to deferred list\n \t\tdeferredModules.push.apply(deferredModules, executeModules || []);\n\n \t\t// run deferred modules when all chunks ready\n \t\treturn checkDeferredModules();\n \t};\n \tfunction checkDeferredModules() {\n \t\tvar result;\n \t\tfor(var i = 0; i < deferredModules.length; i++) {\n \t\t\tvar deferredModule = deferredModules[i];\n \t\t\tvar fulfilled = true;\n \t\t\tfor(var j = 1; j < deferredModule.length; j++) {\n \t\t\t\tvar depId = deferredModule[j];\n \t\t\t\tif(installedChunks[depId] !== 0) fulfilled = false;\n \t\t\t}\n \t\t\tif(fulfilled) {\n \t\t\t\tdeferredModules.splice(i--, 1);\n \t\t\t\tresult = __webpack_require__(__webpack_require__.s = deferredModule[0]);\n \t\t\t}\n \t\t}\n\n \t\treturn result;\n \t}\n\n \t// The module cache\n \tvar installedModules = {};\n\n \t// object to store loaded and loading chunks\n \t// undefined = chunk not loaded, null = chunk preloaded/prefetched\n \t// Promise = chunk loading, 0 = chunk loaded\n \tvar installedChunks = {\n \t\t\"proyecto__hoja_trabajo\": 0\n \t};\n\n \tvar deferredModules = [];\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \tvar jsonpArray = window[\"webpackJsonpwebpackLibs\"] = window[\"webpackJsonpwebpackLibs\"] || [];\n \tvar oldJsonpFunction = jsonpArray.push.bind(jsonpArray);\n \tjsonpArray.push = webpackJsonpCallback;\n \tjsonpArray = jsonpArray.slice();\n \tfor(var i = 0; i < jsonpArray.length; i++) webpackJsonpCallback(jsonpArray[i]);\n \tvar parentJsonpFunction = oldJsonpFunction;\n\n\n \t// add entry module to deferred list\n \tdeferredModules.push([\"./src/proyecto__hoja_trabajo/index.tsx\",\"vendors~proyecto__hoja_trabajo\"]);\n \t// run deferred modules when ready\n \treturn checkDeferredModules();\n","/// <reference path=\"../@types/global/AuthorIconLog.d.ts\" />\r\n\r\nimport { Component } from 'react'\r\nimport classnames from 'classnames'\r\n\r\nimport Icon from 'semantic-ui-react/dist/commonjs/elements/Icon/Icon'\r\nimport Button from 'semantic-ui-react/dist/commonjs/elements/Button/Button'\r\nimport Loader from 'semantic-ui-react/dist/commonjs/elements/Loader/Loader'\r\nimport Popup from 'semantic-ui-react/dist/commonjs/modules/Popup/Popup'\r\nimport Dimmer from 'semantic-ui-react/dist/commonjs/modules/Dimmer/Dimmer'\r\n\r\nexport class AuthorIconLog extends Component<AuthorIconLogProps, {}> {\r\n  render() {\r\n    let classes: string | string[] = [ 'author-icon-log' ]\r\n\r\n    if (this.props.className) {\r\n      classes.push(this.props.className)\r\n    }\r\n    if (this.props.inline) {\r\n      classes.push('inline')\r\n    }\r\n\r\n    classes = classnames(classes, this.props.size)\r\n\r\n    let icon = (\r\n      <Icon\r\n        name='user circle'\r\n        size={this.props.size}\r\n        color={_.size(this.props.log) == 0 ? null : this.props.iconColor}\r\n        disabled={_.size(this.props.log) == 0}\r\n      />\r\n    )\r\n    if (this.props.alertText) {\r\n      icon = (\r\n        <Icon.Group>\r\n          {icon}\r\n          <Icon corner='top right' color='red' name='warning circle' />\r\n        </Icon.Group>\r\n      )\r\n    }\r\n\r\n    let iconComp\r\n    if (!this.props.inline) {\r\n      iconComp = (\r\n        <div>\r\n          {this.props.label && <span className='lb'>{this.props.label}</span>}\r\n          {icon}\r\n        </div>\r\n      )\r\n    } else {\r\n      const item = this.props.log == null ? null : this.props.log[0]\r\n      iconComp = (\r\n        <div>\r\n          {this.props.label && <span className='lb'>{this.props.label}</span>}\r\n          {icon}\r\n          {this.props.alertText && (\r\n            <span className='alert-text'>\r\n              <Icon color='red' name='warning circle' /> {this.props.alertText}\r\n            </span>\r\n          )}\r\n          {item && (\r\n            <div className='content user-info'>\r\n              <div className='user-sigla'>{item.User.sigla}</div>\r\n              <time dateTime={Date.create(item.ts).format('{year}-{MM}-{dd}')}>\r\n                {Date.create(item.ts).format('{year}-{MM}-{dd}')}\r\n              </time>\r\n            </div>\r\n          )}\r\n        </div>\r\n      )\r\n    }\r\n\r\n    return (\r\n      <div className={classes}>\r\n        <Popup\r\n          trigger={iconComp}\r\n          position='bottom center'\r\n          className='author-icon-log-popup'\r\n          pinned\r\n          size={this.props.size}\r\n        >\r\n          <Popup.Header>\r\n            {this.props.name}\r\n            {this.props.alertText && (\r\n              <div className='alert-text'>\r\n                <Icon color='red' name='warning circle' /> {this.props.alertText}\r\n              </div>\r\n            )}\r\n          </Popup.Header>\r\n          <Popup.Content>\r\n            {this.props.log == null ? (\r\n              <div className='label'>Sin Especificar</div>\r\n            ) : (\r\n              <table className='table nowrap'>\r\n                <tbody>\r\n                  {this.props.log.map((item, k) => {\r\n                    return (\r\n                      <tr key={k}>\r\n                        <td>\r\n                          {icon} {item.User.name} ({item.User.sigla})\r\n                        </td>\r\n                        <td>\r\n                          <em>{Date.create(item.ts).format('{year}-{MM}-{dd}')}</em>\r\n                        </td>\r\n                      </tr>\r\n                    )\r\n                  })}\r\n                </tbody>\r\n              </table>\r\n            )}\r\n          </Popup.Content>\r\n        </Popup>\r\n      </div>\r\n    )\r\n  }\r\n}\r\n\r\nexport class AuthorIconLogEditable extends Component<AuthorIconLogEditableProps, AuthorIconLogEditableState> {\r\n  state = {\r\n    isLoading: false\r\n  }\r\n\r\n  static defaultProps = {\r\n    disableEdit: false\r\n  }\r\n\r\n  onClickEdit = (ev: React.SyntheticEvent) => {\r\n    ev.preventDefault()\r\n    this.setState({ isLoading: true })\r\n    this.props.onClickEdit()\r\n  }\r\n\r\n  render() {\r\n    let classes: string | string[] = [ 'author-icon-log' ]\r\n\r\n    if (this.props.className) {\r\n      classes.push(this.props.className)\r\n    }\r\n\r\n    classes = classnames(classes, this.props.size)\r\n\r\n    const icon = (\r\n      <Icon\r\n        name='user circle'\r\n        size={this.props.size}\r\n        color={this.props.log == null ? null : this.props.iconColor}\r\n        disabled={this.props.log == null}\r\n      />\r\n    )\r\n\r\n    const iconComp = (\r\n      <div style={{ position: 'relative' }}>\r\n        <Dimmer inverted active={this.state.isLoading}>\r\n          <Loader inverted />\r\n        </Dimmer>\r\n        {this.props.label && <span className='lb'>{this.props.label}</span>}\r\n        {icon}\r\n        <Button\r\n          className='action edit'\r\n          disabled={this.props.disableEdit}\r\n          compact\r\n          size='mini'\r\n          color={this.props.iconColor}\r\n          onClick={this.onClickEdit}\r\n        >\r\n          {this.props.editText}\r\n        </Button>\r\n      </div>\r\n    )\r\n\r\n    return (\r\n      <div className={classes}>\r\n        <Popup trigger={iconComp} position='bottom center' pinned size={this.props.size}>\r\n          <Popup.Header content={this.props.name} />\r\n          <Popup.Content>\r\n            {this.props.log == null ? (\r\n              <div className='label'>Sin Especificar</div>\r\n            ) : (\r\n              <table className='table nowrap'>\r\n                <tbody>\r\n                  {this.props.log.map((item, k) => {\r\n                    return (\r\n                      <tr key={k}>\r\n                        <td>\r\n                          {icon} {item.User.name} ({item.User.sigla})\r\n                        </td>\r\n                        <td>\r\n                          <em>{Date.create(item.ts).format('{year}-{MM}-{dd}')}</em>\r\n                        </td>\r\n                      </tr>\r\n                    )\r\n                  })}\r\n                </tbody>\r\n              </table>\r\n            )}\r\n          </Popup.Content>\r\n        </Popup>\r\n      </div>\r\n    )\r\n  }\r\n}\r\n\r\ntype AuthorIconLogDefaultWrapperProps = {\r\n  model: Partial<IAuthorLog>\r\n  size?: 'huge' | 'large' | 'small' | 'mini' | 'tiny'\r\n  className?: string\r\n}\r\n\r\nexport class AuthorIconLogDefaultWrapper extends Component<AuthorIconLogDefaultWrapperProps> {\r\n  render() {\r\n    const { model } = this.props\r\n\r\n    const alertTextRevisado =\r\n      model.fecha_completado &&\r\n      model.fecha_revision &&\r\n      Date.create(model.fecha_completado) > Date.create(model.fecha_revision)\r\n        ? 'Modificado despues de Revisado'\r\n        : null\r\n\r\n    return (\r\n      <div className={classnames('author-icon-log-wrapper', this.props.size, this.props.className)}>\r\n        <AuthorIconLog log={model.UpdateLog} name='Preparado por' label='P' iconColor='green' size={this.props.size} />\r\n        <AuthorIconLog\r\n          log={model.RevisionLog}\r\n          name='Revisado por'\r\n          label='R'\r\n          iconColor='olive'\r\n          size={this.props.size}\r\n          alertText={alertTextRevisado}\r\n        />\r\n      </div>\r\n    )\r\n  }\r\n}\r\n","import Button from 'semantic-ui-react/dist/commonjs/elements/Button'\r\nimport Icon from 'semantic-ui-react/dist/commonjs/elements/Icon/Icon'\r\nimport cx from 'classnames'\r\n\r\nconst ButtonEdit = (props: any) => {\r\n  let { children, ...buttonProps } = props\r\n  buttonProps.className = cx(buttonProps.className, 'action')\r\n  buttonProps = { icon: true, basic: true, compact: true, size: 'mini', title: 'Editar', ...buttonProps }\r\n\r\n  if (typeof children == 'undefined') {\r\n    children = <Icon name='pencil square' color='green' size='large' />\r\n  }\r\n\r\n  return (\r\n    <Button {...buttonProps} type='button'>\r\n      {children}\r\n    </Button>\r\n  )\r\n}\r\n\r\nexport default ButtonEdit\r\n","import { PureComponent, Fragment, createRef, SyntheticEvent } from 'react'\r\n\r\nimport Modal from 'semantic-ui-react/dist/commonjs/modules/Modal/Modal'\r\n\r\nimport { instance as eventStack } from '@semantic-ui-react/event-stack'\r\nimport keyboardKey from 'keyboard-key'\r\nimport CKeditor from 'ckeditor4-react'\r\nimport cx from 'classnames'\r\n\r\nimport ButtonEdit from './ButtonEdit'\r\nimport { AttachmentListPanel, cleanAttachmentFrom } from '../proyecto__hoja_trabajo/Attachments'\r\n\r\ndeclare var app: any\r\n\r\nconst CKEDITOR_OPTIONS: any = {\r\n  basic: {\r\n    height: 150,\r\n    toolbar: [\r\n      { name: 'basicstyles', groups: [ 'basicstyles', 'cleanup' ], items: [ 'Bold', 'Italic' ] },\r\n      {\r\n        name: 'paragraph',\r\n        groups: [ 'list', 'indent', 'blocks', 'align', 'bidi' ],\r\n        items: [ 'NumberedList', 'BulletedList', '-', 'Outdent', 'Indent', '-', 'TextColor' ]\r\n      }\r\n    ],\r\n    autoParagraph: false,\r\n    removePlugins: 'elementspath, uploadfile, uploadfileab, resize',\r\n    extraPlugins: 'openlink'\r\n  }\r\n}\r\n\r\nexport default class EditorPreview extends PureComponent<EditorPreviewProps, EditorPreviewState> {\r\n  private ckeditorComp: React.RefObject<CKeditorComp>\r\n  private _cachedEditor: CKEDITOR.editor\r\n\r\n  private previewRef = createRef<HTMLDivElement>()\r\n\r\n  private autosaveId: NodeJS.Timeout\r\n\r\n  static AUTOSAVE_DELAY: number = 60\r\n\r\n  static defaultProps = {\r\n    open: false,\r\n    autosave: false,\r\n    required: false,\r\n    editable: true,\r\n    openOnClickPreview: true,\r\n    ckeditorOptions: {}\r\n  }\r\n\r\n  constructor(props: EditorPreviewProps) {\r\n    super(props)\r\n\r\n    this.state = {\r\n      isModalEditOpen: this.props.open,\r\n      isAutosaving: false,\r\n      isLoading: true,\r\n      attachments: null,\r\n      isLoadingAttachments: false\r\n    }\r\n  }\r\n\r\n  handleEscape = (e: Event) => {\r\n    if (keyboardKey.getCode(e) !== keyboardKey.Escape) return\r\n\r\n    if (typeof CKEDITOR !== 'undefined' && CKEDITOR.dialog.getCurrent() != null) {\r\n      // si existe un CKEditor dialog abierto, no cerrar el modal.\r\n      return\r\n    }\r\n\r\n    this.onClose()\r\n  }\r\n\r\n  getEditor(): CKEDITOR.editor {\r\n    if (this.ckeditorComp != null) {\r\n      return (this.ckeditorComp as any).editor\r\n    }\r\n\r\n    if (this._cachedEditor) {\r\n      return this._cachedEditor\r\n    }\r\n\r\n    return null\r\n  }\r\n\r\n  onChange = (evt: any) => {\r\n    if (this.props.inline) {\r\n      this.props.onSave(evt.editor, false, false)\r\n    }\r\n\r\n    if (!this._cachedEditor) {\r\n      this._cachedEditor = evt.editor\r\n    }\r\n\r\n    if (!this.props.autosave) {\r\n      return\r\n    }\r\n\r\n    if (!this.autosaveId) {\r\n      this.autosaveId = setTimeout(this.autosave, EditorPreview.AUTOSAVE_DELAY * 1000)\r\n    }\r\n  }\r\n\r\n  onClickEdit = (ev: SyntheticEvent) => {\r\n    ev.preventDefault()\r\n    this.setState({ isModalEditOpen: true, isLoading: true })\r\n  }\r\n\r\n  onSave = () => {\r\n    if (this.autosaveId) {\r\n      clearTimeout(this.autosaveId)\r\n      this.autosaveId = null\r\n    }\r\n\r\n    if ($.isFunction(this.props.onSave)) {\r\n      this.props.onSave(this.getEditor(), true, false, () => {\r\n        this.setState({ isAutosaving: false })\r\n        this.fetchAttachments()\r\n      })\r\n\r\n      this.setState({ isModalEditOpen: false })\r\n    } else {\r\n      this.setState({ isModalEditOpen: false, isAutosaving: false })\r\n      this.fetchAttachments()\r\n    }\r\n  }\r\n\r\n  onCancel = () => {\r\n    this.setState({ isModalEditOpen: false })\r\n    if ($.isFunction(this.props.onClose)) {\r\n      this.props.onClose()\r\n    }\r\n  }\r\n\r\n  onClose = () => {\r\n    if (this.autosaveId) {\r\n      clearInterval(this.autosaveId)\r\n      this.autosaveId = null\r\n    }\r\n\r\n    this.setState({ isModalEditOpen: false })\r\n    if ($.isFunction(this.props.onClose)) {\r\n      this.props.onClose()\r\n    }\r\n  }\r\n\r\n  onModalMount = () => {\r\n    eventStack.sub('keydown', this.handleEscape, { pool: 'default' })\r\n\r\n    if (this.state.attachments == null) {\r\n      this.fetchAttachments()\r\n    }\r\n  }\r\n\r\n  autosave = () => {\r\n    this.setState({ isAutosaving: true })\r\n    let ckeditor = this.getEditor()\r\n    if (ckeditor != null) {\r\n      this.props.onSave(ckeditor, false, true, () => this.setState({ isAutosaving: false }))\r\n      this.fetchAttachments()\r\n    }\r\n\r\n    if (this.autosaveId) {\r\n      clearInterval(this.autosaveId)\r\n      this.autosaveId = null\r\n    }\r\n  }\r\n\r\n  assertRequired() {\r\n    if (!this.props.editable) {\r\n      return false\r\n    }\r\n    if (!this.props.required) {\r\n      return false\r\n    }\r\n\r\n    const ckeditor = this.getEditor()\r\n\r\n    if (_.trim(ckeditor.getData()) != '') {\r\n      return false\r\n    }\r\n\r\n    bootbox.alert('Esta campo es requerido, por lo tanto no puede quedar vacío.')\r\n\r\n    return true\r\n  }\r\n\r\n  componentWillReceiveProps(nextProps: EditorPreviewProps) {\r\n    if (nextProps.open && !this.state.isModalEditOpen) {\r\n      this.setState({ isModalEditOpen: true })\r\n    }\r\n  }\r\n\r\n  componentDidMount() {\r\n    $(this.previewRef.current).find('a[href]').each(function() {\r\n      $(this).attr('target', '_blank')\r\n    })\r\n  }\r\n\r\n  onClickPreview = (ev: SyntheticEvent) => {\r\n    if (this.props.onClickPreview) {\r\n      this.props.onClickPreview(ev)\r\n    }\r\n\r\n    if (this.props.openOnClickPreview && this.props.editable) {\r\n      this.setState({ isModalEditOpen: true })\r\n    }\r\n  }\r\n\r\n  parseCkeditorOptions() {\r\n    let { ckeditorOptions } = this.props\r\n\r\n    if (typeof ckeditorOptions == 'string') {\r\n      ckeditorOptions = CKEDITOR_OPTIONS[ckeditorOptions]\r\n    }\r\n\r\n    if (typeof this.props.ckeditorUploadOptions !== 'undefined') {\r\n      const defaultUrl = 'proyecto/' + app.vars.idproyecto + '/adjunto/upload'\r\n      const { url = defaultUrl, model, modelId } = this.props.ckeditorUploadOptions\r\n\r\n      if (modelId === null || modelId === undefined) {\r\n        ckeditorOptions.removePlugins = 'elementspath,uploadimage,uploadfile,uploadfileab'\r\n      } else {\r\n        ckeditorOptions.uploadUrl = url_for(`${url}?model=${model}&model_id=${modelId}`)\r\n        ckeditorOptions.imageUploadUrl = url_for(`${url}?model=${model}&model_id=${modelId}`)\r\n        ckeditorOptions.filebrowserUploadUrl = url_for(`${url}?model=${model}&model_id=${modelId}&n=attachment`)\r\n      }\r\n    }\r\n\r\n    return ckeditorOptions\r\n  }\r\n\r\n  fetchAttachments() {\r\n    if (typeof this.props.ckeditorUploadOptions === 'undefined') {\r\n      return\r\n    }\r\n\r\n    const { model, modelId } = this.props.ckeditorUploadOptions\r\n\r\n    this.setState({ isLoadingAttachments: true })\r\n    $.getJSON(url_for(`proyecto/${app.vars.idproyecto}/adjunto/json`), {\r\n      model: model,\r\n      model_id: modelId\r\n    }).done((res) => {\r\n      this.setState({ attachments: res.response, isLoadingAttachments: false })\r\n    })\r\n  }\r\n\r\n  onUpdateAttachment = () => {\r\n    this.fetchAttachments()\r\n  }\r\n\r\n  onDeleteAttachment = (adjunto: ProyectoAttachment, cb: () => void) => {\r\n    this.setState({ isLoadingAttachments: true })\r\n\r\n    const data = cleanAttachmentFrom(this.props.data, adjunto)\r\n\r\n    if ($.isFunction(cb)) {\r\n      cb()\r\n    }\r\n\r\n    let ckeditor = this.getEditor()\r\n    if (ckeditor) {\r\n      ckeditor.setData(data)\r\n      this.autosave()\r\n    }\r\n  }\r\n\r\n  getCkeditorOptions() {\r\n    const self = this\r\n\r\n    let ckeditorOptions = Object.assign(\r\n      {\r\n        height: 200,\r\n        toolbar: [\r\n          { name: 'clipboard', items: [ 'Cut', 'Copy', 'Paste', '-', 'Undo', 'Redo' ] },\r\n          { name: 'links', items: [ 'Link', 'pasolink', 'muestreolink', 'Attachments' ] },\r\n          { name: 'insert', items: [ 'Table', 'SpecialChar' ] },\r\n          { name: 'tools', items: [ 'Maximize' ] },\r\n          { name: 'basicstyles', items: [ 'Bold', 'Italic', 'Underline' ] },\r\n          {\r\n            name: 'paragraph',\r\n            items: [\r\n              'NumberedList',\r\n              'BulletedList',\r\n              '-',\r\n              'Outdent',\r\n              'Indent',\r\n              '-',\r\n              'JustifyLeft',\r\n              'JustifyCenter',\r\n              'JustifyRight',\r\n              'JustifyBlock',\r\n              '-',\r\n              'TextColor'\r\n            ]\r\n          },\r\n          { name: 'styles', items: [ 'Styles', 'Format' ] }\r\n        ],\r\n        autoParagraph: false,\r\n        enterMode: CKEDITOR.ENTER_BR,\r\n        removePlugins: 'elementspath',\r\n        extraPlugins:\r\n          'uploadimage,pastebase64,uploadfileab,openlink,attach,justify,colorbutton,pastefromexcel,colordialog,pasolink',\r\n        openlink_modifier: 0,\r\n        onAttachmentUpload: function(response: string, editor: CKEDITOR.editor) {\r\n          response = response\r\n            .replace('<pre>', '')\r\n            .replace('<pre style=\"word-wrap: break-word; white-space: pre-wrap;\">', '')\r\n            .replace('</pre>', '')\r\n          var rs = JSON.parse(response)\r\n          console.log(rs)\r\n          _.forEach(rs, function(r) {\r\n            if (r.uploaded) {\r\n              editor.insertHtml(\r\n                \"<a href='\" + r.url + \"' target='_blank' class='proyecto-attachment' >\" + r.fileName + '</a><br> '\r\n              )\r\n            } else {\r\n              alert(r.error)\r\n            }\r\n          })\r\n          CKEDITOR.dialog.getCurrent().hide()\r\n          if (self.props.onUpload) {\r\n            self.props.onUpload()\r\n          }\r\n          self.fetchAttachments()\r\n          const ckeditor_comp = self.getEditor()\r\n          if (ckeditor_comp) {\r\n            self.props.onSave(ckeditor_comp, false, false)\r\n          }\r\n        }\r\n      },\r\n      this.parseCkeditorOptions()\r\n    )\r\n\r\n    ckeditorOptions.on = Object.assign(\r\n      {\r\n        fileUploadRequest: function(ev: any) {\r\n          const loader = ev.data.fileLoader\r\n          loader.on('abort', function() {\r\n            $.unblockUI()\r\n          })\r\n          loader.on('error', function() {\r\n            console.log(loader)\r\n            $.unblockUI()\r\n          })\r\n          $.blockUI({\r\n            message:\r\n              '<div class=\"ajax-loader-snake-32  _a-center\"></div><h3 class=\"loading-block-text\">Cargando archivo al servidor.<br> Por favor Espere ...</h3>'\r\n          })\r\n        },\r\n        fileUploadResponse: function() {\r\n          $.unblockUI()\r\n          this.fire('change')\r\n        },\r\n        paste: (evt: any) => {\r\n          evt.data.dataValue = evt.data.dataValue.replace(/(min-)?width:.+?;/g, '') // remove width\r\n        }\r\n      },\r\n      ckeditorOptions.on || {}\r\n    )\r\n\r\n    return ckeditorOptions\r\n  }\r\n\r\n  renderFooter() {\r\n    const { footer } = this.props\r\n\r\n    if (footer === 'AttachmentList') {\r\n      return (\r\n        <AttachmentListPanel\r\n          isLoading={this.state.isLoadingAttachments}\r\n          attachments={this.state.attachments}\r\n          onUpdateItem={this.onUpdateAttachment}\r\n          onDeleteItem={this.onDeleteAttachment}\r\n        />\r\n      )\r\n    }\r\n\r\n    return footer\r\n  }\r\n\r\n  renderModal() {\r\n    if (!this.state.isModalEditOpen) {\r\n      return\r\n    }\r\n\r\n    let classNames = cx([ 'editor-preview-modal', this.props.className ? this.props.className + '-modal' : false ])\r\n\r\n    return (\r\n      <Modal\r\n        className={classNames}\r\n        open\r\n        closeIcon\r\n        closeOnDimmerClick={false}\r\n        dimmer='inverted'\r\n        onClose={this.onClose}\r\n        closeOnEscape={false}\r\n        onMount={this.onModalMount}\r\n        size='large'\r\n      >\r\n        <Modal.Content>{this.renderEditor()}</Modal.Content>\r\n        {this.props.editable ? (\r\n          <Modal.Actions>\r\n            {this.props.leftActions}\r\n            <button className='ui button negative' onClick={this.onCancel}>\r\n              Cancelar\r\n            </button>\r\n            <button className='ui button primary' onClick={this.onSave}>\r\n              Guardar\r\n            </button>\r\n          </Modal.Actions>\r\n        ) : (\r\n          <Modal.Actions>\r\n            {this.props.leftActions}\r\n            <button className='ui button negative' onClick={this.onCancel}>\r\n              Cerrar\r\n            </button>\r\n          </Modal.Actions>\r\n        )}\r\n      </Modal>\r\n    )\r\n  }\r\n\r\n  renderEditor() {\r\n    let label\r\n    if (this.props.label || this.props.labelTitle) {\r\n      label =\r\n        '<div class=\"editor-label\"> <strong class=\"editor-label-title\">' +\r\n        (this.props.labelTitle || '') +\r\n        '</strong> ' +\r\n        (this.props.label || '') +\r\n        ' </div>'\r\n    }\r\n\r\n    return (\r\n      <Fragment>\r\n        {label && <div dangerouslySetInnerHTML={{ __html: label }} />}\r\n        <div style={{ minHeight: '200px' }}>\r\n          <div className='loading'>\r\n            <div className={this.state.isAutosaving ? '' : 'ui-helper-hidden'}>\r\n              <span className='ajax-loader-snake' /> Guardando...\r\n            </div>\r\n          </div>\r\n          <div className={cx('ui dimmer inverted', { active: this.state.isLoading })}>\r\n            <div className='ui loader'>Cargando...</div>\r\n          </div>\r\n          <CKeditor\r\n            ref={(c: React.RefObject<CKeditorComp>) => (this.ckeditorComp = c)}\r\n            data={this.props.data}\r\n            config={this.getCkeditorOptions()}\r\n            onChange={this.onChange}\r\n            onInstanceReady={() => this.setState({ isLoading: false })}\r\n            readOnly={!this.props.editable}\r\n          />\r\n        </div>\r\n        {this.renderFooter()}\r\n      </Fragment>\r\n    )\r\n  }\r\n\r\n  render() {\r\n    if (this.props.inline) {\r\n      return <div className='editor-inline'> {this.renderEditor()}</div>\r\n    }\r\n\r\n    let preview = this.props.preview == null ? this.props.data || '' : this.props.preview\r\n\r\n    let classNames = cx([ 'editor-preview', this.props.className, preview ? 'text-non-empty' : 'text-empty' ])\r\n\r\n    if (this.props.prefixPreview) {\r\n      preview = '<strong class=\"editor-preview-title\" >' + this.props.prefixPreview + '</strong> ' + preview\r\n    }\r\n\r\n    preview = preview.replace(/(min-)?width:.+?;/g, '')\r\n\r\n    return (\r\n      <Fragment>\r\n        <div className={cx('editor-preview-wrapper', this.props.wrapperClassName)} onClick={this.onClickPreview}>\r\n          <div\r\n            ref={this.previewRef}\r\n            className={classNames}\r\n            dangerouslySetInnerHTML={{ __html: preview }}\r\n            style={this.props.previewStyle}\r\n          />\r\n          {this.props.editable && (\r\n            <div className='action-list'>\r\n              <ButtonEdit onClick={this.onClickEdit} />\r\n            </div>\r\n          )}\r\n        </div>\r\n        {this.renderModal()}\r\n      </Fragment>\r\n    )\r\n  }\r\n}\r\n","import { Component } from 'react'\r\n\r\ntype DefaultErrorHandlerProps = {\r\n  errorMessage?: string | JSX.Element\r\n}\r\n\r\nexport class DefaultErrorHandler extends Component<DefaultErrorHandlerProps> {\r\n  state = {\r\n    hasError: false\r\n  }\r\n\r\n  static defaultProps: Partial<DefaultErrorHandlerProps> = {\r\n    errorMessage: null\r\n  }\r\n\r\n  static getDerivedStateFromError(error: any) {\r\n    return { hasError: true }\r\n  }\r\n\r\n  componentDidCatch(error: Error, errorInfo: React.ErrorInfo) {\r\n    if (this.isLocalhost()) {\r\n      alert('ERROR: ' + error.message)\r\n    }\r\n  }\r\n\r\n  isLocalhost() {\r\n    return window.location.host === 'auditbrain.local'\r\n  }\r\n\r\n  render() {\r\n    if (this.state.hasError) {\r\n      return this.props.errorMessage\r\n    }\r\n\r\n    return this.props.children\r\n  }\r\n}\r\n","import ReactNumeric from 'react-numeric'\r\nimport AutoNumeric from 'autonumeric'\r\n\r\nconst defaultProps = {\r\n  decimalPlaces: 2,\r\n  decimalCharacter: ',',\r\n  decimalCharacterAlternative: '.',\r\n  digitGroupSeparator: '.',\r\n  allowDecimalPadding: false,\r\n  selectOnFocus: false\r\n}\r\n\r\nexport default function InputAutoNumeric(props: any) {\r\n  props = Object.assign({}, props, defaultProps)\r\n\r\n  if (typeof props.value != 'undefined' && _.size(props.value) > 0) {\r\n    props.value = +props.value\r\n  }\r\n\r\n  if (typeof props.isEditable == 'undefined' || props.isEditable) {\r\n    return <ReactNumeric {...props} />\r\n  } else {\r\n    return <span className='autonumeric non-editable value'>{AutoNumeric.format(props.value, props)}</span>\r\n  }\r\n}\r\n","import { PureComponent } from 'react'\r\n\r\nimport Popup from 'semantic-ui-react/dist/commonjs/modules/Popup/Popup'\r\nimport Button from 'semantic-ui-react/dist/commonjs/elements/Button/Button'\r\n\r\nimport cx from 'classnames'\r\n\r\ntype ButtonActionProps = {\r\n  onClick: () => void\r\n  disableText?: string\r\n  showAlert?: boolean\r\n  record?: {\r\n    fecha_completado?: string\r\n    fecha_revision?: string\r\n  }\r\n}\r\n\r\nexport class CompletadoButtonAction extends PureComponent<ButtonActionProps> {\r\n  render() {\r\n    const completado_disabled_text = this.props.disableText\r\n\r\n    return (\r\n      <Popup\r\n        trigger={\r\n          <div className='button-wrapper'>\r\n            <Button primary icon compact onClick={this.props.onClick} disabled={completado_disabled_text != null}>\r\n              {' '}\r\n              <i className='icon check' /> Completado\r\n            </Button>\r\n          </div>\r\n        }\r\n        content={completado_disabled_text}\r\n        header='Marcar como Completado | Opción deshabilitada'\r\n        disabled={completado_disabled_text == null}\r\n        className='disable-text'\r\n        on='hover'\r\n      />\r\n    )\r\n  }\r\n}\r\n\r\nexport class RevisadoButtonAction extends PureComponent<ButtonActionProps> {\r\n  render() {\r\n    let revisado_disabled_text = this.props.disableText\r\n    if (\r\n      (revisado_disabled_text === null || typeof revisado_disabled_text === 'undefined') &&\r\n      this.props.record &&\r\n      !this.props.record.fecha_completado\r\n    ) {\r\n      revisado_disabled_text = 'Debe estar primero en estado COMPLETADO, para poder marcarse como REVISADO.'\r\n    }\r\n\r\n    let showAlert: boolean\r\n    if ((this.props.showAlert === null || typeof this.props.showAlert === 'undefined') && this.props.record) {\r\n      const record = this.props.record\r\n      showAlert =\r\n        record.fecha_completado &&\r\n        record.fecha_revision &&\r\n        Date.create(record.fecha_completado) > Date.create(record.fecha_revision)\r\n    } else {\r\n      showAlert = this.props.showAlert\r\n    }\r\n\r\n    const icon_revisado_alert = showAlert ? (\r\n      <Popup\r\n        trigger={<i className='icon warning circle red' />}\r\n        content={'Ha recibido modificaciones después de su última revisión.'}\r\n      />\r\n    ) : null\r\n\r\n    return (\r\n      <Popup\r\n        trigger={\r\n          <div className='button-wrapper'>\r\n            <Button color='olive' icon compact onClick={this.props.onClick} disabled={revisado_disabled_text != null}>\r\n              {' '}\r\n              <i className='icon check fitted' />\r\n              <i className='icon check' /> Revisado {icon_revisado_alert}\r\n            </Button>\r\n          </div>\r\n        }\r\n        content={revisado_disabled_text}\r\n        header='Marcar como Revisado | Opción deshabilitada'\r\n        disabled={revisado_disabled_text == null}\r\n        className='disable-text'\r\n        on='hover'\r\n      />\r\n    )\r\n  }\r\n}\r\n\r\ntype ButtonActionsProps = {\r\n  prepend?: JSX.Element\r\n  append?: JSX.Element\r\n  completado: { permission: string } & ButtonActionProps\r\n  revisado: { permission: string } & ButtonActionProps\r\n}\r\n\r\nexport class StatusButtonGroupActions extends PureComponent<ButtonActionsProps> {\r\n  render() {\r\n    return (\r\n      <div className='actions ab-status-actions'>\r\n        {this.props.prepend}\r\n        {user_has_role_permission(this.props.completado.permission) && (\r\n          <CompletadoButtonAction {...this.props.completado} />\r\n        )}\r\n        {user_has_role_permission(this.props.revisado.permission) && <RevisadoButtonAction {...this.props.revisado} />}\r\n        {this.props.append}\r\n      </div>\r\n    )\r\n  }\r\n}\r\n\r\ntype StatusDivBlockProps = {\r\n  status: string\r\n  className?: string\r\n  wrapperClassName?: string\r\n  hideLabel?: boolean\r\n}\r\n\r\nexport const StatusDivBlock = (props: StatusDivBlockProps) => {\r\n  return (\r\n    <div className={cx('lb-status-wrapper', props.wrapperClassName)}>\r\n      {!props.hideLabel && 'Estado:'}\r\n      <div className={cx(props.className, 'lb-status', `lb-status-${_.str.dasherize(props.status.toLowerCase())}`)}>\r\n        {props.status || ''}\r\n      </div>\r\n    </div>\r\n  )\r\n}\r\n","import { SFC, ReactNode } from 'react'\r\n\r\nimport Popup from 'semantic-ui-react/dist/commonjs/modules/Popup/Popup'\r\nimport Icon from 'semantic-ui-react/dist/commonjs/elements/Icon/Icon'\r\nimport { SemanticCOLORS } from 'semantic-ui-react/dist/commonjs/generic'\r\nimport getvalue from 'get-value'\r\n\r\ndeclare var app: any\r\n\r\ntype TooltipProps = {\r\n  title?: string\r\n  text: string | ReactNode\r\n  wide?: boolean | 'very'\r\n  iconColor?: SemanticCOLORS\r\n  iconSize?: 'mini' | 'tiny' | 'small' | 'large' | 'big' | 'huge' | 'massive'\r\n}\r\n\r\nexport const GenericTooltip: SFC<TooltipProps> = (props): JSX.Element => {\r\n  let content\r\n  if (typeof props.text == 'object') {\r\n    content = <div className='content'>{props.text}</div>\r\n  } else if (typeof props.text == 'string') {\r\n    if (props.text.substr(0, 1) == '@') {\r\n      content = getvalue(app.vars.texts, props.text.substr(1))\r\n    } else {\r\n      content = props.text\r\n    }\r\n\r\n    if (!content) {\r\n      return null\r\n    }\r\n\r\n    content = <div dangerouslySetInnerHTML={{ __html: content }} />\r\n  }\r\n\r\n  return (\r\n    <Popup\r\n      size='tiny'\r\n      wide={props.wide}\r\n      trigger={<Icon color={props.iconColor} size={props.iconSize} name='question circle' className='tooltip-icon' />}\r\n      header={props.title}\r\n      content={content}\r\n    />\r\n  )\r\n}\r\n\r\nGenericTooltip.defaultProps = {\r\n  iconColor: 'blue',\r\n  iconSize: 'small',\r\n  wide: false\r\n}\r\n","import { Component } from 'react'\r\nimport TabPaneVisita from './TabPaneVisita'\r\n\r\nimport Icon from 'semantic-ui-react/dist/commonjs/elements/Icon'\r\nimport Button from 'semantic-ui-react/dist/commonjs/elements/Button/Button'\r\nimport Divider from 'semantic-ui-react/dist/commonjs/elements/Divider'\r\nimport Menu from 'semantic-ui-react/dist/commonjs/collections/Menu'\r\nimport Form from 'semantic-ui-react/dist/commonjs/collections/Form'\r\nimport Tab from 'semantic-ui-react/dist/commonjs/modules/Tab'\r\nimport Modal from 'semantic-ui-react/dist/commonjs/modules/Modal'\r\nimport Accordion from 'semantic-ui-react/dist/commonjs/modules/Accordion/Accordion'\r\n\r\nimport { AppVisitaDefaultTab } from './AppVisitaTab'\r\nimport _ from 'lodash'\r\n\r\nimport DualListBox from 'react-dual-listbox'\r\nimport HojaTrabajoContext from './HojaTrabajoContext'\r\n\r\ndeclare var app: any\r\n\r\nexport default class App extends Component<HojaTrabajoAppProps, HojaTrabajoAppState> {\r\n  private panes: HojaTrabajoAppPane[]\r\n  constructor(props: HojaTrabajoAppProps) {\r\n    super(props)\r\n\r\n    const locationHash = window.location.hash.replace(/^#!vis-/, '')\r\n\r\n    let activeIndex: number\r\n    let visita_current\r\n    if (locationHash) {\r\n      activeIndex = +locationHash\r\n      visita_current = _.find(this.props.hoja_trabajo.visitas, { index: activeIndex })\r\n    } else {\r\n      visita_current = _.find(this.props.hoja_trabajo.visitas, { is_current: true })\r\n      activeIndex = visita_current ? visita_current.index : null\r\n    }\r\n\r\n    if (visita_current) {\r\n      app.vars.current_idvisita = visita_current.id_visita\r\n    }\r\n\r\n    this.state = {\r\n      activeIndex,\r\n      selectedVisitas: _.filter(_.map(this.props.hoja_trabajo.visitas, (item, id) => (item.id ? id : null))),\r\n      newVisitaOpen: false,\r\n      assocModalOpen: false,\r\n      hoja_trabajo: this.props.hoja_trabajo\r\n    }\r\n  }\r\n\r\n  componentDidMount() {\r\n    /**\r\n     * Ancho de la tab.\r\n     */\r\n    const tabWidth: number = 90 / _.size(_.filter(this.panes, { type: 'sheet' }))\r\n    $('#visita-tabs').find('.menu>a.visita-tab').css({ width: tabWidth + '%' })\r\n  }\r\n\r\n  handleClick = (e: React.SyntheticEvent, { index }: { index: number }) => {\r\n    this.setState({ activeIndex: index })\r\n    const visita = _.find(this.state.hoja_trabajo.visitas, { index })\r\n    app.vars.current_idvisita = visita.id_visita\r\n    $(`#table-visita-instrucciones-${visita.id}`).floatThead('reflow')\r\n    window.location.hash = '#!vis-' + index\r\n  }\r\n\r\n  showModal = () => {\r\n    this.setState({ assocModalOpen: true })\r\n  }\r\n\r\n  onChangeVisita = (visita: ProyectoPasoVisita) => {\r\n    this.setState((state: HojaTrabajoAppState) => {\r\n      let hoja_trabajo = Object.assign({}, state.hoja_trabajo)\r\n      hoja_trabajo.visitas = _.map(hoja_trabajo.visitas, (item) => {\r\n        if (item.index + '' == visita.index + '') {\r\n          return visita\r\n        } else {\r\n          return item\r\n        }\r\n      })\r\n      return { hoja_trabajo }\r\n    })\r\n  }\r\n\r\n  onChangeApp = (data: any) => {\r\n    this.setState((state: HojaTrabajoAppState) => {\r\n      let hoja_trabajo = Object.assign({}, state.hoja_trabajo, data)\r\n\r\n      return { hoja_trabajo }\r\n    })\r\n  }\r\n\r\n  getUrlFor(urlToAppend: string) {\r\n    return url_for(\r\n      `proyecto/${this.props.hoja_trabajo.proyecto.id}/hoja-trabajo/paso/${this.props.hoja_trabajo.paso\r\n        .id}/${urlToAppend}`\r\n    )\r\n  }\r\n\r\n  isAllowedAsociarVisita() {\r\n    if (!user_has_role_permission('paso_asociar_visita')) {\r\n      return false\r\n    }\r\n\r\n    return true\r\n  }\r\n\r\n  getAssocModal() {\r\n    if (!this.isAllowedAsociarVisita()) {\r\n      return null\r\n    }\r\n\r\n    if (!this.state.hoja_trabajo.proyecto.isOpen) {\r\n      return null\r\n    }\r\n\r\n    const { assocModalOpen, selectedVisitas, newVisitaOpen } = this.state\r\n\r\n    const icons = {\r\n      moveLeft: <i className='icon angle left' />,\r\n      moveAllLeft: <i className='icon angle double left' />,\r\n      moveRight: <i className='icon angle right' />,\r\n      moveAllRight: <i className='icon angle double right' />,\r\n      moveDown: <i className='icon angle down' />,\r\n      moveUp: <i className='icon angle up' />\r\n    }\r\n\r\n    const visitas = this.props.hoja_trabajo.visitas\r\n    let options: { value: number; label: string }[] = []\r\n\r\n    _.forEach(visitas, function(visita, id) {\r\n      options.push({\r\n        value: id,\r\n        label: visita.label\r\n      })\r\n    })\r\n\r\n    const onChange = (selectedVisitas: number[]) => {\r\n      this.setState({ selectedVisitas })\r\n    }\r\n\r\n    const onClose = () => {\r\n      this.setState({ assocModalOpen: false })\r\n    }\r\n\r\n    const onToggle = () => {\r\n      this.setState((state) => {\r\n        return { newVisitaOpen: !state.newVisitaOpen }\r\n      })\r\n    }\r\n\r\n    return (\r\n      <Modal open={assocModalOpen} closeIcon dimmer='inverted' size='small' onClose={onClose} className='modal-ab'>\r\n        <Modal.Header> Asociación de Visitas a este Paso</Modal.Header>\r\n        <Modal.Content>\r\n          <form method='post' className='ui form' action={this.getUrlFor('visita')}>\r\n            <div style={{ marginBottom: '15px' }}>Asocie las visitas a relacionar con este paso: </div> <br />\r\n            <DualListBox\r\n              name='visitas'\r\n              options={options}\r\n              availableLabel='Por asociar'\r\n              selectedLabel='Asociadas'\r\n              selected={selectedVisitas}\r\n              icons={icons}\r\n              onChange={onChange}\r\n            />\r\n            <Divider horizontal>O</Divider>\r\n            <Accordion>\r\n              <Accordion.Title active={newVisitaOpen} onClick={onToggle}>\r\n                <Icon name='caret right' /> Crear Nueva Visita\r\n              </Accordion.Title>\r\n              <Accordion.Content active={newVisitaOpen}>\r\n                <Form.Field inline>\r\n                  <label>Nombre de la visita</label>\r\n                  <div className='ui input'>\r\n                    {' '}\r\n                    <input placeholder='Nombre de la visita' name='visita_name' type='text' />{' '}\r\n                  </div>\r\n                </Form.Field>\r\n              </Accordion.Content>\r\n            </Accordion>\r\n            <button className='primary small ui button right floated'>Guardar</button>\r\n            <button className='negative small ui button right floated' type='button' onClick={onClose}>\r\n              Cancelar\r\n            </button>\r\n            <div className='clearfix' />\r\n          </form>\r\n        </Modal.Content>\r\n      </Modal>\r\n    )\r\n  }\r\n\r\n  render() {\r\n    const self = this\r\n\r\n    const { activeIndex } = this.state\r\n\r\n    const assocModal = this.getAssocModal()\r\n\r\n    this.panes = []\r\n\r\n    let visitas: ProyectoPasoVisita[] = _.values(self.state.hoja_trabajo.visitas)\r\n    visitas = _.sortBy(visitas, 'position')\r\n\r\n    _.forEach(visitas, function(visita, k) {\r\n      if (visita.id == null) {\r\n        return\r\n      }\r\n\r\n      visita.HojaTrabajo = self.state.hoja_trabajo\r\n\r\n      self.panes.push({\r\n        type: 'sheet',\r\n        menuItem: () => {\r\n          return (\r\n            <Menu.Item\r\n              key={visita.id}\r\n              index={visita.index}\r\n              className='tab-nav-item visita-tab'\r\n              name={visita.label}\r\n              onClick={self.handleClick}\r\n              active={activeIndex == visita.index}\r\n            >\r\n              <AppVisitaDefaultTab visita={visita} />\r\n            </Menu.Item>\r\n          )\r\n        },\r\n        pane: () => (\r\n          <TabPaneVisita\r\n            key={visita.id}\r\n            idx={visita.index}\r\n            active={activeIndex == visita.index}\r\n            visita={visita}\r\n            isEditable={self.state.hoja_trabajo.proyecto.isOpen}\r\n            onChange={self.onChangeVisita}\r\n            onChangeApp={self.onChangeApp}\r\n          />\r\n        )\r\n      })\r\n    })\r\n\r\n    if (self.panes.length == 0) {\r\n      return (\r\n        <div className='alert alert-block nocontent'>\r\n          <h3>Sin visitas</h3>\r\n          <p>\r\n            <span className='icon-warning-sign' />Este paso aun no tiene visitas asociadas.{' '}\r\n          </p>\r\n          {self.state.hoja_trabajo.proyecto.isOpen &&\r\n          this.isAllowedAsociarVisita() && [\r\n            <Button\r\n              key='button'\r\n              content='Asociar visitas'\r\n              color='green'\r\n              compact\r\n              icon='info circle'\r\n              onClick={this.showModal}\r\n              style={{ marginTop: '30px' }}\r\n            />,\r\n            <div key='modal'>{assocModal}</div>\r\n          ]}\r\n        </div>\r\n      )\r\n    }\r\n\r\n    if (this.isAllowedAsociarVisita() && self.state.hoja_trabajo.proyecto.isOpen) {\r\n      self.panes.push({\r\n        type: 'action',\r\n        menuItem: () => {\r\n          return (\r\n            <Menu.Item\r\n              key='plus'\r\n              className='tab-nav-item tab-add'\r\n              title='Asociar/Desasociar visitas a este paso'\r\n              onClick={this.showModal}\r\n            >\r\n              <Icon name='plus' />\r\n            </Menu.Item>\r\n          )\r\n        }\r\n      })\r\n    }\r\n\r\n    return (\r\n      <HojaTrabajoContext.Provider value={{ hoja_trabajo: this.state.hoja_trabajo, update: this.onChangeApp }}>\r\n        <div id='visita-tabs' className={`paso-code-${this.state.hoja_trabajo.paso.code}  paso-default`}>\r\n          <Tab panes={this.panes} activeIndex={activeIndex} renderActiveOnly={false} />\r\n\r\n          {assocModal}\r\n        </div>\r\n      </HojaTrabajoContext.Provider>\r\n    )\r\n  }\r\n}\r\n","import { Component, SyntheticEvent } from 'react'\r\nimport TabPaneVisita from './TabPaneVisita'\r\nimport { AuthorIconLog } from './../global/AuthorIconLog'\r\n\r\nimport Label from 'semantic-ui-react/dist/commonjs/elements/Label'\r\n\r\nimport { Tabs, TabList, Tab, PanelList, Panel } from 'react-tabtab'\r\n\r\nimport { SortableContainer, SortableElement, SortableHandle } from 'react-sortable-hoc'\r\nimport HojaTrabajoContext from './HojaTrabajoContext'\r\n\r\ndeclare var app: any\r\n\r\ndeclare type HojaTrabajoAppPeriodoState = {\r\n  activeIndex: number\r\n  newVisitaOpen: boolean\r\n  hoja_trabajo: HojaTrabajo\r\n}\r\n\r\nexport default class AppPeriodo extends Component<HojaTrabajoAppProps, HojaTrabajoAppPeriodoState> {\r\n  constructor(props: HojaTrabajoAppProps) {\r\n    super(props)\r\n\r\n    const visita_current = _.find(this.props.hoja_trabajo.visitas, { is_current: true })\r\n    const activeIndex = visita_current ? visita_current.index : null\r\n\r\n    if (visita_current) {\r\n      app.vars.current_idvisita = visita_current.id_visita\r\n    }\r\n\r\n    this.state = {\r\n      activeIndex,\r\n      newVisitaOpen: false,\r\n      hoja_trabajo: this.props.hoja_trabajo\r\n    }\r\n  }\r\n\r\n  handleClick = (index: number) => {\r\n    this.setState({ activeIndex: index })\r\n    const visita = _.find(this.state.hoja_trabajo.visitas, { index })\r\n    app.vars.current_idvisita = visita.id_visita\r\n    $(`#table-visita-instrucciones-${visita.id}`).floatThead('reflow')\r\n  }\r\n\r\n  onChangeVisita = (visita: ProyectoPasoVisita) => {\r\n    this.setState((state: HojaTrabajoAppState) => {\r\n      let hoja_trabajo = Object.assign({}, state.hoja_trabajo)\r\n      hoja_trabajo.visitas = _.map(hoja_trabajo.visitas, (item) => {\r\n        if (item.index + '' == visita.index + '') {\r\n          return visita\r\n        } else {\r\n          return item\r\n        }\r\n      })\r\n      return { hoja_trabajo }\r\n    })\r\n  }\r\n\r\n  onChangeApp = (data: any) => {\r\n    this.setState((state: HojaTrabajoAppState) => {\r\n      let hoja_trabajo = Object.assign({}, state.hoja_trabajo, data)\r\n\r\n      return { hoja_trabajo }\r\n    })\r\n  }\r\n\r\n  onClickActionElement = (ev: SyntheticEvent, action: 'CREATE' | 'RENAME' | 'DELETE', visita?: ProyectoPasoVisita) => {\r\n    ev.preventDefault()\r\n    switch (action) {\r\n      case 'CREATE':\r\n        bootbox.prompt(\r\n          { header: 'Nuevo Periodo', content: '<div>Escriba el nombre del periodo que desea crear.</div>' },\r\n          'Cancelar',\r\n          'Crear',\r\n          (r: string) => {\r\n            if (!r || _.str.trim(r) == '') {\r\n              return\r\n            }\r\n            const url = this.getUrlFor('periodo')\r\n\r\n            $.blockUI(create_blockUI_loading_message('Creando Nuevo Periodo'))\r\n\r\n            $.ajax(url, {\r\n              type: 'POST',\r\n              data: { id_paso: this.state.hoja_trabajo.paso.id, name: _.str.trim(r) },\r\n              dataType: 'json'\r\n            }).done((res) => {\r\n              if (!res.hasErrors) {\r\n                this.setState((state) => {\r\n                  let hoja_trabajo = state.hoja_trabajo\r\n                  hoja_trabajo.visitas[res.response.id_visita] = res.response\r\n\r\n                  return { hoja_trabajo, activeIndex: res.response.index }\r\n                })\r\n              } else {\r\n                bootbox.alert(res.message)\r\n              }\r\n              $.unblockUI()\r\n            })\r\n          },\r\n          ''\r\n        )\r\n        $('.bootbox.modal').addClass('modal-ab')\r\n        break\r\n      case 'RENAME':\r\n        bootbox.prompt(\r\n          { header: 'Renombrar Periodo', content: 'Escriba el nombre que desea asignarle a este periodo.' },\r\n          'Cancelar',\r\n          'Aceptar',\r\n          (r: string) => {\r\n            if (!r || _.str.trim(r) == '') {\r\n              return\r\n            }\r\n\r\n            $.blockUI(create_blockUI_loading_message('Guardando cambios'))\r\n            const url = url_for(\r\n              `proyecto/${this.state.hoja_trabajo.proyecto.id}/master_data/paso-visita/rename/${visita.id_visita}`\r\n            )\r\n\r\n            $.ajax(url, {\r\n              type: 'POST',\r\n              data: { name: _.str.trim(r) },\r\n              dataType: 'json'\r\n            }).done((res) => {\r\n              if (!res.hasErrors) {\r\n                this.setState((state) => {\r\n                  let hoja_trabajo = state.hoja_trabajo\r\n                  hoja_trabajo.visitas = _.map(hoja_trabajo.visitas, function(item) {\r\n                    if (item.id_visita == visita.id_visita) {\r\n                      item.label = _.str.trim(r)\r\n                    }\r\n                    return item\r\n                  })\r\n\r\n                  return { hoja_trabajo }\r\n                })\r\n              }\r\n              $.unblockUI()\r\n            })\r\n          },\r\n          visita.label\r\n        )\r\n        $('.bootbox.modal').addClass('modal-ab')\r\n        break\r\n      case 'DELETE':\r\n        bootbox.warningConfirm('¿Desea eliminar este periodo?', 'No', 'Sí, Eliminar periodo', (r) => {\r\n          if (r) {\r\n            $.blockUI(create_blockUI_loading_message(`Eliminando Periodo \"${visita.label}\"`))\r\n            const url = url_for(\r\n              `proyecto/${this.state.hoja_trabajo.proyecto.id}/master_data/paso-visita/delete/${visita.id_visita}`\r\n            )\r\n\r\n            $.ajax(url, {\r\n              type: 'POST',\r\n              dataType: 'json'\r\n            }).done((res) => {\r\n              $.unblockUI()\r\n              if (!res.hasErrors) {\r\n                this.setState((state) => {\r\n                  let hoja_trabajo = state.hoja_trabajo\r\n                  hoja_trabajo.visitas = _.reject(hoja_trabajo.visitas, function(item) {\r\n                    return item.id_visita == visita.id_visita\r\n                  })\r\n\r\n                  let activeIndex = state.activeIndex\r\n                  if (activeIndex == visita.index) {\r\n                    activeIndex = _.head(hoja_trabajo.visitas).index\r\n                  }\r\n\r\n                  return { hoja_trabajo, activeIndex }\r\n                })\r\n              }\r\n            })\r\n          }\r\n        })\r\n    }\r\n  }\r\n\r\n  static shortVisitaName(visita: string): string {\r\n    const transformations: { [s: string]: string } = {\r\n      Enero: 'Ene',\r\n      Febrero: 'Feb',\r\n      Marzo: 'Mar',\r\n      Abril: 'Abr',\r\n      Mayo: 'May',\r\n      Junio: 'Jun',\r\n      Julio: 'Jul',\r\n      Agosto: 'Ago',\r\n      Septiembre: 'Sept',\r\n      Octubre: 'Oct',\r\n      Noviembre: 'Nov',\r\n      Diciembre: 'Dic'\r\n    }\r\n\r\n    _.forEach(transformations, function(to, from) {\r\n      visita = visita.replace(new RegExp(from, 'gi'), to)\r\n    })\r\n\r\n    return visita\r\n  }\r\n\r\n  getUrlFor(urlToAppend: string) {\r\n    return url_for(\r\n      `proyecto/${this.props.hoja_trabajo.proyecto.id}/hoja-trabajo/paso/${this.props.hoja_trabajo.paso\r\n        .id}/${urlToAppend}`\r\n    )\r\n  }\r\n\r\n  isAllowedAsociarVisita() {\r\n    if (!user_has_role_permission('paso_asociar_visita')) {\r\n      return false\r\n    }\r\n\r\n    if (!this.state.hoja_trabajo.proyecto.isOpen) {\r\n      return false\r\n    }\r\n  }\r\n\r\n  renderTab(visita: ProyectoPasoVisita, k: number) {\r\n    let status_label = null\r\n\r\n    if (visita.status) {\r\n      status_label = (\r\n        <Label\r\n          style={{ backgroundColor: visita.status_color }}\r\n          className={`visita-status visita-status-${_.str.underscored(visita.status)}`}\r\n          size='mini'\r\n        >\r\n          {visita.status}\r\n        </Label>\r\n      )\r\n    }\r\n\r\n    const alertTextRevisado =\r\n      visita.fecha_completado &&\r\n      visita.fecha_revision &&\r\n      Date.create(visita.fecha_completado) > Date.create(visita.fecha_revision)\r\n        ? 'Modificado despues de Revisado'\r\n        : null\r\n\r\n    return (\r\n      <Tab key={visita.id} className='item tab-nav-item visita-tab'>\r\n        <span className='tabname'>{AppPeriodo.shortVisitaName(visita.label)}</span>\r\n        <div className='author-icon-log-wrapper'>\r\n          <AuthorIconLog log={visita.UpdateLog} name='Preparado por' label='P' iconColor='green' />\r\n          <AuthorIconLog\r\n            log={visita.RevisionLog}\r\n            name='Revisado por'\r\n            label='R'\r\n            iconColor='olive'\r\n            alertText={alertTextRevisado}\r\n          />\r\n        </div>\r\n        {status_label}\r\n      </Tab>\r\n    )\r\n  }\r\n  renderPanel(visita: ProyectoPasoVisita, k: number) {\r\n    return (\r\n      <Panel key={visita.id}>\r\n        <TabPaneVisita\r\n          idx={visita.index}\r\n          active={this.state.activeIndex == visita.index}\r\n          visita={visita}\r\n          type='PERIODO'\r\n          isEditable={this.state.hoja_trabajo.proyecto.isOpen}\r\n          onChange={this.onChangeVisita}\r\n          onChangeApp={this.onChangeApp}\r\n        />\r\n      </Panel>\r\n    )\r\n  }\r\n\r\n  renderModalContent() {\r\n    if (!this.state.hoja_trabajo.proyecto.isOpen) {\r\n      return null\r\n    }\r\n\r\n    const self = this\r\n    let visitas: ProyectoPasoVisita[] = _.values(self.state.hoja_trabajo.visitas)\r\n    visitas = _.sortBy(visitas, 'position')\r\n\r\n    const DragHandle = SortableHandle(() => <span className='sort-handler drag-icon' />)\r\n\r\n    const SortElement = SortableElement(({ visita }: { visita: ProyectoPasoVisita }) => {\r\n      return (\r\n        <li className='list-group-item visita-li' id={`visita-li-${visita.id}`}>\r\n          {user_has_role_permission('hoja_trabajo_edit') && <DragHandle />}\r\n          <span>{visita.label}</span>\r\n\r\n          <div className='pull-right'>\r\n            {user_has_role_permission('hoja_trabajo_edit') && [\r\n              <a\r\n                href='#'\r\n                key='rename'\r\n                className='btn-mini btn-link'\r\n                onClick={(ev) => this.onClickActionElement(ev, 'RENAME', visita)}\r\n              >\r\n                Cambiar nombre\r\n              </a>,\r\n              '|',\r\n              <a\r\n                href='#'\r\n                key='delete'\r\n                className='btn-link btn-mini delete'\r\n                onClick={(ev) => this.onClickActionElement(ev, 'DELETE', visita)}\r\n              >\r\n                Eliminar\r\n              </a>\r\n            ]}\r\n          </div>\r\n        </li>\r\n      )\r\n    })\r\n\r\n    const SortableList = SortableContainer(({ visitas }: { visitas: ProyectoPasoVisita[] }) => {\r\n      return (\r\n        <ul id='paso-periodo-sortlist' className='list-group compact' style={{ marginLeft: 0 }}>\r\n          {_.map(visitas, (visita, index: number) => (\r\n            <SortElement visita={visita} key={`visita-li-${visita.id}`} index={index} />\r\n          ))}\r\n        </ul>\r\n      )\r\n    })\r\n\r\n    const onSortEnd = ({ oldIndex, newIndex }: { oldIndex: number; newIndex: number }) => {\r\n      const arrayMoveMutate = (array: any[], from: number, to: number) => {\r\n        array.splice(to < 0 ? array.length + to : to, 0, array.splice(from, 1)[0])\r\n      }\r\n\r\n      const arrayMove = (array: any[], from: number, to: number) => {\r\n        array = array.slice()\r\n        arrayMoveMutate(array, from, to)\r\n        return array\r\n      }\r\n\r\n      this.setState(\r\n        (state) => {\r\n          let hoja_trabajo = state.hoja_trabajo\r\n          let visitas: ProyectoPasoVisita[] = _.values(hoja_trabajo.visitas)\r\n          visitas = _.sortBy(visitas, 'position')\r\n          let sorted = arrayMove(visitas, oldIndex, newIndex)\r\n          sorted = _.map(sorted, function(item, k: number) {\r\n            item.position = k\r\n            return item\r\n          })\r\n          hoja_trabajo.visitas = sorted\r\n\r\n          return { hoja_trabajo }\r\n        },\r\n        () => {\r\n          let neworder: { [s: number]: string } = {}\r\n          _.forEach(this.state.hoja_trabajo.visitas, function(item) {\r\n            neworder[item.position] = item.id_visita\r\n          })\r\n\r\n          const url = url_for(`proyecto/${this.state.hoja_trabajo.proyecto.id}/master_data/paso-visita/sort`)\r\n          $.ajax(url, {\r\n            type: 'POST',\r\n            data: { sort: neworder },\r\n            dataType: 'json'\r\n          })\r\n        }\r\n      )\r\n    }\r\n\r\n    return (\r\n      <div style={{ padding: '5px 20px' }}>\r\n        <p className='description-text'>Listado de periodos asociados a este paso.</p>\r\n\r\n        <SortableList\r\n          visitas={visitas}\r\n          lockAxis='y'\r\n          helperClass='sortable_placeholder'\r\n          useDragHandle\r\n          onSortEnd={onSortEnd}\r\n          helperContainer={() => document.getElementById('paso-periodo-sortlist')}\r\n        />\r\n\r\n        <div style={{ margin: 'auto', textAlign: 'center' }}>\r\n          <button className='btn btn-primary' onClick={(ev) => this.onClickActionElement(ev, 'CREATE')}>\r\n            <span className='icon-plus' /> Nuevo Periodo\r\n          </button>\r\n        </div>\r\n        <br />\r\n      </div>\r\n    )\r\n  }\r\n\r\n  render() {\r\n    const self = this\r\n    let visitas: ProyectoPasoVisita[] = _.values(self.state.hoja_trabajo.visitas)\r\n\r\n    if (_.size(visitas) == 0) {\r\n      return (\r\n        <div id='visita-tabs' className={`paso-code-${this.state.hoja_trabajo.paso.code} paso-periodo`}>\r\n          <div className='alert alert-block nocontent'>\r\n            <h3>Sin Periodos</h3>\r\n            <p>\r\n              <span className='icon-warning-sign' />Este paso aun no tiene periodos creados.\r\n            </p>\r\n            {user_has_role_permission('hoja_trabajo_edit') && (\r\n              <button\r\n                className='btn btn-primary'\r\n                onClick={(ev) => this.onClickActionElement(ev, 'CREATE')}\r\n                style={{ marginTop: '30px' }}\r\n              >\r\n                <span className='icon-plus' /> Nuevo periodo\r\n              </button>\r\n            )}\r\n          </div>\r\n        </div>\r\n      )\r\n    }\r\n\r\n    visitas = _.sortBy(visitas, 'position')\r\n\r\n    return (\r\n      <HojaTrabajoContext.Provider value={{ hoja_trabajo: this.state.hoja_trabajo, update: this.onChangeApp }}>\r\n        <div id='visita-tabs' className={`paso-code-${this.state.hoja_trabajo.paso.code} paso-periodo`}>\r\n          <Tabs\r\n            activeIndex={this.state.activeIndex}\r\n            onTabChange={this.handleClick}\r\n            showModalButton={this.state.hoja_trabajo.proyecto.isOpen}\r\n            modalHeader='Administración de Periodos'\r\n            modalContent={this.renderModalContent()}\r\n          >\r\n            <TabList className='ui tabular menu'>\r\n              {_.map(visitas, (visita, k) => {\r\n                visita.HojaTrabajo = self.state.hoja_trabajo\r\n                return this.renderTab(visita, k)\r\n              })}\r\n            </TabList>\r\n            <PanelList>\r\n              {_.map(visitas, (visita, k) => {\r\n                visita.HojaTrabajo = self.state.hoja_trabajo\r\n                return this.renderPanel(visita, k)\r\n              })}\r\n            </PanelList>\r\n          </Tabs>\r\n        </div>\r\n      </HojaTrabajoContext.Provider>\r\n    )\r\n  }\r\n}\r\n","import { Component, Fragment, ReactNode } from 'react'\r\n\r\nimport Label from 'semantic-ui-react/dist/commonjs/elements/Label'\r\nimport Popup from 'semantic-ui-react/dist/commonjs/modules/Popup/Popup'\r\nimport Button from 'semantic-ui-react/dist/commonjs/elements/Button/Button'\r\nimport Icon from 'semantic-ui-react/dist/commonjs/elements/Icon/Icon'\r\nimport Modal from 'semantic-ui-react/dist/commonjs/modules/Modal/Modal'\r\n\r\nimport EditorPreview from '../global/EditorPreview'\r\nimport { AuthorIconLogDefaultWrapper } from '../global/AuthorIconLog'\r\nimport HojaTrabajoContext from './HojaTrabajoContext'\r\nimport { HojaTrabajoUpdateUtils } from './utils'\r\n\r\nimport DualListBox from 'react-dual-listbox'\r\nimport Divider from 'semantic-ui-react/dist/commonjs/elements/Divider/Divider'\r\nimport Accordion from 'semantic-ui-react/dist/commonjs/modules/Accordion/Accordion'\r\nimport Form from 'semantic-ui-react/dist/commonjs/collections/Form/Form'\r\n\r\ntype AppVisitaDefaultTabProps = {\r\n  visita: ProyectoPasoVisita\r\n}\r\n\r\nexport class AppVisitaDefaultTab extends Component<AppVisitaDefaultTabProps> {\r\n  getStatusLabel() {\r\n    const { visita } = this.props\r\n\r\n    let status_label = null\r\n\r\n    if (visita.status) {\r\n      status_label = (\r\n        <Label\r\n          style={{ backgroundColor: visita.status_color }}\r\n          className={`visita-status visita-status-${_.str.underscored(visita.status)}`}\r\n          size='mini'\r\n        >\r\n          {visita.status}\r\n        </Label>\r\n      )\r\n    }\r\n\r\n    return status_label\r\n  }\r\n\r\n  render() {\r\n    const { visita } = this.props\r\n\r\n    return (\r\n      <Fragment>\r\n        <span className='tabname' title={visita.label}>\r\n          {visita.label}\r\n        </span>\r\n        <AuthorIconLogDefaultWrapper model={visita} />\r\n        {this.getStatusLabel()}\r\n      </Fragment>\r\n    )\r\n  }\r\n}\r\n\r\ntype PasoObjetivoPaneProps = {\r\n  isEditable: boolean\r\n}\r\n\r\nexport class PasoObjetivoPane extends Component<PasoObjetivoPaneProps> {\r\n  static contextType = HojaTrabajoContext\r\n\r\n  static defaultProps: PasoObjetivoPaneProps = {\r\n    isEditable: false\r\n  }\r\n\r\n  context: HojaTrabajoContextType\r\n\r\n  onChangeValue = (editor: CKEDITOR.editor) => {\r\n    const objetivo = editor.getData()\r\n    const { hoja_trabajo, update } = this.context\r\n\r\n    $.blockUI(create_blockUI_loading_message('Guardando Cambios'))\r\n    const url = url_for(`proyecto/${hoja_trabajo.proyecto.id}/master_data/paso/${hoja_trabajo.paso.id}/objetivo`)\r\n    $.ajax(url, { type: 'POST', data: { objetivo }, dataType: 'json' }).done(() => {\r\n      let hoja_trabajo_new = HojaTrabajoUpdateUtils.updateField(hoja_trabajo, 'paso', { objetivo })\r\n      update(hoja_trabajo_new)\r\n      $.unblockUI()\r\n    })\r\n  }\r\n\r\n  render() {\r\n    let { hoja_trabajo }: { hoja_trabajo: HojaTrabajo } = this.context\r\n    const ckeditorOptions = {\r\n      height: 150,\r\n      toolbar: [\r\n        { name: 'basicstyles', groups: [ 'basicstyles', 'cleanup' ], items: [ 'Bold', 'Italic' ] },\r\n        {\r\n          name: 'paragraph',\r\n          groups: [ 'list', 'indent', 'blocks', 'align', 'bidi' ],\r\n          items: [ 'NumberedList', 'BulletedList', '-', 'Outdent', 'Indent', '-', 'TextColor' ]\r\n        }\r\n      ],\r\n      autoParagraph: false,\r\n      removePlugins: 'elementspath, uploadfile, resize',\r\n      extraPlugins: 'openlink'\r\n    }\r\n\r\n    return (\r\n      <div className='hoja-trabajo-objetivo hoverable-actions'>\r\n        <EditorPreview\r\n          className='objetivo-text-editor'\r\n          ckeditorOptions={ckeditorOptions}\r\n          prefixPreview='Objetivo:'\r\n          label=' '\r\n          labelTitle='Objetivo: '\r\n          data={hoja_trabajo.paso.objetivo}\r\n          editable={this.props.isEditable && user_has_role_permission('paso_objetivo_edit')}\r\n          onSave={this.onChangeValue}\r\n        />\r\n      </div>\r\n    )\r\n  }\r\n}\r\n\r\ntype PasoVisitaStatusActionsProps = {\r\n  visita: ProyectoPasoVisita\r\n  revisadoDisabledText?: string\r\n  completadoDisabledText?: string\r\n}\r\n\r\nexport class PasoVisitaStatusActions extends Component<PasoVisitaStatusActionsProps> {\r\n  static contextType = HojaTrabajoContext\r\n  context: HojaTrabajoContextType\r\n\r\n  onClickCompletado = () => {\r\n    const { hoja_trabajo } = this.context\r\n    const url = url_for(\r\n      `proyecto/${hoja_trabajo.proyecto.id}/hoja-trabajo/paso/${hoja_trabajo.paso.id}/visita/${this.props.visita\r\n        .id_visita}/save`\r\n    )\r\n\r\n    let loadingMessage = 'Marcando como Completado...'\r\n    $.blockUI(create_blockUI_loading_message(loadingMessage))\r\n    $.ajax(url, { type: 'POST', data: { op: 'c' }, dataType: 'json' }).done((res) => {\r\n      if (res.hasErrors) {\r\n        $.unblockUI()\r\n        bootbox.alert(res.message)\r\n      } else {\r\n        this.updateVisita(res.response.record)\r\n        $.unblockUI()\r\n      }\r\n    })\r\n  }\r\n\r\n  onClickRevisado = () => {\r\n    const { hoja_trabajo } = this.context\r\n    const url = url_for(\r\n      `proyecto/${hoja_trabajo.proyecto.id}/hoja-trabajo/paso/${hoja_trabajo.paso.id}/visita/${this.props.visita\r\n        .id_visita}/save`\r\n    )\r\n\r\n    let loadingMessage = 'Marcando como Revisado...'\r\n    $.blockUI(create_blockUI_loading_message(loadingMessage))\r\n    $.ajax(url, { type: 'POST', data: { op: 'r' }, dataType: 'json' }).done((res) => {\r\n      if (res.hasErrors) {\r\n        $.unblockUI()\r\n        bootbox.alert(res.message)\r\n      } else {\r\n        this.updateVisita(res.response.record)\r\n        $.unblockUI()\r\n      }\r\n    })\r\n  }\r\n\r\n  getRevisadoDisabledText() {\r\n    if (_.include([ '1', '2', '3' ], this.props.visita.id_status) || this.props.completadoDisabledText) {\r\n      return 'Esta visita debe estar primero en estado COMPLETADO, para poder marcar esta hoja de trabajo como REVISADA.'\r\n    } else if (_.include([ '6' ], this.props.visita.id_status)) {\r\n      return 'Esta visita  tiene Notas de Revisión que deben primero ser atendidas para poder marcar esta hoja de trabajo como REVISADA.'\r\n    } else if (this.props.visita.additionals.revisiones > 0) {\r\n      return 'Esta visita tiene Notas de Revisión pendientes por revisar que deben primero ser revisadas para poder marcar esta hoja de trabajo como REVISADA.'\r\n    }\r\n\r\n    return this.props.revisadoDisabledText\r\n  }\r\n\r\n  updateVisita(_visita: any) {\r\n    const { hoja_trabajo, update } = this.context\r\n    let hoja_trabajo_new = HojaTrabajoUpdateUtils.updateVisita(hoja_trabajo, this.props.visita, _visita)\r\n    update(hoja_trabajo_new)\r\n  }\r\n\r\n  render() {\r\n    const { visita } = this.props\r\n    const revisadoDisabledText = this.getRevisadoDisabledText()\r\n\r\n    let icon_revisado_alert\r\n    if (\r\n      visita.fecha_revision && // Tiene fecha de revision\r\n      ((visita.fecha_completado && Date.create(visita.fecha_completado) > Date.create(visita.fecha_revision)) || // Fue completado despues de revisado\r\n        !_.includes([ '5', '6' ], '' + visita.id_status)) // No esta en estado Revisado o Notas de Revision\r\n    ) {\r\n      icon_revisado_alert = (\r\n        <Popup\r\n          trigger={<Icon color='red' name='warning circle' />}\r\n          content={'Esta visita ha recibido modificaciones después de su última revisión.'}\r\n        />\r\n      )\r\n    }\r\n\r\n    return (\r\n      <div className='actions ab-status-actions'>\r\n        {user_has_role_permission('paso_completado') && (\r\n          <Popup\r\n            trigger={\r\n              <div className='button-wrapper'>\r\n                <Button\r\n                  primary\r\n                  icon\r\n                  compact\r\n                  onClick={this.onClickCompletado}\r\n                  disabled={this.props.completadoDisabledText != null}\r\n                >\r\n                  {' '}\r\n                  <Icon name='check' /> Completado\r\n                </Button>\r\n              </div>\r\n            }\r\n            content={this.props.completadoDisabledText}\r\n            header='Marcar como Completado | Opción deshabilitada'\r\n            disabled={this.props.completadoDisabledText == null}\r\n            className='disable-text'\r\n            on='hover'\r\n          />\r\n        )}\r\n        {user_has_role_permission([ 'paso_revisado' ]) && (\r\n          <Popup\r\n            trigger={\r\n              <div className='button-wrapper'>\r\n                <Button\r\n                  color='olive'\r\n                  icon\r\n                  compact\r\n                  onClick={this.onClickRevisado}\r\n                  disabled={revisadoDisabledText != null}\r\n                >\r\n                  {' '}\r\n                  <Icon name='check' fitted />\r\n                  <Icon name='check' /> Revisado {icon_revisado_alert}\r\n                </Button>\r\n              </div>\r\n            }\r\n            content={revisadoDisabledText}\r\n            header='Marcar como Revisado | Opción deshabilitada'\r\n            disabled={revisadoDisabledText == null}\r\n            className='disable-text'\r\n            on='hover'\r\n            position='top right'\r\n          />\r\n        )}\r\n      </div>\r\n    )\r\n  }\r\n}\r\n\r\ntype PasoVisitaAssocProps = {\r\n  hoja_trabajo: HojaTrabajo\r\n  trigger: ReactNode\r\n}\r\ntype PasoVisitaAssocState = {\r\n  open: boolean\r\n  newVisitaOpen: boolean\r\n  selectedVisitas: number[]\r\n}\r\n\r\nexport class PasoVisitaAssoc extends Component<PasoVisitaAssocProps, PasoVisitaAssocState> {\r\n  constructor(props: PasoVisitaAssocProps) {\r\n    super(props)\r\n\r\n    this.state = {\r\n      open: false,\r\n      newVisitaOpen: false,\r\n      selectedVisitas: _.filter(_.map(this.props.hoja_trabajo.visitas, (item, id) => (item.id ? id : null)))\r\n    }\r\n  }\r\n\r\n  getModal() {\r\n    if (!this.state.open) {\r\n      return null\r\n    }\r\n\r\n    const icons = {\r\n      moveLeft: <i className='icon angle left' />,\r\n      moveAllLeft: <i className='icon angle double left' />,\r\n      moveRight: <i className='icon angle right' />,\r\n      moveAllRight: <i className='icon angle double right' />,\r\n      moveDown: <i className='icon angle down' />,\r\n      moveUp: <i className='icon angle up' />\r\n    }\r\n\r\n    const { hoja_trabajo } = this.props\r\n\r\n    const visitas = hoja_trabajo.visitas\r\n    let options: { value: number; label: string }[] = []\r\n\r\n    _.forEach(visitas, function(visita, id) {\r\n      options.push({\r\n        value: id,\r\n        label: visita.label\r\n      })\r\n    })\r\n\r\n    const onChange = (selectedVisitas: number[]) => {\r\n      this.setState({ selectedVisitas })\r\n    }\r\n\r\n    const onClose = () => {\r\n      this.setState({ open: false })\r\n    }\r\n\r\n    const onToggle = () => {\r\n      this.setState((state) => {\r\n        return { newVisitaOpen: !state.newVisitaOpen }\r\n      })\r\n    }\r\n\r\n    return (\r\n      <Modal key='modal-assoc' open closeIcon dimmer='inverted' size='small' onClose={onClose} className='modal-ab'>\r\n        <Modal.Header> Asociación de Visitas a este Paso</Modal.Header>\r\n        <Modal.Content>\r\n          <form\r\n            method='post'\r\n            className='ui form'\r\n            action={url_for(`proyecto/${hoja_trabajo.proyecto.id}/hoja-trabajo/paso/${hoja_trabajo.paso.id}/visita`)}\r\n          >\r\n            <div style={{ marginBottom: '15px' }}>Asocie las visitas a relacionar con este paso: </div> <br />\r\n            <DualListBox\r\n              name='visitas'\r\n              options={options}\r\n              availableLabel='Por asociar'\r\n              selectedLabel='Asociadas'\r\n              selected={this.state.selectedVisitas}\r\n              icons={icons}\r\n              onChange={onChange}\r\n            />\r\n            <Divider horizontal>O</Divider>\r\n            <Accordion>\r\n              <Accordion.Title active={this.state.newVisitaOpen} onClick={onToggle}>\r\n                <Icon name='caret right' /> Crear Nueva Visita\r\n              </Accordion.Title>\r\n              <Accordion.Content active={this.state.newVisitaOpen}>\r\n                <Form.Field inline>\r\n                  <label>Nombre de la visita</label>\r\n                  <div className='ui input'>\r\n                    <input placeholder='Nombre de la visita' name='visita_name' type='text' />\r\n                  </div>\r\n                </Form.Field>\r\n              </Accordion.Content>\r\n            </Accordion>\r\n            <button className='primary small ui button right floated'>Guardar</button>\r\n            <button className='negative small ui button right floated' type='button' onClick={onClose}>\r\n              Cancelar\r\n            </button>\r\n            <div className='clearfix' />\r\n          </form>\r\n        </Modal.Content>\r\n      </Modal>\r\n    )\r\n  }\r\n  render() {\r\n    return [\r\n      <div key='trigger' onClick={() => this.setState({ open: true })}>\r\n        {this.props.trigger}\r\n      </div>,\r\n      this.getModal()\r\n    ]\r\n  }\r\n}\r\n","import { Component } from 'react'\r\n\r\nimport Icon from 'semantic-ui-react/dist/commonjs/elements/Icon'\r\nimport Label from 'semantic-ui-react/dist/commonjs/elements/Label'\r\nimport List from 'semantic-ui-react/dist/commonjs/elements/List'\r\nimport Popup from 'semantic-ui-react/dist/commonjs/modules/Popup'\r\nimport Dimmer from 'semantic-ui-react/dist/commonjs/modules/Dimmer/Dimmer'\r\nimport Loader from 'semantic-ui-react/dist/commonjs/elements/Loader/Loader'\r\n\r\nexport class AttachmentListItem extends Component<AttachmentListItemProps> {\r\n  private static getFileExtension(filename: string): string {\r\n    return filename.split('.').pop()\r\n  }\r\n\r\n  private static getFileIconUrl(file: string): string {\r\n    const extension = AttachmentListItem.getFileExtension(file)\r\n\r\n    const file_icon = function() {\r\n      switch (extension) {\r\n        case 'xls':\r\n        case 'xlsx':\r\n        case 'xlsm':\r\n        case 'xlsxm':\r\n          return 'excel'\r\n        case 'doc':\r\n        case 'docx':\r\n          return 'word'\r\n        case 'pdf':\r\n          return 'pdf'\r\n        case 'png':\r\n        case 'jpg':\r\n        case 'jpeg':\r\n        case 'bmp':\r\n        case 'gif':\r\n          return 'image'\r\n        case 'zip':\r\n        case 'rar':\r\n          return 'zip'\r\n        default:\r\n          return 'default'\r\n      }\r\n    }\r\n\r\n    return public_path(`images/file_icons/${file_icon()}.png`)\r\n  }\r\n\r\n  changeStatus(e: React.SyntheticEvent, status: 'completado' | 'revisado') {\r\n    e.preventDefault()\r\n\r\n    const url: string = url_for(\r\n      `proyecto/${this.props.attachment.id_proyecto}/adjunto/${this.props.attachment.id}/${status}`\r\n    )\r\n    $.blockUI({\r\n      message:\r\n        '<div class=\"ajax-loader-snake-32  _a-center\"></div><h3 class=\"loading-block-text\">Marcando archivo como ' +\r\n        _.str.capitalize(status) +\r\n        '.<br> Por favor Espere ...</h3>'\r\n    })\r\n\r\n    $.ajax(url, { type: 'POST', data: {}, dataType: 'json' })\r\n      .done((res) => {\r\n        this.props.onUpdate(res.response.record)\r\n        $.unblockUI()\r\n      })\r\n      .fail(() => {\r\n        $.pnotify({ text: 'El archivo no pudo ser actualizado.', type: 'error' })\r\n        $.unblockUI()\r\n      })\r\n  }\r\n\r\n  onRemove = (ev: React.SyntheticEvent) => {\r\n    ev.preventDefault()\r\n\r\n    const url: string = url_for(\r\n      `proyecto/${this.props.attachment.id_proyecto}/adjunto/${this.props.attachment.id}/remove`\r\n    )\r\n    bootbox.warningConfirm(\r\n      '¿Esta seguro de querer borrar este archivo?<br><br>Tenga en cuenta que el sistema intentará borrar automáticamente los enlaces existentes a este archivo.',\r\n      'Cancelar',\r\n      'Aceptar',\r\n      (r) => {\r\n        if (r) {\r\n          $.blockUI({\r\n            message:\r\n              '<div class=\"ajax-loader-snake-32  _a-center\"></div><h3 class=\"loading-block-text\">Borrando archivo.<br> Por favor Espere ...</h3>'\r\n          })\r\n          $.ajax(url, { type: 'POST', data: {}, dataType: 'json' })\r\n            .done(() => {\r\n              this.props.onDelete(this.props.attachment, () => $.unblockUI())\r\n            })\r\n            .fail(() => {\r\n              $.pnotify({ text: 'El archivo no pudo ser borrado.', type: 'error' })\r\n              $.unblockUI()\r\n            })\r\n        }\r\n      }\r\n    )\r\n  }\r\n\r\n  render() {\r\n    const { attachment } = this.props\r\n\r\n    let completadoComp\r\n    if (attachment.fecha_completado) {\r\n      completadoComp = (\r\n        <div style={{ display: 'inline-block' }}>\r\n          <strong className='title'>(P) </strong>\r\n          <div\r\n            style={{ display: 'inline-block', minWidth: 20, textAlign: 'center', marginRight: 2 }}\r\n            title={`Preparado por: ${attachment.UpdateLog[0].User.name}`}\r\n          >\r\n            {attachment.UpdateLog[0].User.sigla}&nbsp;\r\n          </div>\r\n          <div style={{ display: 'inline-block' }} title={attachment.fecha_completado}>\r\n            <span className='icon-moon-calendar' />{' '}\r\n            {Date.create(attachment.fecha_completado).format('{year}-{MM}-{dd}')}\r\n          </div>\r\n        </div>\r\n      )\r\n    }\r\n\r\n    let revisadoComp\r\n    if (attachment.fecha_revisado) {\r\n      revisadoComp = (\r\n        <div style={{ display: 'inline-block' }}>\r\n          <strong className='title'>(R) </strong>\r\n          <div\r\n            style={{ display: 'inline-block', minWidth: 20, textAlign: 'center', marginRight: 2 }}\r\n            title={`Revisado por: ${attachment.RevisionLog[0].User.name}`}\r\n          >\r\n            {attachment.RevisionLog[0].User.sigla}&nbsp;\r\n          </div>\r\n          <div style={{ display: 'inline-block' }} title={attachment.fecha_revisado}>\r\n            <span className='icon-moon-calendar' /> {Date.create(attachment.fecha_revisado).format('{year}-{MM}-{dd}')}\r\n          </div>\r\n        </div>\r\n      )\r\n    }\r\n\r\n    let revisadoLink\r\n    if (user_has_role([ 'PM', 'SR' ])) {\r\n      if (attachment.fecha_completado) {\r\n        revisadoLink = (\r\n          <button style={{ marginLeft: '8px' }} onClick={(e) => this.changeStatus(e, 'revisado')} className='act'>\r\n            <span className='icon-moon-checkmark-8' /> Revisar\r\n          </button>\r\n        )\r\n      } else {\r\n        revisadoLink = (\r\n          <Popup\r\n            trigger={\r\n              <div className='button-wrapper'>\r\n                <button style={{ marginLeft: '8px' }} className='act disabled'>\r\n                  <span className='icon-moon-checkmark-8' /> Revisar\r\n                </button>\r\n              </div>\r\n            }\r\n            content='Esta archivo adjunto debe estar primero en estado COMPLETADO, para poder ser marcado como REVISADO'\r\n            header='Marcar como Revisado | Opción deshabilitada'\r\n            className='disable-text'\r\n            on='hover'\r\n          />\r\n        )\r\n      }\r\n    }\r\n\r\n    return (\r\n      <li key={attachment.id} style={{ marginBottom: 2 }}>\r\n        <div style={{ background: '#f5f9f8', borderRadius: 6, border: '1px solid #aecec7' }}>\r\n          <div className='col-md-1' style={{ marginTop: 5, borderRight: '1px inset #d7e1e2' }}>\r\n            <img src={AttachmentListItem.getFileIconUrl(attachment.filename)} alt='Icono' />\r\n          </div>\r\n          <div className='col-md-11' style={{ padding: '3px 10px' }}>\r\n            <div\r\n              className='noqtip'\r\n              title={attachment.filename}\r\n              style={{\r\n                fontWeight: 'bold',\r\n                fontSize: '12px',\r\n                maxWidth: 400,\r\n                whiteSpace: 'nowrap',\r\n                overflow: 'hidden',\r\n                textOverflow: 'ellipsis'\r\n              }}\r\n            >\r\n              {attachment.filename}\r\n            </div>\r\n            <div style={{ fontSize: '12px' }}>\r\n              <span\r\n                style={{ fontStyle: 'italic' }}\r\n                className='noqtip'\r\n                title={`Peso del archivo: ${attachment.filesize_human}`}\r\n              >\r\n                {attachment.filesize_human}\r\n              </span>{' '}\r\n              |\r\n              <div className='attachment-actionsbar'>\r\n                <div className='section-a'>\r\n                  <a\r\n                    href={public_path(`uploads/proyecto_adjunto/${attachment.filepath}`)}\r\n                    target='_blank'\r\n                    className='act'\r\n                    style={{ color: '#777' }}\r\n                  >\r\n                    <span className='icon-moon-download' style={{ fontSize: '10px' }} /> Descargar\r\n                  </a>\r\n                </div>\r\n\r\n                {user_has_role([ 'PM', 'SR', 'JR' ]) && (\r\n                  <div className='section-a'>\r\n                    <a href='#' className='act' onClick={this.onRemove}>\r\n                      <span className='icon-tc-trash' /> Borrar\r\n                    </a>\r\n                  </div>\r\n                )}\r\n\r\n                <div className='section-a' style={{ minWidth: 90 }}>\r\n                  {attachment.fecha_completado ? (\r\n                    <Popup trigger={completadoComp} position='bottom center'>\r\n                      <Popup.Header content='Preparado por' />\r\n                      <Popup.Content>\r\n                        <table className='table nowrap'>\r\n                          <tbody>\r\n                            {attachment.UpdateLog.map((item, k) => {\r\n                              return (\r\n                                <tr key={k}>\r\n                                  <td>\r\n                                    <Icon name='user circle' color='green' /> {item.User.name} ({item.User.sigla})\r\n                                  </td>\r\n                                  <td>\r\n                                    <em>{Date.create(item.ts).format('{year}-{MM}-{dd}')}</em>\r\n                                  </td>\r\n                                </tr>\r\n                              )\r\n                            })}\r\n                          </tbody>\r\n                        </table>\r\n                      </Popup.Content>\r\n                    </Popup>\r\n                  ) : (\r\n                    user_has_role([ 'PM', 'SR', 'JR' ]) && (\r\n                      <button\r\n                        style={{ marginLeft: '8px' }}\r\n                        onClick={(e) => this.changeStatus(e, 'completado')}\r\n                        className='act'\r\n                      >\r\n                        <span className='icon-moon-checkmark-8' /> Completar\r\n                      </button>\r\n                    )\r\n                  )}\r\n                </div>\r\n\r\n                <div className='section-a'>\r\n                  {attachment.fecha_revisado && (\r\n                    <Popup trigger={revisadoComp} position='bottom center'>\r\n                      <Popup.Header content='Revisado por' />\r\n                      <Popup.Content>\r\n                        <table className='table nowrap'>\r\n                          <tbody>\r\n                            {attachment.RevisionLog.map((item, k) => {\r\n                              return (\r\n                                <tr key={k}>\r\n                                  <td>\r\n                                    <Icon name='user circle' color='olive' /> {item.User.name} ({item.User.sigla})\r\n                                  </td>\r\n                                  <td>\r\n                                    <em>{Date.create(item.ts).format('{year}-{MM}-{dd}')}</em>\r\n                                  </td>\r\n                                </tr>\r\n                              )\r\n                            })}\r\n                          </tbody>\r\n                        </table>\r\n                      </Popup.Content>\r\n                    </Popup>\r\n                  )}\r\n                  {revisadoLink}\r\n                </div>\r\n              </div>\r\n            </div>\r\n            <div />\r\n          </div>\r\n          <div className='clearfix' />\r\n        </div>\r\n      </li>\r\n    )\r\n  }\r\n}\r\n\r\nexport class AttachmentListPanel extends Component<AttachmentListPanelProps> {\r\n  static defaultProps = {\r\n    isLoading: false\r\n  }\r\n  render() {\r\n    let { isLoading, attachments } = this.props\r\n\r\n    return (\r\n      <div className='attachment-list-panel dimmable' style={{ minHeight: 40 }}>\r\n        {isLoading && (\r\n          <Dimmer inverted active>\r\n            <Loader inverted active className='elastic grey' />\r\n          </Dimmer>\r\n        )}\r\n        <h3 className='panel-title'>\r\n          Adjuntos:\r\n          <Label circular color='green'>\r\n            {_.size(attachments)}\r\n          </Label>\r\n        </h3>\r\n        {_.size(attachments) > 0 && (\r\n          <List divided className='attachment-list'>\r\n            {_.map(attachments, (attachment: ProyectoAttachment, i) => {\r\n              return (\r\n                <AttachmentListItem\r\n                  key={attachment.id}\r\n                  attachment={attachment}\r\n                  onUpdate={this.props.onUpdateItem}\r\n                  onDelete={this.props.onDeleteItem}\r\n                />\r\n              )\r\n            })}\r\n          </List>\r\n        )}\r\n      </div>\r\n    )\r\n  }\r\n}\r\n\r\nexport function cleanAttachmentFrom(value: string, adjunto: ProyectoAttachment) {\r\n  const h = public_path(`uploads/proyecto_adjunto/${adjunto.filepath}`, true).replace(/\\./g, '.').replace(/\\\\/g, '/')\r\n  const t = '<a .*href=\"' + h + '\"(.+?)/a>\\\\s*(<br\\\\s?/?>)?'\r\n  const re = new RegExp(t, 'g')\r\n\r\n  return value.replace(re, '')\r\n}\r\n","import { createContext } from 'react'\r\n\r\nexport default createContext<HojaTrabajoContextType>({ hoja_trabajo: null, update: (data) => {} })\r\n","import { Component, Fragment } from 'react'\r\n\r\nimport Menu from 'semantic-ui-react/dist/commonjs/collections/Menu/Menu'\r\nimport Image from 'semantic-ui-react/dist/commonjs/elements/Image/Image'\r\nimport { MenuItemProps } from 'semantic-ui-react/dist/commonjs/collections/Menu/MenuItem'\r\nimport Icon from 'semantic-ui-react/dist/commonjs/elements/Icon/Icon'\r\n\r\nimport { HojaTrabajoHistoryModal, HojaTrabajoAsignarVisitaModal } from './TabPaneVisitaModals'\r\nimport HojaTrabajoContext from './HojaTrabajoContext'\r\nimport { HojaTrabajoUpdateUtils } from './utils'\r\nimport { MenuItemAjuste } from './sidebar/menuitem_ajuste'\r\nimport { MenuItemHallazgo } from './sidebar/menuitem_hallazgo'\r\nimport { MenuItemRevision } from './sidebar/menuitem_revision'\r\n\r\nimport { HallazgoHojaTrabajoModelManager, RevisionHojaTrabajoModelManager } from './sidebar/menuitem__model_manager'\r\n\r\nimport cx from 'classnames'\r\nimport { MenuItemMuestreo } from './sidebar/menuitem_muestreo'\r\n\r\ntype MenuSidebarVisitaProps = {\r\n  visita: ProyectoPasoVisita\r\n  actionItems?: { [s: string]: boolean | MenuItemProps }\r\n}\r\n\r\ntype MenuSidebarVisitaState = {\r\n  panelOpen: string\r\n  openAsignarUsuarioModal: boolean\r\n}\r\n\r\nexport default class MenuSidebarVisita extends Component<MenuSidebarVisitaProps, MenuSidebarVisitaState> {\r\n  static contextType = HojaTrabajoContext\r\n  static defaultProps = {\r\n    actionItems: {}\r\n  }\r\n\r\n  context: HojaTrabajoContextType\r\n\r\n  state: MenuSidebarVisitaState = {\r\n    panelOpen: null,\r\n    openAsignarUsuarioModal: false\r\n  }\r\n\r\n  isActionItemEnabled(action: string) {\r\n    return typeof this.props.actionItems[`_${action}`] === 'undefined' || this.props.actionItems[`_${action}`]\r\n  }\r\n\r\n  onItemOpen = (item: string) => {\r\n    this.setState({ panelOpen: item })\r\n  }\r\n\r\n  closeAllPanel = () => {\r\n    this.setState({ panelOpen: null })\r\n  }\r\n\r\n  renderAsignUserModal() {\r\n    if (this.state.openAsignarUsuarioModal) {\r\n      const { hoja_trabajo, update } = this.context\r\n      const onSaveAsignarVisita = (id_asignado: string) => {\r\n        const url = url_for(\r\n          `proyecto/${hoja_trabajo.proyecto.id}/hoja-trabajo/paso/${hoja_trabajo.paso.id}/visita/${this.props.visita\r\n            .id_visita}/save`\r\n        )\r\n        $.blockUI(create_blockUI_loading_message('Guardando asignado...'))\r\n\r\n        $.ajax(url, { type: 'POST', data: { op: 'a', paso_id_usuario: id_asignado }, dataType: 'json' }).done((res) => {\r\n          let hoja_trabajo_copy = HojaTrabajoUpdateUtils.updateVisita(\r\n            hoja_trabajo,\r\n            this.props.visita,\r\n            res.response.record\r\n          )\r\n          update(hoja_trabajo_copy)\r\n          $.unblockUI()\r\n        })\r\n\r\n        this.setState({ openAsignarUsuarioModal: false })\r\n      }\r\n\r\n      return (\r\n        <HojaTrabajoAsignarVisitaModal\r\n          visita={this.props.visita}\r\n          onSave={onSaveAsignarVisita}\r\n          onClose={() => this.setState({ openAsignarUsuarioModal: false })}\r\n        />\r\n      )\r\n    }\r\n  }\r\n\r\n  render() {\r\n    const id_proyecto = this.props.visita.HojaTrabajo.proyecto.id\r\n    const id_paso = this.props.visita.HojaTrabajo.paso.id\r\n    const id_visita = this.props.visita.id_visita\r\n    const has_parent = this.props.visita.HojaTrabajo.proyecto.id_parent != null\r\n\r\n    const url_base = `proyecto/${id_proyecto}/paso/${id_paso}/visita/${id_visita}/`\r\n\r\n    const counters = this.props.visita.additionals\r\n\r\n    const image_path = public_path('images/sidebar_right/')\r\n\r\n    return (\r\n      <Fragment>\r\n        <div\r\n          className={cx('sidebar-fixed-overlay ui page dimmer inverted', { active: this.state.panelOpen != null })}\r\n          onClick={() => this.closeAllPanel()}\r\n        />\r\n        <Menu fixed='right' vertical compact icon className='visita-sidebar right-sidebar' id='app-right-sidebar'>\r\n          <Menu.Menu>\r\n            {_.map(this.props.actionItems, (actionItem: MenuItemProps, key: string) => {\r\n              if (key.substr(0, 1) == '_' || actionItem === null) {\r\n                return null\r\n              }\r\n\r\n              const _onClick = actionItem.onClick\r\n              actionItem.onClick = (ev: any, data: any) => {\r\n                this.closeAllPanel()\r\n                _onClick(ev, data)\r\n              }\r\n              return <Menu.Item key={key} {...actionItem} />\r\n            })}\r\n\r\n            {this.props.visita.HojaTrabajo.proyecto.isOpen &&\r\n            user_has_role_permission('paso_asignar_usuario') &&\r\n            this.isActionItemEnabled('assign_user') && (\r\n              <Menu.Item\r\n                link\r\n                title='Asignar usuario a esta visita'\r\n                onClick={(ev) => {\r\n                  this.closeAllPanel()\r\n                  this.setState({ openAsignarUsuarioModal: true })\r\n                }}\r\n              >\r\n                <Icon.Group size='large'>\r\n                  <Icon name='user outline' />\r\n                  <Icon corner name='plus' />\r\n                </Icon.Group>\r\n              </Menu.Item>\r\n            )}\r\n            {this.renderAsignUserModal()}\r\n\r\n            {has_parent &&\r\n            this.isActionItemEnabled('history') && (\r\n              <HojaTrabajoHistoryModal\r\n                trigger={\r\n                  <Menu.Item\r\n                    title='Hoja Trabajo Año Anterior '\r\n                    icon={{ name: 'history', size: 'large' }}\r\n                    onClick={this.closeAllPanel}\r\n                  />\r\n                }\r\n                url={url_for(url_base + 'prev')}\r\n              />\r\n            )}\r\n          </Menu.Menu>\r\n\r\n          <Menu.Menu>\r\n            {this.isActionItemEnabled('ajustes') && (\r\n              <MenuItemAjuste\r\n                counter={counters.ajustes}\r\n                moduleParams={{ id_paso, id_visita, model: 'ajuste' }}\r\n                open={this.state.panelOpen == 'ajuste'}\r\n                onOpen={this.onItemOpen}\r\n                modelManager={null}\r\n              />\r\n            )}\r\n            {this.isActionItemEnabled('hallazgo') && (\r\n              <MenuItemHallazgo\r\n                modelManager={HallazgoHojaTrabajoModelManager.getInstance()}\r\n                counter={counters.hallazgos}\r\n                moduleParams={{ id_paso, id_visita, model: 'hallazgo' }}\r\n                open={this.state.panelOpen == 'hallazgo'}\r\n                onOpen={this.onItemOpen}\r\n              />\r\n            )}\r\n            {this.isActionItemEnabled('muestreo') && (\r\n              <MenuItemMuestreo\r\n                modelManager={null}\r\n                counter={counters.muestreos}\r\n                moduleParams={{ id_paso, id_visita, model: 'muestreo' }}\r\n                open={this.state.panelOpen == 'muestreo'}\r\n                onOpen={this.onItemOpen}\r\n              />\r\n            )}\r\n            {this.isActionItemEnabled('revision') && (\r\n              <MenuItemRevision\r\n                counter={counters.revisiones}\r\n                moduleParams={{ id_paso, id_visita, model: 'revision' }}\r\n                modelManager={RevisionHojaTrabajoModelManager.getInstance(this.context)}\r\n                open={this.state.panelOpen == 'revision'}\r\n                onOpen={this.onItemOpen}\r\n              />\r\n            )}\r\n          </Menu.Menu>\r\n          {this.isActionItemEnabled('pdf') && (\r\n            <Menu.Menu>\r\n              <Menu.Item\r\n                as='a'\r\n                href={url_for(url_base + 'pdf.pdf')}\r\n                target='_blank'\r\n                title='Exportar como PDF'\r\n                content={<Image src={image_path + 'exportar_pdf.svg'} size='large' />}\r\n              />\r\n            </Menu.Menu>\r\n          )}\r\n        </Menu>\r\n      </Fragment>\r\n    )\r\n  }\r\n}\r\n","import Button from 'semantic-ui-react/dist/commonjs/elements/Button/Button'\r\nimport Tab from 'semantic-ui-react/dist/commonjs/modules/Tab/Tab'\r\nimport Progress from 'semantic-ui-react/dist/commonjs/modules/Progress/Progress'\r\nimport Table from 'semantic-ui-react/dist/commonjs/collections/Table/Table'\r\n\r\nimport TableRowInstruccion from './TableRowInstruccion'\r\nimport { PasoObjetivoPane } from './AppVisitaTab'\r\nimport TabPaneVisitaBase from './TabPaneVisitaBase'\r\nimport MenuSidebarVisita from './MenuSidebarVisita'\r\n\r\nimport * as uuid from 'uuid'\r\nimport { DefaultErrorHandler } from '../global/ErrorHandler'\r\n\r\nexport default class TabPaneVisita extends TabPaneVisitaBase<TabPaneVisitaProps, TabPaneVisitaState> {\r\n  constructor(props: TabPaneVisitaProps) {\r\n    super(props)\r\n\r\n    this.state = {\r\n      progress: this.calculateProgress(),\r\n      id_status: '' + props.visita.id_status,\r\n\r\n      openAsignarUsuarioModal: false\r\n    }\r\n  }\r\n\r\n  componentDidMount() {\r\n    const $table = $(`#table-visita-instrucciones-${this.props.visita.id}`)\r\n\r\n    $table.floatThead()\r\n\r\n    if (this.props.isEditable && this.isAllowedAddInstructions() && user_has_role_permission('instruccion_edit')) {\r\n      $table.tableDnD({\r\n        dragHandle: '.sort-handler',\r\n        onDragClass: 'dragging',\r\n        onDragStop: (table: any) => {\r\n          let serialize = []\r\n          const rows = table.rows\r\n\r\n          for (let i: number = 1; i < rows.length; i++) {\r\n            let rowId = rows[i].id.substr(18)\r\n            serialize.push(rowId)\r\n            $(rows[i]).find('.instruction-iteration').text(_.padLeft('' + i, 3, '0') + '.')\r\n          }\r\n\r\n          const url = url_for(`proyecto/${this.props.visita.HojaTrabajo.proyecto.id}/master_data/instruccion/sort`)\r\n          $.ajax(url, {\r\n            type: 'POST',\r\n            data: {\r\n              sort: serialize,\r\n              id_paso: this.props.visita.HojaTrabajo.paso.id,\r\n              id_visita: this.props.visita.id_visita\r\n            },\r\n            dataType: 'json'\r\n          })\r\n        }\r\n      })\r\n    }\r\n  }\r\n\r\n  componentWillUnmount() {\r\n    $(`#table-visita-instrucciones-${this.props.visita.id}`).floatThead('destroy')\r\n  }\r\n\r\n  componentDidUpdate() {\r\n    const $table = $(`#table-visita-instrucciones-${this.props.visita.id}`)\r\n\r\n    setTimeout(function() {\r\n      $table.floatThead('reflow')\r\n    }, 1000)\r\n  }\r\n\r\n  onClickAddInstruccion = () => {\r\n    this.props.visita.instructions.push({\r\n      local_id: uuid.v1(),\r\n      category: null,\r\n      description: null,\r\n      Attachments: [],\r\n      is_done: false,\r\n      Visita: this.props.visita,\r\n      updated_at: null\r\n    })\r\n    this.props.visita.updated_at = Date.create().format('{year}-{MM}-{dd} {hh}:{mm}:{ss}')\r\n\r\n    this.recalculateProgress()\r\n\r\n    if (this.props.isEditable && this.isAllowedSortInstructions() && user_has_role_permission('instruccion_edit')) {\r\n      setTimeout(() => {\r\n        $(`#table-visita-instrucciones-${this.props.visita.id}`).tableDnDUpdate()\r\n      }, 300)\r\n    }\r\n  }\r\n\r\n  calculateProgress() {\r\n    const done_count = this.props.visita.instructions.filter((_item) => _item.is_done).length\r\n    return this.props.visita.instructions.length == 0\r\n      ? 0\r\n      : Math.round(100 * done_count / this.props.visita.instructions.length)\r\n  }\r\n\r\n  isAllowedAddInstructions() {\r\n    return !_.includes([ '2A4', '2A3' ], this.props.visita.HojaTrabajo.paso.code)\r\n  }\r\n\r\n  isAllowedSortInstructions() {\r\n    return !_.includes([ '2A4', '2A3' ], this.props.visita.HojaTrabajo.paso.code)\r\n  }\r\n\r\n  recalculateProgress() {\r\n    const progress = this.calculateProgress()\r\n\r\n    this.setState({ progress })\r\n  }\r\n\r\n  onUpdateInstruccion = (instruccion: Instruccion, key: number) => {\r\n    this.props.visita.instructions[key] = instruccion\r\n    this.recalculateProgress()\r\n  }\r\n\r\n  onRemoveInstruccion = (key: number) => {\r\n    this.props.visita.instructions = this.props.visita.instructions.filter((_, i) => i !== key)\r\n    this.recalculateProgress()\r\n\r\n    $(`#table-visita-instrucciones-${this.props.visita.id} tbody tr`).each(function(i) {\r\n      $(this).find('.instruction-iteration').text(_.padLeft('' + (i + 1), 3, '0') + '.')\r\n    })\r\n  }\r\n\r\n  getCompletadoDisabledText(): string | null {\r\n    if (this.state.progress < 100) {\r\n      return 'Para completar esta hoja de trabajo, es necesario que TODAS las instrucciones estén atendidas.'\r\n    }\r\n\r\n    return null\r\n  }\r\n\r\n  render() {\r\n    const { active, visita } = this.props\r\n\r\n    const menuSidebarActionItems = {\r\n      _ajustes: this.props.type != 'PERIODO',\r\n      _history: this.props.type != 'PERIODO',\r\n      instructions_add:\r\n        this.props.isEditable && this.isAllowedAddInstructions() && user_has_role_permission('instruccion_create')\r\n          ? {\r\n              link: true,\r\n              icon: { name: 'plus', size: 'large' },\r\n              title: 'Añadir Instrucción',\r\n              onClick: this.onClickAddInstruccion\r\n            }\r\n          : null\r\n    }\r\n\r\n    return (\r\n      <Tab.Pane active={active}>\r\n        <div className='visita-progress-container'>\r\n          <Progress className='visita-progress' size='tiny' color='green' percent={this.state.progress} />\r\n          <div className='visita-progress-label'>{`${this.state.progress}%`}</div>\r\n        </div>\r\n\r\n        <DefaultErrorHandler>\r\n          <MenuSidebarVisita visita={visita} actionItems={menuSidebarActionItems} />\r\n        </DefaultErrorHandler>\r\n\r\n        <PasoObjetivoPane isEditable={this.props.isEditable} />\r\n\r\n        <Table stackable className='table-visita-instrucciones' id={`table-visita-instrucciones-${visita.id}`}>\r\n          <Table.Header>\r\n            <Table.Row>\r\n              <Table.HeaderCell className='th-instruccion' colSpan='2'>\r\n                Instrucciones\r\n              </Table.HeaderCell>\r\n              <Table.HeaderCell className='th-accion'>Acción</Table.HeaderCell>\r\n              <Table.HeaderCell className='th-observaciones'>Observaciones/Evidencia</Table.HeaderCell>\r\n              <Table.HeaderCell className='th-adjuntos'>Adjuntos</Table.HeaderCell>\r\n              <Table.HeaderCell className='th-actions computer'>&nbsp;</Table.HeaderCell>\r\n            </Table.Row>\r\n          </Table.Header>\r\n          <Table.Body>{this.renderInstrucciones(visita)}</Table.Body>\r\n        </Table>\r\n\r\n        <div>\r\n          {_.size(visita.instructions) > 0 &&\r\n          this.props.isEditable &&\r\n          this.isAllowedAddInstructions() &&\r\n          user_has_role_permission('instruccion_create') && (\r\n            <div className='ab-actions-group compact-actions'>\r\n              <Button\r\n                primary\r\n                floated='left'\r\n                compact\r\n                icon='plus'\r\n                content='Añadir Instrucción'\r\n                onClick={this.onClickAddInstruccion}\r\n              />\r\n            </div>\r\n          )}\r\n\r\n          {_.size(visita.instructions) > 0 && this.renderStatusActions()}\r\n        </div>\r\n      </Tab.Pane>\r\n    )\r\n  }\r\n\r\n  renderInstrucciones(visita: ProyectoPasoVisita) {\r\n    if (_.size(visita.instructions) == 0) {\r\n      return (\r\n        <Table.Row>\r\n          <Table.Cell colSpan='6' style={{ textAlign: 'center' }}>\r\n            <div className='alert alert-block nocontent'>\r\n              <h3>Sin instrucciones </h3>\r\n              <p>\r\n                <span className='icon-warning-sign' />Esta hoja de trabajo aún no tiene instrucciones registradas.{' '}\r\n              </p>\r\n              {this.props.isEditable &&\r\n              user_has_role_permission('instruccion_create') && [\r\n                <Button\r\n                  key='button'\r\n                  content='Agregar instrucción'\r\n                  color='green'\r\n                  compact\r\n                  icon='info circle'\r\n                  onClick={this.onClickAddInstruccion}\r\n                  style={{ marginTop: '30px' }}\r\n                />\r\n              ]}\r\n            </div>\r\n          </Table.Cell>\r\n        </Table.Row>\r\n      )\r\n    }\r\n\r\n    let instructions = _.map(visita.instructions, function(item, k) {\r\n      item.index = k\r\n      return item\r\n    })\r\n    let instructionGroups = _.values(\r\n      _.map(_.groupBy(instructions, 'category'), function(item, k) {\r\n        return { text: k, instructions: item }\r\n      })\r\n    )\r\n\r\n    let rows: JSX.Element[] = []\r\n    instructionGroups.forEach((instruccionGroup: { text: string; instructions: Instruccion[] }, i: number) => {\r\n      if (instruccionGroup.text != '' && instruccionGroup.text != 'null' && instruccionGroup.text != null) {\r\n        rows.push(\r\n          <tr key={i} className='macroinstruccion-row nodrag nodrop'>\r\n            <td colSpan={6}>{instruccionGroup.text}</td>\r\n          </tr>\r\n        )\r\n      }\r\n\r\n      instruccionGroup.instructions.forEach((instruccion: Instruccion, j: number) => {\r\n        instruccion.Visita = visita\r\n        rows.push(\r\n          <TableRowInstruccion\r\n            key={instruccion.local_id}\r\n            index={instruccion.index}\r\n            iteration={j}\r\n            instruccion={instruccion}\r\n            isEditable={this.props.isEditable}\r\n            isSortable={this.props.isEditable && this.isAllowedSortInstructions()}\r\n            onUpdate={this.onUpdateInstruccion}\r\n            onRemove={this.onRemoveInstruccion}\r\n            onUpdateVisita={this.onUpdate}\r\n          />\r\n        )\r\n      })\r\n    })\r\n\r\n    return rows\r\n  }\r\n}\r\n","import { Component } from 'react'\r\n\r\nimport Button from 'semantic-ui-react/dist/commonjs/elements/Button/Button'\r\nimport Icon from 'semantic-ui-react/dist/commonjs/elements/Icon'\r\nimport Popup from 'semantic-ui-react/dist/commonjs/modules/Popup'\r\n\r\nclass TabPaneVisitaBase<P extends TabPaneVisitaProps, S extends TabPaneVisitaState> extends Component<P, S> {\r\n  static defaultProps = {\r\n    type: 'DEFAULT'\r\n  }\r\n\r\n  static getDerivedStateFromProps(nextProps: TabPaneVisitaProps, prevState: TabPaneVisitaState) {\r\n    if (nextProps.visita.id_status != prevState.id_status) {\r\n      return { id_status: '' + nextProps.visita.id_status }\r\n    }\r\n\r\n    return null\r\n  }\r\n\r\n  onClickCompletado = () => {\r\n    const url = url_for(\r\n      `proyecto/${this.props.visita.HojaTrabajo.proyecto.id}/hoja-trabajo/paso/${this.props.visita.HojaTrabajo.paso\r\n        .id}/visita/${this.props.visita.id_visita}/save`\r\n    )\r\n    let loadingMessage =\r\n      this.props.type == 'PERIODO' ? 'Marcando periodo como Completado...' : 'Marcando visita como Completada...'\r\n    $.blockUI(create_blockUI_loading_message(loadingMessage))\r\n    $.ajax(url, { type: 'POST', data: { op: 'c' }, dataType: 'json' }).done((res) => {\r\n      if (res.hasErrors) {\r\n        $.unblockUI()\r\n        bootbox.alert(res.message)\r\n      } else {\r\n        this.updateVisita(res.response.record)\r\n        $.unblockUI()\r\n      }\r\n    })\r\n  }\r\n\r\n  onClickRevisado = () => {\r\n    const url = url_for(\r\n      `proyecto/${this.props.visita.HojaTrabajo.proyecto.id}/hoja-trabajo/paso/${this.props.visita.HojaTrabajo.paso\r\n        .id}/visita/${this.props.visita.id_visita}/save`\r\n    )\r\n    let loadingMessage =\r\n      this.props.type == 'PERIODO' ? 'Marcando periodo como Revisado...' : 'Marcando visita como Revisada...'\r\n    $.blockUI(create_blockUI_loading_message(loadingMessage))\r\n    $.ajax(url, { type: 'POST', data: { op: 'r' }, dataType: 'json' }).done((res) => {\r\n      if (res.hasErrors) {\r\n        $.unblockUI()\r\n        bootbox.alert(res.message)\r\n      } else {\r\n        this.updateVisita(res.response.record)\r\n        $.unblockUI()\r\n      }\r\n    })\r\n  }\r\n\r\n  updateVisita(_visita: any) {\r\n    let visita: ProyectoPasoVisita = Object.assign(this.props.visita, _visita)\r\n    this.props.onChange(visita)\r\n    this.setState({ id_status: '' + visita.id_status })\r\n  }\r\n\r\n  onUpdate = (visitas: ProyectoPasoVisita[], instrucciones?: InstruccionDataModifiedSchema[]) => {\r\n    if (!$.isArray(visitas)) {\r\n      visitas = [ visitas ]\r\n    }\r\n    this.updateVisita(visitas[0])\r\n\r\n    // Actualizar el estado de las demas visitas afectadas\r\n    visitas = _.rest(visitas)\r\n    if (_.size(visitas)) {\r\n      _.forEach(visitas, (visita: ProyectoPasoVisita) => {\r\n        let _visita = _.find(this.props.visita.HojaTrabajo.visitas, { id_visita: visita.id_visita })\r\n        _visita = Object.assign(_visita, visita)\r\n      })\r\n    }\r\n\r\n    // Actualizar la informacion de las instrucciones afectadas\r\n\r\n    if (instrucciones) {\r\n      _.forEach(instrucciones, (instruccion_mdata: InstruccionDataModifiedSchema) => {\r\n        let visita = _.find(this.props.visita.HojaTrabajo.visitas, { id_visita: instruccion_mdata.id_visita })\r\n\r\n        switch (instruccion_mdata.cmd) {\r\n          case 'CREATE':\r\n            visita.instructions.push(instruccion_mdata.data)\r\n            break\r\n          case 'UPDATE':\r\n            visita.instructions = _.map(visita.instructions, function(instruccion) {\r\n              if (instruccion.local_id == instruccion_mdata.data.local_id) {\r\n                return Object.assign(instruccion, instruccion_mdata.data)\r\n              } else {\r\n                return instruccion\r\n              }\r\n            })\r\n            break\r\n        }\r\n      })\r\n    }\r\n  }\r\n\r\n  getCompletadoDisabledText(): string | null {\r\n    return null\r\n  }\r\n\r\n  getRevisadoDisabledText(): string | null {\r\n    let modelLabel = this.props.type == 'PERIODO' ? 'Este periodo' : 'Esta visita'\r\n    if (_.includes([ '1', '2', '3' ], this.state.id_status) || this.getCompletadoDisabledText()) {\r\n      return (\r\n        modelLabel + ' debe estar primero en estado COMPLETADO, para poder marcar esta hoja de trabajo como REVISADA.'\r\n      )\r\n    } else if (_.includes([ '6' ], this.state.id_status)) {\r\n      return (\r\n        modelLabel +\r\n        ' tiene Notas de Revisión que deben primero ser atendidas para poder marcar esta hoja de trabajo como REVISADA.'\r\n      )\r\n    } else if (this.props.visita.additionals.revisiones > 0) {\r\n      return (\r\n        modelLabel +\r\n        ' tiene Notas de Revisión pendientes por revisar que deben primero ser revisadas para poder marcar esta hoja de trabajo como REVISADA.'\r\n      )\r\n    }\r\n\r\n    return null\r\n  }\r\n\r\n  renderStatusActions() {\r\n    if (!this.props.isEditable) {\r\n      return null\r\n    }\r\n\r\n    const revisado_disabled_text = this.getRevisadoDisabledText()\r\n\r\n    let icon_revisado_alert\r\n    const visita = this.props.visita\r\n    if (\r\n      visita.fecha_completado &&\r\n      visita.fecha_revision &&\r\n      Date.create(visita.fecha_completado) > Date.create(visita.fecha_revision)\r\n    ) {\r\n      let modelLabel = this.props.type == 'PERIODO' ? 'Este periodo' : 'Esta visita'\r\n      icon_revisado_alert = (\r\n        <Popup\r\n          trigger={<Icon color='red' name='warning circle' />}\r\n          content={modelLabel + ' ha recibido modificaciones después de su última revisión.'}\r\n        />\r\n      )\r\n    }\r\n\r\n    const completado_disabled_text = this.getCompletadoDisabledText()\r\n\r\n    return (\r\n      <div className='actions ab-status-actions'>\r\n        {user_has_role_permission('paso_completado') && (\r\n          <Popup\r\n            trigger={\r\n              <div className='button-wrapper'>\r\n                <Button\r\n                  primary\r\n                  icon\r\n                  compact\r\n                  onClick={this.onClickCompletado}\r\n                  disabled={completado_disabled_text != null}\r\n                >\r\n                  {' '}\r\n                  <Icon name='check' /> Completado\r\n                </Button>\r\n              </div>\r\n            }\r\n            content={completado_disabled_text}\r\n            header='Marcar como Completado | Opción deshabilitada'\r\n            disabled={completado_disabled_text == null}\r\n            className='disable-text'\r\n            on='hover'\r\n          />\r\n        )}\r\n        {user_has_role_permission([ 'paso_revisado' ]) && (\r\n          <Popup\r\n            trigger={\r\n              <div className='button-wrapper'>\r\n                <Button\r\n                  color='olive'\r\n                  icon\r\n                  compact\r\n                  onClick={this.onClickRevisado}\r\n                  disabled={revisado_disabled_text != null}\r\n                >\r\n                  {' '}\r\n                  <Icon name='check' fitted />\r\n                  <Icon name='check' /> Revisado {icon_revisado_alert}\r\n                </Button>\r\n              </div>\r\n            }\r\n            content={revisado_disabled_text}\r\n            header='Marcar como Revisado | Opción deshabilitada'\r\n            disabled={revisado_disabled_text == null}\r\n            className='disable-text'\r\n            on='hover'\r\n          />\r\n        )}\r\n      </div>\r\n    )\r\n  }\r\n}\r\n\r\nexport default TabPaneVisitaBase\r\n","import { Component } from 'react'\r\nimport CKeditor from 'ckeditor4-react'\r\n\r\nimport Button from 'semantic-ui-react/dist/commonjs/elements/Button/Button'\r\nimport Loader from 'semantic-ui-react/dist/commonjs/elements/Loader'\r\nimport Modal from 'semantic-ui-react/dist/commonjs/modules/Modal'\r\nimport Dropdown from 'semantic-ui-react/dist/commonjs/modules/Dropdown'\r\n\r\nexport class HojaTrabajoHistoryModal extends Component<{ trigger: any; url: string }> {\r\n  state = {\r\n    content: ''\r\n  }\r\n\r\n  onOpen = () => {\r\n    if (this.state.content == '') {\r\n      const ckeditorOptions = {\r\n        height: 350,\r\n        removePlugins: 'elementspath, uploadfile',\r\n        toolbar: [ {} ]\r\n      }\r\n\r\n      this.setState({ content: <Loader active /> })\r\n      $.ajax(this.props.url, { dataType: 'json' }).done((res) => {\r\n        if (res.hasErrors) {\r\n          this.setState({\r\n            content: (\r\n              <div style={{ color: 'red', textAlign: 'center', fontSize: '18px', fontWeight: 'bold', marginTop: 25 }}>\r\n                Hoja de Trabajo NO disponible\r\n              </div>\r\n            )\r\n          })\r\n        } else {\r\n          let content = `&nbsp;<div class='watermark-text' style='color:#08828a33; font-size:70px; font-weight: bold; transform:rotate(340deg); -webkit-transform:rotate(340deg); left: 35%; position: absolute; -webkit-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none;  '>Hoja Trabajo<br>Año Anterior</div>\r\n          <div class='watermarked-content' style='position:absolute; z-index:1;  margin-right: 20px; '>${res.response\r\n            .content}</div>&nbsp;`\r\n          this.setState({ content: <CKeditor data={content} readOnly config={ckeditorOptions} /> })\r\n        }\r\n      })\r\n    }\r\n  }\r\n\r\n  render() {\r\n    return (\r\n      <Modal\r\n        closeIcon\r\n        trigger={this.props.trigger}\r\n        content={this.state.content}\r\n        header='Hoja de Trabajo - Año Anterior'\r\n        closeOnDimmerClick={false}\r\n        onOpen={this.onOpen}\r\n        size='fullscreen'\r\n        dimmer='inverted'\r\n        style={{ minHeight: 400 }}\r\n        className='modal-ab'\r\n      />\r\n    )\r\n  }\r\n}\r\n\r\ninterface HojaTrabajoAsignarVisitaModalProps {\r\n  visita: ProyectoPasoVisita\r\n  onSave: (id_usuario_asignado: string) => void\r\n  onClose: () => void\r\n}\r\n\r\nexport class HojaTrabajoAsignarVisitaModal extends Component<\r\n  HojaTrabajoAsignarVisitaModalProps,\r\n  { id_asignado: string }\r\n> {\r\n  constructor(props: HojaTrabajoAsignarVisitaModalProps) {\r\n    super(props)\r\n\r\n    this.state = {\r\n      id_asignado: props.visita.id_usuario_asignado\r\n    }\r\n  }\r\n\r\n  onChange = (ev: React.SyntheticEvent, data: any) => {\r\n    this.setState({ id_asignado: data.value })\r\n  }\r\n\r\n  onSave = () => {\r\n    this.props.onSave(this.state.id_asignado)\r\n    this.props.onClose()\r\n  }\r\n\r\n  onClose = () => {\r\n    this.props.onClose()\r\n  }\r\n\r\n  render() {\r\n    const { visita } = this.props\r\n\r\n    let equipo = _.filter(visita.HojaTrabajo.equipo, function(item) {\r\n      return item.rol.is_assignable\r\n    })\r\n\r\n    const equipoOptions: any = _.map(equipo, function(item) {\r\n      return {\r\n        key: item.user_id,\r\n        text: item.name,\r\n        value: item.user_id,\r\n        description: item.rol.name,\r\n        label: { content: item.sigla, circular: true, color: 'green' }\r\n      }\r\n    })\r\n\r\n    return (\r\n      <Modal\r\n        closeIcon\r\n        open\r\n        closeOnDimmerClick={false}\r\n        size='tiny'\r\n        dimmer='inverted'\r\n        className='modal-ab'\r\n        onClose={this.onClose}\r\n      >\r\n        <Modal.Header>Asignar/Reasignar visita a usuario</Modal.Header>\r\n        <Modal.Content>\r\n          <blockquote>\r\n            <strong>Visita: </strong> {visita.label}\r\n          </blockquote>\r\n          <Dropdown\r\n            placeholder='Seleccione el usuario'\r\n            defaultValue={visita.id_usuario_asignado}\r\n            selection\r\n            clearable\r\n            fluid\r\n            options={equipoOptions}\r\n            onChange={this.onChange}\r\n          />\r\n        </Modal.Content>\r\n        <Modal.Actions>\r\n          <Button primary content='Aceptar' onClick={this.onSave} />\r\n        </Modal.Actions>\r\n      </Modal>\r\n    )\r\n  }\r\n}\r\n","import { Component } from 'react'\r\n\r\nimport Button from 'semantic-ui-react/dist/commonjs/elements/Button/Button'\r\nimport Icon from 'semantic-ui-react/dist/commonjs/elements/Icon'\r\nimport Loader from 'semantic-ui-react/dist/commonjs/elements/Loader'\r\nimport Label from 'semantic-ui-react/dist/commonjs/elements/Label'\r\nimport Table from 'semantic-ui-react/dist/commonjs/collections/Table'\r\nimport Dropdown from 'semantic-ui-react/dist/commonjs/modules/Dropdown'\r\nimport Dimmer from 'semantic-ui-react/dist/commonjs/modules/Dimmer'\r\nimport Select from 'semantic-ui-react/dist/commonjs/addons/Select'\r\n\r\nimport EditorPreview from '../global/EditorPreview'\r\nimport { AttachmentListPanel } from './Attachments'\r\n\r\nexport default class TableRowInstruccion extends Component<TableRowInstruccionProps, TableRowInstruccionState> {\r\n  constructor(props: TableRowInstruccionProps) {\r\n    super(props)\r\n\r\n    this.state = {\r\n      instruccion: props.instruccion,\r\n      isEditorOpen: false,\r\n      isLoadingAttachments: false\r\n    }\r\n  }\r\n\r\n  static getDerivedStateFromProps(nextProps: TableRowInstruccionProps, prevState: TableRowInstruccionState) {\r\n    if (nextProps.instruccion.updated_at != prevState.instruccion.updated_at) {\r\n      return { instruccion: nextProps.instruccion }\r\n    }\r\n\r\n    return null\r\n  }\r\n\r\n  // Static methods\r\n\r\n  evalIsDone = (instruccion: Instruccion) => {\r\n    if (instruccion.answer) {\r\n      return true\r\n    }\r\n\r\n    if (instruccion.observations) {\r\n      return true\r\n    }\r\n\r\n    return false\r\n  }\r\n\r\n  checkIsDoneDisabled = (instruccion: Instruccion) => {\r\n    if (!user_has_role_permission('hoja_trabajo_edit')) {\r\n      return true\r\n    }\r\n    if (!this.props.isEditable) {\r\n      return true\r\n    }\r\n    if (instruccion.answer) {\r\n      return false\r\n    }\r\n\r\n    if (instruccion.observations) {\r\n      return false\r\n    }\r\n\r\n    return true\r\n  }\r\n\r\n  onChecked = (event: React.SyntheticEvent) => {\r\n    const checked = (event.target as any).checked\r\n    this.setState(\r\n      (state: TableRowInstruccionState) => {\r\n        let instruccion = Object.assign({}, state.instruccion)\r\n        instruccion.is_done = checked\r\n\r\n        return { instruccion }\r\n      },\r\n      () => this.props.onUpdate(this.state.instruccion, this.props.index)\r\n    )\r\n  }\r\n\r\n  onActionChanged = (event: React.SyntheticEvent, data: any) => {\r\n    this.updateModel('answer', data.value)\r\n  }\r\n\r\n  onChangeEditor = (field: 'observations' | 'description') => (\r\n    editor: CKEDITOR.editor,\r\n    closeModal: boolean = false,\r\n    autosave: boolean = false,\r\n    cb: () => void\r\n  ) => {\r\n    if (field == 'description') {\r\n      $.blockUI(create_blockUI_loading_message('Guardando los cambios... Por Favor Espere'))\r\n      this.updateModel(field, editor.getData(), () => {\r\n        if ($.isFunction(cb)) {\r\n          cb()\r\n        }\r\n        $.unblockUI()\r\n      })\r\n    } else {\r\n      this.updateModel(field, editor.getData(), cb)\r\n    }\r\n    if (closeModal) {\r\n      this.setState({ isEditorOpen: false })\r\n    }\r\n  }\r\n\r\n  onRemove = () => {\r\n    bootbox.warningConfirm('¿Desea eliminar permanentemente esta instruccion ?', 'Cancelar', 'Aceptar', (r) => {\r\n      if (r) {\r\n        $.blockUI(create_blockUI_loading_message('Eliminando instrucción...'))\r\n        this.props.onRemove(this.props.index)\r\n\r\n        if (this.props.instruccion.id) {\r\n          const url = url_for(\r\n            `proyecto/${this.state.instruccion.Visita.HojaTrabajo.proyecto.id}/hoja-trabajo/instruccion/remove`\r\n          )\r\n          $.ajax(url, {\r\n            type: 'POST',\r\n            data: { id: { local_id: this.props.instruccion.local_id } },\r\n            dataType: 'json'\r\n          }).done((res) => {\r\n            if (res.response.record) {\r\n              this.props.onUpdateVisita([ res.response.record ])\r\n            }\r\n            $.unblockUI()\r\n          })\r\n        } else {\r\n          $.unblockUI()\r\n        }\r\n      }\r\n    })\r\n  }\r\n\r\n  onUpload = () => {\r\n    this.fetchAttachments()\r\n  }\r\n\r\n  onClickAttachmentCell = (ev: React.SyntheticEvent) => {\r\n    ev.preventDefault()\r\n    this.setState({ isEditorOpen: true })\r\n  }\r\n\r\n  onUpdateAttachment = () => {\r\n    this.fetchAttachments()\r\n  }\r\n\r\n  onDeleteAttachment = (adjunto: ProyectoAttachment, cb: () => void) => {\r\n    this.fetchAttachments()\r\n    this.setState(\r\n      (state) => {\r\n        let instruccion: Instruccion = Object.assign({}, state.instruccion)\r\n\r\n        // ------ Try to remove links to file\r\n        const h = public_path(`uploads/proyecto_adjunto/${adjunto.filepath}`, true)\r\n          .replace(/\\./g, '.')\r\n          .replace(/\\\\/g, '/')\r\n        const t = '<a .*href=\"' + h + '\"(.+?)/a>\\\\s*(<br\\\\s?/?>)?'\r\n        const re = new RegExp(t, 'g')\r\n        instruccion.observations = instruccion.observations.replace(re, '')\r\n\r\n        this.updateModel('observations', instruccion.observations)\r\n\r\n        return { instruccion }\r\n      },\r\n      () => {\r\n        if ($.isFunction(cb)) {\r\n          cb()\r\n        }\r\n      }\r\n    )\r\n  }\r\n\r\n  // Class methods\r\n\r\n  getFormattedIteration() {\r\n    return _.padLeft(String(this.props.iteration + 1), 3, '0')\r\n  }\r\n\r\n  getFormattedDescription() {\r\n    let instruccion = this.state.instruccion.description\r\n    if (instruccion == null) {\r\n      return ''\r\n    }\r\n\r\n    instruccion = instruccion.replace(/(?!^)\\([a-z]\\)/gs, '<br/>&nbsp;&nbsp;$& ')\r\n\r\n    return (\r\n      '<span key=\"instruction-iteration\" class=\"instruction-iteration\">' +\r\n      this.getFormattedIteration() +\r\n      '.</span> ' +\r\n      instruccion\r\n    )\r\n  }\r\n\r\n  getFormattedObservations() {\r\n    let observaciones = this.state.instruccion.observations\r\n\r\n    if (!observaciones) {\r\n      return ''\r\n    }\r\n\r\n    observaciones = observaciones.trim()\r\n\r\n    var cleanHtml = observaciones.replace(/<img.*?>/gs, ' [** IMAGEN ó TABLA **] ')\r\n\r\n    cleanHtml = cleanHtml.replace(/<table.*?\\/table>/gs, '[** TABLA **]')\r\n    cleanHtml = cleanHtml.replace(/<figure.*?\\/figure>/gs, '[** IMAGEN **]')\r\n    cleanHtml = cleanHtml.replace(/<\\/p>/g, '<br>')\r\n    cleanHtml = cleanHtml.replace(/<\\/h\\d>/g, '<br>')\r\n    cleanHtml = cleanHtml.replace(/&nbsp;/g, '')\r\n\r\n    cleanHtml = cleanHtml.replace(/<(?!(br)\\s*\\/?)[^>]+>/gs, '')\r\n    cleanHtml = cleanHtml.replace(/<br>\\s*<br>/gs, '<br>')\r\n\r\n    cleanHtml = cleanHtml.replace(/\\[\\*\\*(.+?)\\*\\*\\]/gs, '<span class=\"special-tag\">$&</span>')\r\n\r\n    return cleanHtml\r\n  }\r\n\r\n  doUpdateModel(\r\n    field: TableRowInstruccionUpdatableField,\r\n    value: any,\r\n    cb?: (modified_data: TableRowInstruccionServerDataParamData[]) => void\r\n  ) {\r\n    let modified_data: TableRowInstruccionServerDataParamData[] = []\r\n    this.setState(\r\n      (state) => {\r\n        let instruccion: Instruccion = Object.assign({}, state.instruccion)\r\n        if (_.str.trim(value) == '') {\r\n          value = null\r\n        }\r\n        if (field == 'is_done') {\r\n          instruccion[field] = !!value\r\n        } else {\r\n          instruccion[field] = value\r\n        }\r\n\r\n        modified_data.push({ field, value })\r\n\r\n        if (field != 'description') {\r\n          instruccion.is_done = this.evalIsDone(instruccion)\r\n          modified_data.push({ field: 'is_done', value: instruccion.is_done ? 1 : 0 })\r\n        }\r\n\r\n        if (\r\n          field == 'observations' &&\r\n          instruccion.observations != null &&\r\n          instruccion.observations != '' &&\r\n          !instruccion.answer\r\n        ) {\r\n          instruccion.answer = 'Hecho'\r\n          modified_data.push({ field: 'answer', value: 'Hecho' })\r\n        }\r\n\r\n        return { instruccion }\r\n      },\r\n      () => {\r\n        this.props.onUpdate(this.state.instruccion, this.props.index)\r\n        if ($.isFunction(cb)) {\r\n          cb(modified_data)\r\n        }\r\n      }\r\n    )\r\n  }\r\n\r\n  updateModel(field: TableRowInstruccionUpdatableField, value: any, cb?: () => void) {\r\n    this.doUpdateModel(field, value, (modified_data: TableRowInstruccionServerDataParamData[]) => {\r\n      this.sendInstructionToServer(modified_data, () => {\r\n        this.fetchAttachments(false)\r\n        if ($.isFunction(cb)) {\r\n          cb()\r\n        }\r\n      })\r\n    })\r\n  }\r\n\r\n  sendInstructionToServer(data: TableRowInstruccionServerDataParamData[], cb: () => void = null) {\r\n    const params_data: TableRowInstruccionServerDataParams = {\r\n      id: { local_id: this.state.instruccion.local_id },\r\n      id_paso: this.state.instruccion.Visita.HojaTrabajo.paso.id,\r\n      id_visita: this.state.instruccion.Visita.id_visita,\r\n      data\r\n    }\r\n    const url = url_for(`proyecto/${this.state.instruccion.Visita.HojaTrabajo.proyecto.id}/hoja-trabajo/instruccion`)\r\n    if (!this.state.instruccion.id) {\r\n      $.blockUI(create_blockUI_loading_message('Creando instrucción...'))\r\n    }\r\n    $.ajax(url, { type: 'POST', data: params_data, dataType: 'json' }).done((res) => {\r\n      if (res.response.new) {\r\n        this.setState({ instruccion: Object.assign({}, this.state.instruccion, res.response.record) })\r\n        $.unblockUI()\r\n      }\r\n\r\n      this.props.onUpdateVisita(res.response.visitas, res.response.changed)\r\n      if ($.isFunction(cb)) {\r\n        cb()\r\n      }\r\n    })\r\n  }\r\n\r\n  fetchAttachments(showLoading: boolean = true) {\r\n    if (showLoading) {\r\n      this.setState({ isLoadingAttachments: true })\r\n    }\r\n\r\n    const url = url_for(\r\n      `proyecto/${this.state.instruccion.Visita.HojaTrabajo.proyecto.id}/hoja-trabajo/instruccion/attachments`\r\n    )\r\n    $.ajax(url, { type: 'GET', data: { local_id: this.state.instruccion.local_id }, dataType: 'json' }).done((res) => {\r\n      this.doUpdateModel('Attachments', res.response.Attachments)\r\n      this.setState({ isLoadingAttachments: false })\r\n    })\r\n  }\r\n\r\n  render() {\r\n    const { instruccion } = this.state\r\n\r\n    let actionChoices: any[] = [ 'Hecho', 'Sí', 'No', 'Cumple', 'No Cumple', 'Aplica', 'No Aplica' ]\r\n    actionChoices = actionChoices.map((_item) => ({ key: _item, value: _item, text: _item }))\r\n\r\n    const formattedDescription = this.getFormattedDescription()\r\n    const ckeditorOptionsInstr = {\r\n      uploadUrl: url_for(\r\n        'proyecto/' +\r\n          instruccion.Visita.HojaTrabajo.proyecto.id +\r\n          '/master_data/paso/' +\r\n          instruccion.Visita.HojaTrabajo.paso.id +\r\n          '/upload?id_visita=' +\r\n          instruccion.Visita.id_visita +\r\n          '&model=instruccion_item__instr&model_id=' +\r\n          instruccion.local_id\r\n      ),\r\n      imageUploadUrl: url_for(\r\n        'proyecto/' +\r\n          instruccion.Visita.HojaTrabajo.proyecto.id +\r\n          '/master_data/paso/' +\r\n          instruccion.Visita.HojaTrabajo.paso.id +\r\n          '/upload?id_visita=' +\r\n          instruccion.Visita.id_visita +\r\n          '&model=instruccion_item__instr&model_id=' +\r\n          instruccion.local_id\r\n      ),\r\n      filebrowserUploadUrl: url_for(\r\n        'proyecto/' +\r\n          instruccion.Visita.HojaTrabajo.proyecto.id +\r\n          '/master_data/paso/' +\r\n          instruccion.Visita.HojaTrabajo.paso.id +\r\n          '/upload?id_visita=' +\r\n          instruccion.Visita.id_visita +\r\n          '&n=attachment&model=instruccion_item__instr&model_id=' +\r\n          instruccion.local_id\r\n      ),\r\n      link_to_muestreo_enabled: true\r\n    }\r\n\r\n    const ckeditorOptionsObs = {\r\n      uploadUrl: url_for(\r\n        'proyecto/' +\r\n          instruccion.Visita.HojaTrabajo.proyecto.id +\r\n          '/master_data/paso/' +\r\n          instruccion.Visita.HojaTrabajo.paso.id +\r\n          '/upload?id_visita=' +\r\n          instruccion.Visita.id_visita +\r\n          '&model=instruccion_item__obs&model_id=' +\r\n          instruccion.local_id\r\n      ),\r\n      imageUploadUrl: url_for(\r\n        'proyecto/' +\r\n          instruccion.Visita.HojaTrabajo.proyecto.id +\r\n          '/master_data/paso/' +\r\n          instruccion.Visita.HojaTrabajo.paso.id +\r\n          '/upload?id_visita=' +\r\n          instruccion.Visita.id_visita +\r\n          '&model=instruccion_item__obs&model_id=' +\r\n          instruccion.local_id\r\n      ),\r\n      filebrowserUploadUrl: url_for(\r\n        'proyecto/' +\r\n          instruccion.Visita.HojaTrabajo.proyecto.id +\r\n          '/master_data/paso/' +\r\n          instruccion.Visita.HojaTrabajo.paso.id +\r\n          '/upload?id_visita=' +\r\n          instruccion.Visita.id_visita +\r\n          '&n=attachment&model=instruccion_item__obs&model_id=' +\r\n          instruccion.local_id\r\n      ),\r\n      link_to_muestreo_enabled: true\r\n    }\r\n\r\n    const attachmentsList = (\r\n      <div style={{ position: 'relative' }}>\r\n        <Dimmer inverted active={this.state.isLoadingAttachments}>\r\n          <Loader inverted />\r\n        </Dimmer>\r\n        <AttachmentListPanel\r\n          attachments={instruccion.Attachments}\r\n          onUpdateItem={this.onUpdateAttachment}\r\n          onDeleteItem={this.onDeleteAttachment}\r\n        />\r\n      </div>\r\n    )\r\n\r\n    let modalLeftActions = null\r\n    if (this.props.isEditable && user_has_role_permission('instruccion_delete')) {\r\n      modalLeftActions = (\r\n        <Button\r\n          negative\r\n          floated='left'\r\n          icon='trash alternate outline'\r\n          content='Eliminar instrucción'\r\n          onClick={this.onRemove}\r\n        />\r\n      )\r\n    }\r\n\r\n    return (\r\n      <Table.Row\r\n        className={`hoverable-actions instruccion-row ${this.props.iteration % 2 ? 'even' : 'odd'}`}\r\n        id={`table-instruccion-${instruccion.local_id}`}\r\n      >\r\n        <Table.Cell className='td-chk' collapsing>\r\n          <label className='container-checkbox'>\r\n            <input\r\n              id={`checkbox-${instruccion.id}`}\r\n              type='checkbox'\r\n              checked={instruccion.is_done}\r\n              disabled={this.checkIsDoneDisabled(instruccion)}\r\n              value='1'\r\n              onChange={this.onChecked}\r\n            />\r\n            <span className='checkmark' />\r\n          </label>\r\n          {this.props.isEditable &&\r\n          this.props.isSortable &&\r\n          user_has_role_permission('hoja_trabajo_edit') && (\r\n            <div className='action-list'>\r\n              <div className='drag-icon sort-handler' />\r\n            </div>\r\n          )}\r\n        </Table.Cell>\r\n        <Table.Cell width='6' className='instruction-text'>\r\n          <EditorPreview\r\n            className='instruction-text-editor'\r\n            ckeditorOptions={ckeditorOptionsInstr}\r\n            preview={formattedDescription}\r\n            data={instruccion.description}\r\n            required\r\n            label=' '\r\n            labelTitle='Descripción de la instrucción'\r\n            open={!instruccion.id && !instruccion.description}\r\n            editable={this.props.isEditable && user_has_role_permission('instruccion_edit')}\r\n            leftActions={modalLeftActions}\r\n            autosave\r\n            onSave={this.onChangeEditor('description')}\r\n          />\r\n        </Table.Cell>\r\n        <Table.Cell style={{ width: 'auto' }}>\r\n          {this.props.isEditable && user_has_role_permission('hoja_trabajo_edit') ? (\r\n            <Select\r\n              placeholder='Seleccione...'\r\n              className='instruccion-action'\r\n              value={instruccion.answer}\r\n              clearable\r\n              onChange={this.onActionChanged}\r\n              options={actionChoices}\r\n            />\r\n          ) : (\r\n            <span>{instruccion.answer}</span>\r\n          )}\r\n        </Table.Cell>\r\n        <Table.Cell width='7' className='observations-text'>\r\n          <EditorPreview\r\n            className='observations-text-editor'\r\n            ckeditorOptions={ckeditorOptionsObs}\r\n            preview={this.getFormattedObservations()}\r\n            data={instruccion.observations}\r\n            label={formattedDescription}\r\n            open={this.state.isEditorOpen}\r\n            editable={this.props.isEditable && user_has_role_permission('hoja_trabajo_edit')}\r\n            autosave\r\n            onSave={this.onChangeEditor('observations')}\r\n            onClose={() => this.setState({ isEditorOpen: false })}\r\n            onUpload={this.onUpload}\r\n            onClickPreview={this.onClickAttachmentCell}\r\n            footer={attachmentsList}\r\n          />\r\n        </Table.Cell>\r\n        <Table.Cell className='attachments'>\r\n          <div>\r\n            <a href='#' className='btn-attach' onClick={this.onClickAttachmentCell}>\r\n              <Label circular floating color='green' size='mini'>\r\n                {_.size(instruccion.Attachments)}\r\n              </Label>\r\n              <Icon name='copy outline' className='attachments-icon' />\r\n            </a>\r\n          </div>\r\n        </Table.Cell>\r\n        <Table.Cell textAlign='right' collapsing className='computer'>\r\n          {this.props.isEditable &&\r\n          user_has_role_permission('instruccion_delete') && (\r\n            <Dropdown\r\n              className='action'\r\n              inline\r\n              direction='left'\r\n              icon={false}\r\n              trigger={<Icon name='ellipsis vertical' color='grey' />}\r\n            >\r\n              <Dropdown.Menu>\r\n                <Dropdown.Item icon='trash alternate outline' content='Eliminar instrucción' onClick={this.onRemove} />\r\n              </Dropdown.Menu>\r\n            </Dropdown>\r\n          )}\r\n        </Table.Cell>\r\n      </Table.Row>\r\n    )\r\n  }\r\n}\r\n","import { render } from 'react-dom'\r\nimport App from './App'\r\nimport AppPeriodo from './AppPeriodo'\r\n\r\ndeclare var app: any\r\n\r\naccounting.settings.number.precision = 0\r\naccounting.settings.number.thousand = '.'\r\naccounting.settings.number.decimal = ','\r\n\r\nif (app.vars.hoja_trabajo.paso.tipo == 'PERIODO') {\r\n  render(<AppPeriodo hoja_trabajo={app.vars.hoja_trabajo} />, document.getElementById('root'))\r\n} else {\r\n  render(<App hoja_trabajo={app.vars.hoja_trabajo} />, document.getElementById('root'))\r\n}\r\n","import { PureComponent, SyntheticEvent, Fragment } from 'react'\r\nimport Modal from 'semantic-ui-react/dist/commonjs/modules/Modal/Modal'\r\nimport { MenuElementListPanel, MenuElementListActions } from './menuitem'\r\nimport { AjusteModal } from './ajuste_modal'\r\nimport { AuthorIconLogDefaultWrapper } from '../../global/AuthorIconLog'\r\nimport { StatusDivBlock } from '../../global/StatusButtonAction'\r\nimport Popup from 'semantic-ui-react/dist/commonjs/modules/Popup/Popup'\r\nimport { truncateText } from '../utils_truncate'\r\nimport cx from 'classnames'\r\n\r\nexport class AjusteList extends PureComponent<DefaultMenuItemListProps<ProyectoAjusteGroup>> {\r\n  render() {\r\n    if (this.props.items === null) {\r\n      return (\r\n        <div style={{ height: 300, position: 'relative' }}>\r\n          <div className='ui active inverted text loader elastic olive'>Cargando Listado de Ajustes</div>\r\n        </div>\r\n      )\r\n    } else if (_.size(this.props.items) == 0) {\r\n      return <div className='empty nocontent'>0 Ajustes</div>\r\n    } else {\r\n      const { items } = this.props\r\n      return (\r\n        <MenuElementListPanel className='ajustes-list'>\r\n          {_.map(items, (item: ProyectoAjusteGroup) => {\r\n            return (\r\n              <div key={item.idx} className='listitem ajuste-listitem'>\r\n                <AjusteListItem\r\n                  item={item}\r\n                  isEditable={this.props.isEditable}\r\n                  onSave={this.props.onSaveItem}\r\n                  onClickDelete={this.props.onClickDeleteItem}\r\n                />\r\n              </div>\r\n            )\r\n          })}\r\n        </MenuElementListPanel>\r\n      )\r\n    }\r\n  }\r\n}\r\n\r\ntype AjusteListItemProps = {\r\n  item: ProyectoAjusteGroup\r\n  onSave: (item: ProyectoAjusteGroup, changes: any, blockingText?: string) => void\r\n  onClickDelete: (item: ProyectoAjusteGroup) => void\r\n  isEditable: boolean\r\n}\r\n\r\nclass AjusteListItem extends PureComponent<AjusteListItemProps, { isModalEdit: boolean }> {\r\n  state = {\r\n    isModalEdit: false\r\n  }\r\n\r\n  onClickDelete = (ev: SyntheticEvent) => {\r\n    ev.preventDefault()\r\n    this.props.onClickDelete(this.props.item)\r\n  }\r\n\r\n  onClickEdit = (ev: SyntheticEvent) => {\r\n    ev.preventDefault()\r\n    this.setState({ isModalEdit: true })\r\n  }\r\n\r\n  onCloseEdit = () => {\r\n    this.setState({ isModalEdit: false })\r\n  }\r\n\r\n  onSave = (item: ProyectoAjusteGroup, changes: any, blockingText?: string) => {\r\n    this.props.onSave(item, changes, blockingText)\r\n  }\r\n  render() {\r\n    const { item } = this.props\r\n    return (\r\n      <div>\r\n        {this.props.isEditable && (\r\n          <MenuElementListActions\r\n            actions={{\r\n              edit: { label: 'Editar', callback: this.onClickEdit, permission: 'ajustes_edit' },\r\n              delete: { label: 'Eliminar', callback: this.onClickDelete, permission: 'ajustes_delete' }\r\n            }}\r\n          />\r\n        )}\r\n        <div onClick={this.onClickEdit}>\r\n          <div className='row r1'>\r\n            <div className='pull-left r1_1'>\r\n              <span className='title-h1'> Ajuste #{item.idx}</span>\r\n              <AuthorIconLogDefaultWrapper model={item} size='small' />\r\n              <div className='r1_2'>\r\n                <strong>Ajuste Registrado: </strong>{' '}\r\n                <span className={cx({ red: '' + item.aplicado != '1' })}>\r\n                  {'' + item.aplicado == '1' ? 'Sí' : 'No'}\r\n                </span>\r\n              </div>\r\n            </div>\r\n            <StatusDivBlock\r\n              wrapperClassName='pull-right text-mini'\r\n              status={item.status || 'EN PROCESO'}\r\n              className='mini'\r\n              hideLabel\r\n            />\r\n          </div>\r\n          <table className='ui compact very basic celled striped small table table-ajustes'>\r\n            <thead>\r\n              <tr>\r\n                <th>Cuenta</th>\r\n                <th>Debe</th>\r\n                <th>Haber</th>\r\n              </tr>\r\n            </thead>\r\n            <tbody>\r\n              {_.map(item.items, (subitem) => {\r\n                return (\r\n                  <Fragment key={subitem.id}>\r\n                    {!isEmpty(subitem.debe) && (\r\n                      <tr>\r\n                        <td>\r\n                          <Popup\r\n                            trigger={<span>{subitem.cuenta}</span>}\r\n                            content={subitem.nombre_cuenta}\r\n                            header={subitem.cuenta}\r\n                            size='mini'\r\n                          />\r\n                        </td>\r\n                        <td className='right aligned'>{accounting.formatNumber(subitem.debe)}</td>\r\n                        <td>&nbsp;</td>\r\n                      </tr>\r\n                    )}\r\n                    {!isEmpty(subitem.haber) && (\r\n                      <tr>\r\n                        <td>\r\n                          <Popup\r\n                            trigger={<span>{subitem.cuenta}</span>}\r\n                            content={subitem.nombre_cuenta}\r\n                            header={subitem.cuenta}\r\n                            size='mini'\r\n                          />\r\n                        </td>\r\n                        <td>&nbsp;</td>\r\n                        <td className='right aligned'>{accounting.formatNumber(subitem.haber)}</td>\r\n                      </tr>\r\n                    )}\r\n                  </Fragment>\r\n                )\r\n              })}\r\n            </tbody>\r\n          </table>\r\n          {item.descripcion && (\r\n            <div className='item-description'>\r\n              <div className='editor-preview' dangerouslySetInnerHTML={{ __html: truncateText(item.descripcion) }} />\r\n            </div>\r\n          )}\r\n        </div>\r\n\r\n        <div className='actions-wrapper'>\r\n          <div className='actions'>\r\n            <div className='group-actions right-actions'>\r\n              {user_has_role_permission('ajustes_edit') && (\r\n                <button\r\n                  className='ui button icon primary mini compact'\r\n                  onClick={() => this.onSave(item, { status: 'COMPLETADO' }, 'Marcando como COMPLETADO')}\r\n                >\r\n                  <i className='icon check' /> Completar\r\n                </button>\r\n              )}\r\n\r\n              {user_has_role_permission('ajustes_revisado') && (\r\n                <Popup\r\n                  disabled={item.fecha_completado != null}\r\n                  className='disable-text'\r\n                  on='hover'\r\n                  basic\r\n                  content='Debe estar primero en estado COMPLETADO, para poder marcarla como REVISADA.'\r\n                  trigger={\r\n                    <div className='button-wrapper'>\r\n                      <button\r\n                        className='ui button mini compact olive'\r\n                        disabled={item.fecha_completado == null}\r\n                        onClick={() =>\r\n                          item.fecha_completado == null\r\n                            ? void 0\r\n                            : this.onSave(item, { status: 'REVISADO' }, 'Marcando como REVISADO')}\r\n                      >\r\n                        <i className='icon check fitted' />\r\n                        <i className='icon check' /> Revisado\r\n                      </button>\r\n                    </div>\r\n                  }\r\n                />\r\n              )}\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        {this.state.isModalEdit && (\r\n          <AjusteModalEdit\r\n            item={item}\r\n            onSave={this.onSave}\r\n            onClickDelete={this.onClickDelete}\r\n            onClose={this.onCloseEdit}\r\n            isEditable={this.props.isEditable}\r\n          />\r\n        )}\r\n      </div>\r\n    )\r\n  }\r\n}\r\n\r\ntype AjusteModalEditProps = {\r\n  item: ProyectoAjusteGroup\r\n  onSave: (item: ProyectoAjusteGroup, data: ProyectoAjusteGroup, blockingText?: string) => void\r\n  onClickDelete: (ev: SyntheticEvent) => void\r\n  onClose: () => void\r\n  isEditable: boolean\r\n}\r\n\r\nclass AjusteModalEdit extends PureComponent<AjusteModalEditProps> {\r\n  onSave = (data: any, blockingText?: string) => {\r\n    this.props.onSave(this.props.item, data, blockingText)\r\n  }\r\n\r\n  render() {\r\n    return (\r\n      <Modal\r\n        open\r\n        dimmer='inverted'\r\n        className='modal-ab modal-sidebarmenuitem'\r\n        size='large'\r\n        closeIcon\r\n        onClose={this.props.onClose}\r\n        closeOnEscape={false}\r\n        closeOnDimmerClick={false}\r\n      >\r\n        <Modal.Header>Editar Ajuste</Modal.Header>\r\n\r\n        <AjusteModal\r\n          moduleParams={{ id_visita: this.props.item.id_visita, model: 'ajuste' }}\r\n          item={this.props.item}\r\n          isEditable={this.props.isEditable}\r\n          onSave={this.onSave}\r\n          onClickDelete={this.props.onClickDelete}\r\n        />\r\n      </Modal>\r\n    )\r\n  }\r\n}\r\n\r\nconst isEmpty = (value: any) => {\r\n  if (_.isNumber(value)) {\r\n    return false\r\n  }\r\n\r\n  return _.size(value) == 0\r\n}\r\n","import { PureComponent, Fragment, SyntheticEvent } from 'react'\r\nimport { MenuItemNewHeader } from './menuitem__new'\r\nimport EditorPreview from '../../global/EditorPreview'\r\nimport InputAutoNumeric from '../../global/InputAutoNumeric'\r\nimport MenuItemAjusteContext from './menuitem_ajuste_context'\r\nimport Autocomplete from 'react-autocomplete'\r\nimport { getNombreCuenta } from '../utils_ajuste'\r\nimport Popup from 'semantic-ui-react/dist/commonjs/modules/Popup'\r\nimport { StatusButtonGroupActions } from '../../global/StatusButtonAction'\r\nimport cx from 'classnames'\r\nimport { GenericTooltip } from '../../global/Tooltip'\r\n\r\ndeclare var app: any\r\n\r\ntype AjusteModalProps = {\r\n  moduleParams: any\r\n  item: ProyectoAjusteGroup\r\n  isEditable: boolean\r\n  onSave: (changes: any, blockingText?: string) => void\r\n  onClickDelete?: (ev: SyntheticEvent) => void\r\n}\r\n\r\ntype AjusteModalState = {\r\n  descripcion: string\r\n  items: ProyectoAjuste[]\r\n  status: ProyectoModuleStatusEnum\r\n  aplicado: number\r\n}\r\n\r\nexport class AjusteModal extends PureComponent<AjusteModalProps, AjusteModalState> {\r\n  constructor(props: AjusteModalProps) {\r\n    super(props)\r\n\r\n    this.state = {\r\n      descripcion: props.item.descripcion,\r\n      items: props.item.items || [],\r\n      status: props.item.status,\r\n      aplicado: props.item.aplicado\r\n    }\r\n  }\r\n\r\n  isNewItem() {\r\n    return !this.props.item.idx\r\n  }\r\n\r\n  esPlanillaDescuadrada() {\r\n    const { items } = this.state\r\n\r\n    if (!items) {\r\n      return false\r\n    }\r\n\r\n    const totalD = _.reduce(items, (acc, curr) => num(curr.debe) + acc, 0)\r\n    const totalH = _.reduce(items, (acc, curr) => num(curr.haber) + acc, 0)\r\n\r\n    return totalD != totalH\r\n  }\r\n\r\n  validateItems() {\r\n    return (\r\n      _.size(this.state.items) > 0 &&\r\n      !_.any(this.state.items, (item) => {\r\n        return item['cuenta'] == '' || item['nombre_cuenta'] == '' || (!item['debe'] && !item['haber'])\r\n      })\r\n    )\r\n  }\r\n\r\n  onChangeAplicado = (ev: SyntheticEvent) => {\r\n    this.setState({ aplicado: (ev.target as any).value })\r\n    if (!this.isNewItem()) {\r\n      this.props.onSave({ aplicado: (ev.target as any).value })\r\n    }\r\n  }\r\n\r\n  onChangeDescripcion = (ckeditor: CKEDITOR.editor) => {\r\n    this.setState({ descripcion: ckeditor.getData() })\r\n    if (!this.isNewItem()) {\r\n      this.props.onSave({ descripcion: ckeditor.getData() })\r\n    }\r\n  }\r\n\r\n  onAddItem = () => {\r\n    this.setState((prevState) => {\r\n      const items = [ ...prevState.items, createAjusteEmpty() ]\r\n\r\n      return { items }\r\n    })\r\n  }\r\n\r\n  onDeleteItem = (item: ProyectoAjuste, itemIndex: number) => {\r\n    this.setState(\r\n      (prevState) => {\r\n        const items = _.reject(prevState.items, (_item, k: number) => k == itemIndex)\r\n\r\n        return { items }\r\n      },\r\n      () => {\r\n        if (!this.isNewItem()) {\r\n          this.props.onSave({ items: this.state.items })\r\n        }\r\n      }\r\n    )\r\n  }\r\n\r\n  onUpdateItem = (item: ProyectoAjuste, itemIndex: number, notify: boolean = true) => {\r\n    this.setState(\r\n      (prevState) => {\r\n        let items\r\n        if (typeof prevState.items[itemIndex] === 'undefined') {\r\n          items = [ ...prevState.items ]\r\n          items.push(item)\r\n        } else {\r\n          items = _.map(prevState.items, (_item, k) => {\r\n            if (k == itemIndex) {\r\n              return Object.assign({}, _item, item)\r\n            } else {\r\n              return _item\r\n            }\r\n          })\r\n        }\r\n\r\n        return { items }\r\n      },\r\n      () => {\r\n        if (notify && !this.isNewItem()) {\r\n          const blockingText = _.any(this.state.items, (_item) => !_item.id) ? 'Guardando cambios' : null\r\n          this.props.onSave({ items: this.state.items }, blockingText)\r\n        }\r\n      }\r\n    )\r\n  }\r\n\r\n  _onCreate(changes: any, blockingText?: string) {\r\n    if (!this.validateItems()) {\r\n      bootbox.alert('Ingrese el codigo de la cuenta y valor del ajuste para cada una de las filas del ajuste contable.')\r\n      return\r\n    }\r\n    this.props.onSave(Object.assign({}, this.state, changes), blockingText)\r\n  }\r\n\r\n  onCreate = () => {\r\n    this._onCreate({ status: 'EN PROCESO' }, 'Creando Ajuste')\r\n  }\r\n\r\n  onCreateAndCompletado = () => {\r\n    this._onCreate({ status: 'COMPLETADO' }, 'Creando Ajuste')\r\n  }\r\n\r\n  onCompletado = () => {\r\n    this.props.onSave({ status: 'COMPLETADO' }, 'Marcando como COMPLETADO')\r\n  }\r\n\r\n  onRevisado = () => {\r\n    this.props.onSave({ status: 'REVISADO' }, 'Marcando como REVISASO')\r\n  }\r\n\r\n  renderItemHeader() {\r\n    const item = Object.assign(\r\n      { label: this.props.item.idx ? `Ajuste #${this.props.item.idx}` : 'Ajuste Nuevo' },\r\n      this.props.item\r\n    )\r\n\r\n    return <MenuItemNewHeader item={item} />\r\n  }\r\n\r\n  renderRows() {\r\n    let items = this.state.items\r\n\r\n    return (\r\n      <Fragment>\r\n        <MenuItemAjusteContext.Consumer>\r\n          {(cuentas) =>\r\n            _.map(items, (row, k) => {\r\n              return (\r\n                <AjusteTableRow\r\n                  item={row}\r\n                  key={k}\r\n                  itemIndex={k}\r\n                  cuentas={cuentas}\r\n                  isEditable={this.props.isEditable}\r\n                  canRemove={_.size(items) > 1}\r\n                  onUpdate={this.onUpdateItem}\r\n                  onClickDelete={this.onDeleteItem}\r\n                />\r\n              )\r\n            })}\r\n        </MenuItemAjusteContext.Consumer>\r\n      </Fragment>\r\n    )\r\n  }\r\n\r\n  renderActions() {\r\n    const { item } = this.props\r\n\r\n    const esPlanillaDescuadrada = this.esPlanillaDescuadrada()\r\n\r\n    let revisadoDisableText = null\r\n    if (esPlanillaDescuadrada) {\r\n      revisadoDisableText =\r\n        'No es posible guardar los cambios realizados en este ajuste mientras la planilla esté descuadrada.'\r\n    } else if (!item.fecha_completado) {\r\n      revisadoDisableText = 'Debe estar primero en estado COMPLETADO, para poder marcarse como REVISADO.'\r\n    }\r\n\r\n    const rightActions = !this.isNewItem() && (\r\n      <button className='ui button compact negative left floated' onClick={this.props.onClickDelete}>\r\n        <i className='icon trash' /> Eliminar\r\n      </button>\r\n    )\r\n\r\n    return this.isNewItem() ? (\r\n      <div className='actions ab-status-actions'>\r\n        <Popup\r\n          content='No es posible guardar este ajuste mientras la planilla esté descuadrada.'\r\n          disabled={!esPlanillaDescuadrada}\r\n          className='disable-text'\r\n          trigger={\r\n            <div className='button-wrapper'>\r\n              <button className='ui button compact green' onClick={this.onCreate} disabled={esPlanillaDescuadrada}>\r\n                Crear\r\n              </button>\r\n            </div>\r\n          }\r\n        />\r\n\r\n        <Popup\r\n          content='No es posible guardar este ajuste mientras la planilla esté descuadrada.'\r\n          disabled={!esPlanillaDescuadrada}\r\n          className='disable-text'\r\n          trigger={\r\n            <div className='button-wrapper'>\r\n              <button\r\n                className='ui button compact green'\r\n                onClick={this.onCreateAndCompletado}\r\n                disabled={esPlanillaDescuadrada}\r\n              >\r\n                Crear y Completar\r\n              </button>\r\n            </div>\r\n          }\r\n        />\r\n      </div>\r\n    ) : (\r\n      <Fragment>\r\n        {rightActions}\r\n        <StatusButtonGroupActions\r\n          completado={{\r\n            permission: 'hallazgo_completado',\r\n            onClick: this.onCompletado,\r\n            disableText: esPlanillaDescuadrada\r\n              ? 'No es posible guardar los cambios realizados en este ajuste mientras la planilla esté descuadrada.'\r\n              : null\r\n          }}\r\n          revisado={{\r\n            permission: 'hallazgo_revisado',\r\n            onClick: this.onRevisado,\r\n            record: item,\r\n            disableText: revisadoDisableText\r\n          }}\r\n        />\r\n      </Fragment>\r\n    )\r\n  }\r\n\r\n  render() {\r\n    return (\r\n      <Fragment>\r\n        <div className='content'>\r\n          {this.renderItemHeader()}\r\n          <table className='ui table compact'>\r\n            <thead>\r\n              <tr>\r\n                <th>Código de la Cuenta</th>\r\n                <th>Nombre de la Cuenta</th>\r\n                <th>Debe</th>\r\n                <th>Haber</th>\r\n                <th />\r\n              </tr>\r\n            </thead>\r\n            <tbody>\r\n              {this.renderRows()}\r\n              {this.props.isEditable && (\r\n                <tr>\r\n                  <td colSpan={5}>\r\n                    <button type='button' className='ui button olive fluid icon' onClick={this.onAddItem}>\r\n                      Añadir Fila <i className='icon plus' />\r\n                    </button>\r\n                  </td>\r\n                </tr>\r\n              )}\r\n            </tbody>\r\n          </table>\r\n          {this.esPlanillaDescuadrada() && (\r\n            <div className='ui red tiny message _a-center m1 '>\r\n              <i className='icon exclamation triangle yellow' /> Alerta: Planilla descuadrada\r\n            </div>\r\n          )}\r\n          <div className='ui segment'>\r\n            <EditorPreview\r\n              prefixPreview='Descripción del Ajuste'\r\n              labelTitle='Descripción del Ajuste'\r\n              ckeditorOptions='basic'\r\n              editable={this.props.isEditable}\r\n              data={this.state.descripcion}\r\n              onSave={this.onChangeDescripcion}\r\n            />\r\n          </div>\r\n\r\n          <div className='ui segment basic nopad pull-left' style={{ marginTop: 5 }}>\r\n            <label style={{ marginRight: 10, display: 'inline-block', fontWeight: 600 }}>Error Tolerable:</label>\r\n            {accounting.formatNumber(app.vars.error_tolerable[this.props.moduleParams.id_visita])}\r\n          </div>\r\n\r\n          <div className='ui right aligned segment basic nopad'>\r\n            <label style={{ marginRight: 10, display: 'inline-block', fontWeight: 600 }}>\r\n              ¿Ajuste Registrado? <GenericTooltip text='@tooltip.ajustes.aplicado' /> :\r\n            </label>\r\n            <select\r\n              className='raw-select'\r\n              value={'' + this.state.aplicado == '1' ? '1' : '0'}\r\n              onChange={this.onChangeAplicado}\r\n            >\r\n              <option value='1'>Sí</option>\r\n              <option value='0'>No</option>\r\n            </select>\r\n          </div>\r\n        </div>\r\n        <div className='actions'>\r\n          {this.renderActions()}\r\n          <div className='clearfix' />\r\n        </div>\r\n      </Fragment>\r\n    )\r\n  }\r\n}\r\n\r\ntype AjusteTableRowProps = {\r\n  item: ProyectoAjuste\r\n  itemIndex: number\r\n  cuentas: ProyectoAjusteCuenta[]\r\n  isEditable: boolean\r\n  canRemove: boolean\r\n  onUpdate: (item: ProyectoAjuste, itemIndex: number, notify: boolean) => void\r\n  onClickDelete: (item: ProyectoAjuste, itemIndex: number) => void\r\n}\r\n\r\ntype AjusteTableRowState = {\r\n  cuenta: string\r\n  nombre_cuenta: string\r\n  debe: number\r\n  haber: number\r\n}\r\n\r\nclass AjusteTableRow extends PureComponent<AjusteTableRowProps, AjusteTableRowState> {\r\n  constructor(props: AjusteTableRowProps) {\r\n    super(props)\r\n\r\n    this.state = {\r\n      cuenta: props.item.cuenta,\r\n      nombre_cuenta: props.item.nombre_cuenta,\r\n      debe: props.item.debe,\r\n      haber: props.item.haber\r\n    }\r\n  }\r\n\r\n  notifyUpdate(notify: boolean = true) {\r\n    const changes = Object.assign({}, this.props.item, this.state)\r\n    if (changes['cuenta'] == '' || changes['nombre_cuenta'] == '' || (!changes['debe'] && !changes['haber'])) {\r\n      return\r\n    }\r\n\r\n    this.props.onUpdate(changes, this.props.itemIndex, notify)\r\n  }\r\n\r\n  onClickDelete = (ev: SyntheticEvent) => {\r\n    ev.preventDefault()\r\n    if (!this.props.canRemove) {\r\n      return\r\n    }\r\n\r\n    bootbox.confirm(\r\n      '¿Desea eliminar esta fila de su ajuste contable?',\r\n      'Cancelar',\r\n      'Sí, eliminar fila',\r\n      (r: boolean) => {\r\n        if (!r) {\r\n          return\r\n        }\r\n\r\n        this.props.onClickDelete(this.props.item, this.props.itemIndex)\r\n      }\r\n    )\r\n  }\r\n\r\n  onSelectCuenta = (value: string, item: ProyectoAjuste) => {\r\n    this.setState({ cuenta: item.cuenta, nombre_cuenta: item.nombre_cuenta }, () => {\r\n      this.notifyUpdate()\r\n    })\r\n  }\r\n\r\n  onChangeCuenta = (ev: SyntheticEvent, value: string) => {\r\n    this.setState({ cuenta: value, nombre_cuenta: '' })\r\n  }\r\n\r\n  onChangeNombreCuenta = (ev: SyntheticEvent, value: string) => {\r\n    this.setState({ nombre_cuenta: value, cuenta: '' })\r\n  }\r\n\r\n  onBlurCuenta = () => {\r\n    const { cuentas } = this.props\r\n\r\n    this.setState(\r\n      (prevState) => {\r\n        if (prevState.cuenta == '' && prevState.nombre_cuenta == '') {\r\n          return null\r\n        }\r\n\r\n        if (prevState.cuenta != '' && prevState.nombre_cuenta != '') {\r\n          return null\r\n        }\r\n\r\n        if (prevState.cuenta != '') {\r\n          const nombre_cuenta: string = getNombreCuenta(cuentas, prevState.cuenta)\r\n\r\n          return { cuenta: prevState.cuenta, nombre_cuenta }\r\n        }\r\n\r\n        if (prevState.nombre_cuenta != '') {\r\n          const cuenta = _.find(\r\n            cuentas,\r\n            (item) => item.nombre_cuenta.toUpperCase() == prevState.nombre_cuenta.toUpperCase()\r\n          )\r\n\r\n          return { cuenta: cuenta ? cuenta.cuenta : '', nombre_cuenta: prevState.nombre_cuenta }\r\n        }\r\n      },\r\n      () => this.notifyUpdate()\r\n    )\r\n  }\r\n\r\n  onChangeInput = (field: 'debe' | 'haber', value: number, persist: boolean) => {\r\n    if (field == 'debe') {\r\n      this.setState({ debe: value }, () => this.notifyUpdate(persist))\r\n    } else {\r\n      this.setState({ haber: value }, () => this.notifyUpdate(persist))\r\n    }\r\n  }\r\n\r\n  render() {\r\n    return (\r\n      <tr>\r\n        <td>\r\n          <Autocomplete\r\n            items={this.props.cuentas}\r\n            getItemValue={(item) => item.cuenta}\r\n            renderItem={(item, isHighlighted) => {\r\n              return (\r\n                <div key={item.id} className={'item ' + (isHighlighted ? 'item-highlighted' : '')}>\r\n                  <div>{item.cuenta}</div>\r\n                  <div className='description'>{item.nombre_cuenta}</div>\r\n                </div>\r\n              )\r\n            }}\r\n            value={this.state.cuenta}\r\n            onChange={this.onChangeCuenta}\r\n            onSelect={this.onSelectCuenta}\r\n            inputProps={{ type: 'text', spellCheck: false, required: true, onBlur: this.onBlurCuenta }}\r\n            shouldItemRender={(item, value) => {\r\n              return item.cuenta.replace(/\\D/g, '').startsWith(value.replace(/\\D/g, ''))\r\n            }}\r\n            renderMenu={(items) => {\r\n              return (\r\n                <div className='autocomplete-menu' style={{ position: 'absolute', zIndex: 1002 }} children={items} />\r\n              )\r\n            }}\r\n            wrapperProps={{ className: cx({ error: !this.state.cuenta }) }}\r\n            wrapperStyle={{ display: 'inline-block', position: 'relative' }}\r\n          />\r\n          {!this.state.cuenta && <div className='ui pointing above prompt mini label'>Requerido</div>}\r\n        </td>\r\n        <td>\r\n          <Autocomplete\r\n            items={this.props.cuentas}\r\n            getItemValue={(item) => item.nombre_cuenta}\r\n            renderItem={(item, isHighlighted) => {\r\n              return (\r\n                <div key={item.id} className={'item ' + (isHighlighted ? 'item-highlighted' : '')}>\r\n                  <div>{item.nombre_cuenta}</div>\r\n                  <div className='description'>{item.cuenta}</div>\r\n                </div>\r\n              )\r\n            }}\r\n            value={this.state.nombre_cuenta}\r\n            onChange={this.onChangeNombreCuenta}\r\n            onSelect={this.onSelectCuenta}\r\n            inputProps={{ type: 'text', spellCheck: false, required: true }}\r\n            shouldItemRender={(item, value) => {\r\n              const text = item.nombre_cuenta.normalize('NFD').replace(/[\\u0300-\\u036f]/g, '').toUpperCase()\r\n              return _.str.contains(text, value.normalize('NFD').replace(/[\\u0300-\\u036f]/g, '').toUpperCase())\r\n            }}\r\n            renderMenu={(items) => {\r\n              return (\r\n                <div className='autocomplete-menu' style={{ position: 'absolute', zIndex: 1002 }} children={items} />\r\n              )\r\n            }}\r\n            wrapperProps={{ className: cx({ error: !this.state.nombre_cuenta }) }}\r\n            wrapperStyle={{ display: 'inline-block', position: 'relative' }}\r\n          />\r\n          {!this.state.nombre_cuenta && <div className='ui pointing above prompt mini label'>Requerido</div>}\r\n        </td>\r\n        <td>\r\n          <div className={cx({ error: !this.state.debe && !this.state.haber })}>\r\n            <InputAutoNumeric\r\n              isEditable={this.props.isEditable}\r\n              value={this.state.debe}\r\n              disabled={!!this.state.haber}\r\n              onChange={(ev: SyntheticEvent, value: number) => this.onChangeInput('debe', value, false)}\r\n              onBlur={(ev: SyntheticEvent, value: number) => this.onChangeInput('debe', value, true)}\r\n            />\r\n          </div>\r\n          {!this.state.debe &&\r\n          !this.state.haber && <div className='ui pointing above prompt mini label'>Requerido</div>}\r\n        </td>\r\n        <td>\r\n          <div className={cx({ error: !this.state.haber && !this.state.debe })}>\r\n            <InputAutoNumeric\r\n              isEditable={this.props.isEditable}\r\n              value={this.state.haber}\r\n              disabled={!!this.state.debe}\r\n              onChange={(ev: SyntheticEvent, value: number) => this.onChangeInput('haber', value, false)}\r\n              onBlur={(ev: SyntheticEvent, value: number) => this.onChangeInput('haber', value, true)}\r\n            />\r\n          </div>\r\n          {!this.state.haber &&\r\n          !this.state.debe && <div className='ui pointing above prompt mini label'>Requerido</div>}\r\n        </td>\r\n        <td>\r\n          {this.props.isEditable && (\r\n            <Popup\r\n              disabled={this.props.canRemove}\r\n              content='Todo ajuste contable debe tener un mínimo de 1 cuenta (fila).'\r\n              trigger={\r\n                <a href='#' onClick={this.onClickDelete} title='Eliminar Fila'>\r\n                  <i className='icon cancel red' />\r\n                </a>\r\n              }\r\n              header='Eliminar fila | Opción deshabilitada'\r\n              className='disable-text'\r\n            />\r\n          )}\r\n        </td>\r\n      </tr>\r\n    )\r\n  }\r\n}\r\n\r\nconst num = (input: any) => {\r\n  const v = parseFloat(input)\r\n  return isNaN(v) ? 0 : v\r\n}\r\n\r\nconst createAjusteEmpty = (): ProyectoAjuste => {\r\n  return {\r\n    cuenta: '',\r\n    debe: null,\r\n    haber: null,\r\n    nombre_cuenta: ''\r\n  }\r\n}\r\n","import { SyntheticEvent, PureComponent } from 'react'\r\nimport Modal from 'semantic-ui-react/dist/commonjs/modules/Modal/Modal'\r\nimport { HallazgoModal } from './hallazgo_modal'\r\n\r\ntype HallazgoModalEditProps = {\r\n  moduleParams: any\r\n  item: ProyectoHallazgo\r\n  onSave: (item: ProyectoHallazgo, data: ProyectoHallazgo) => void\r\n  onClickDelete: (ev: SyntheticEvent) => void\r\n  onClose: () => void\r\n}\r\nexport class HallazgoModalEdit extends PureComponent<HallazgoModalEditProps> {\r\n  onSave = (data: ProyectoHallazgo) => {\r\n    this.props.onSave(this.props.item, data)\r\n  }\r\n\r\n  render() {\r\n    return (\r\n      <Modal\r\n        open\r\n        dimmer='inverted'\r\n        className='modal-ab modal-sidebarmenuitem'\r\n        size='large'\r\n        closeIcon\r\n        onClose={this.props.onClose}\r\n      >\r\n        <Modal.Header>Editar Hallazgo</Modal.Header>\r\n\r\n        <HallazgoModal\r\n          moduleParams={this.props.moduleParams}\r\n          item={this.props.item}\r\n          isEditable={user_has_role_permission('hallazgo_edit')}\r\n          onSave={this.onSave}\r\n          onClickDelete={this.props.onClickDelete}\r\n        />\r\n      </Modal>\r\n    )\r\n  }\r\n}\r\n","import { PureComponent, SyntheticEvent } from 'react'\r\nimport { HallazgoUtils } from '../utils_hallazgo'\r\nimport { AuthorIconLogDefaultWrapper } from '../../global/AuthorIconLog'\r\nimport { HallazgoModalEdit } from './hallazgo_edit'\r\nimport { MenuElementListPanel, MenuElementListActions } from './menuitem'\r\nimport { StatusDivBlock } from '../../global/StatusButtonAction'\r\nimport { truncateText } from '../utils_truncate'\r\nimport Popup from 'semantic-ui-react/dist/commonjs/modules/Popup/Popup'\r\n\r\nexport class HallazgoList extends PureComponent<DefaultMenuItemListProps<ProyectoHallazgo>> {\r\n  render() {\r\n    if (this.props.items === null) {\r\n      return (\r\n        <div style={{ height: 300, position: 'relative' }}>\r\n          <div className='ui active inverted text loader elastic olive'>Cargando Listado de Hallazgos</div>\r\n        </div>\r\n      )\r\n    } else if (_.size(this.props.items) == 0) {\r\n      return <div className='empty nocontent'>0 Hallazgos</div>\r\n    } else {\r\n      const { items } = this.props\r\n      return (\r\n        <MenuElementListPanel>\r\n          {_.map(items, (item) => {\r\n            return (\r\n              <div key={item.id} className='listitem hallazgo-listitem'>\r\n                <HallazgoListItem\r\n                  item={item}\r\n                  moduleParams={this.props.moduleParams}\r\n                  onSave={this.props.onSaveItem}\r\n                  onClickDelete={this.props.onClickDeleteItem}\r\n                />\r\n              </div>\r\n            )\r\n          })}\r\n        </MenuElementListPanel>\r\n      )\r\n    }\r\n  }\r\n}\r\n\r\ntype HallazgoListItemProps = {\r\n  moduleParams: any\r\n  item: ProyectoHallazgo\r\n  onSave: (item: ProyectoHallazgo, changes: any, blockingText?: string) => void\r\n  onClickDelete: (item: ProyectoHallazgo) => void\r\n}\r\n\r\nexport class HallazgoListItem extends PureComponent<HallazgoListItemProps, { isModalEdit: boolean }> {\r\n  state = {\r\n    isModalEdit: false\r\n  }\r\n\r\n  renderDescripcion() {\r\n    const { item } = this.props\r\n    let html = truncateText(item.hallazgo)\r\n\r\n    return <div dangerouslySetInnerHTML={{ __html: html }} />\r\n  }\r\n\r\n  renderEstadoImplementacion() {\r\n    const { item } = this.props\r\n\r\n    if (item.implementado == null || '' + item.implementado == '') {\r\n      return 'Pendiente'\r\n    } else if (item.implementado == '0') {\r\n      return 'En Proceso'\r\n    } else {\r\n      return 'Hecho'\r\n    }\r\n  }\r\n\r\n  onClickEdit = (ev: SyntheticEvent) => {\r\n    ev.preventDefault()\r\n    this.setState({ isModalEdit: true })\r\n  }\r\n\r\n  onCloseEdit = () => {\r\n    this.setState({ isModalEdit: false })\r\n  }\r\n\r\n  onClickDelete = (ev: SyntheticEvent) => {\r\n    ev.preventDefault()\r\n    this.props.onClickDelete(this.props.item)\r\n  }\r\n\r\n  onSave = (item: ProyectoHallazgo, changes: any) => {\r\n    let blockingText = null\r\n    if (_.isEqual(changes, { status: 'COMPLETADO' })) {\r\n      blockingText = 'Marcando como COMPLETADO'\r\n    } else if (_.isEqual(changes, { status: 'REVISADO' })) {\r\n      blockingText = 'Marcando como REVISADO'\r\n    }\r\n\r\n    this.props.onSave(item, changes, blockingText)\r\n  }\r\n\r\n  render() {\r\n    const { item } = this.props\r\n\r\n    return (\r\n      <div>\r\n        <MenuElementListActions\r\n          actions={{\r\n            edit: { label: 'Editar', callback: this.onClickEdit, permission: 'hallazgo_edit' },\r\n            delete: { label: 'Eliminar', callback: this.onClickDelete, permission: 'hallazgo_delete' }\r\n          }}\r\n        />\r\n        <div onClick={() => this.setState({ isModalEdit: true })}>\r\n          <div className='row r1'>\r\n            <div className='pull-left r1_1'>\r\n              <span className='title-h1'>{HallazgoUtils.formatName(item.name)}</span>\r\n              <AuthorIconLogDefaultWrapper model={item} size='small' />\r\n              <div className='r1_2'>\r\n                <strong>Implementación: </strong> {this.renderEstadoImplementacion()}\r\n              </div>\r\n            </div>\r\n            <StatusDivBlock wrapperClassName='pull-right text-mini' status={item.status} className='mini' hideLabel />\r\n          </div>\r\n          <div className='row'>\r\n            <div className='editor-preview'>{this.renderDescripcion()}</div>\r\n          </div>\r\n          <div className='row' />\r\n        </div>\r\n        <div className='actions-wrapper'>\r\n          <div className='actions'>\r\n            <div className='group-actions right-actions'>\r\n              {user_has_role_permission('hallazgo_completado') && (\r\n                <button\r\n                  className='ui button icon primary mini compact'\r\n                  onClick={() => this.onSave(item, { status: 'COMPLETADO' })}\r\n                >\r\n                  <i className='icon check' /> Completar\r\n                </button>\r\n              )}\r\n\r\n              {user_has_role_permission('hallazgo_revisado') && (\r\n                <Popup\r\n                  disabled={item.fecha_completado != null}\r\n                  className='disable-text'\r\n                  on='hover'\r\n                  basic\r\n                  content='Debe estar primero en estado COMPLETADO, para poder marcarlo como REVISADO.'\r\n                  trigger={\r\n                    <div className='button-wrapper'>\r\n                      <button\r\n                        className='ui button mini compact olive'\r\n                        disabled={item.fecha_completado == null}\r\n                        onClick={() =>\r\n                          item.fecha_completado == null ? void 0 : this.onSave(item, { status: 'REVISADO' })}\r\n                      >\r\n                        <i className='icon check fitted' />\r\n                        <i className='icon check' /> Revisado\r\n                      </button>\r\n                    </div>\r\n                  }\r\n                />\r\n              )}\r\n            </div>\r\n          </div>\r\n        </div>\r\n        {this.state.isModalEdit && (\r\n          <HallazgoModalEdit\r\n            item={item}\r\n            moduleParams={this.props.moduleParams}\r\n            onSave={this.onSave}\r\n            onClickDelete={this.onClickDelete}\r\n            onClose={this.onCloseEdit}\r\n          />\r\n        )}\r\n      </div>\r\n    )\r\n  }\r\n}\r\n","import React, { PureComponent, Fragment, SyntheticEvent } from 'react'\r\n\r\nimport EditorPreview from '../../global/EditorPreview'\r\nimport { StatusButtonGroupActions } from '../../global/StatusButtonAction'\r\nimport DatePicker, { registerLocale } from 'react-datepicker'\r\nimport datepickerEs from 'date-fns/locale/es'\r\nimport { format as formatDate, parseISO as parseDate, isValid as isValidDate } from 'date-fns'\r\nimport { MentionsInput, Mention } from 'react-mentions'\r\nimport { HallazgoUtils } from '../utils_hallazgo'\r\nimport cx from 'classnames'\r\nimport { MenuItemNewHeader } from './menuitem__new'\r\n\r\ndeclare var app: any\r\n\r\nregisterLocale('es', datepickerEs)\r\n\r\ntype HallazgoModalProps = {\r\n  moduleParams: any\r\n  item: ProyectoHallazgo\r\n  isEditable: boolean\r\n  onSave: (item: Partial<ProyectoHallazgo>) => void\r\n  onClickDelete?: (ev: SyntheticEvent) => void\r\n}\r\n\r\ntype HallazgoModalState = {\r\n  value: Partial<ProyectoHallazgo>\r\n}\r\n\r\nexport class HallazgoModal extends PureComponent<HallazgoModalProps, HallazgoModalState> {\r\n  constructor(props: HallazgoModalProps) {\r\n    super(props)\r\n\r\n    this.state = {\r\n      value: props.item\r\n    }\r\n  }\r\n\r\n  private handlers: { [s: string]: any } = {}\r\n\r\n  attachHandler(field: string, handler: any) {\r\n    if (!this.handlers[field]) {\r\n      this.handlers[field] = handler\r\n    }\r\n\r\n    return this.handlers[field]\r\n  }\r\n\r\n  isNewItem() {\r\n    return this.props.item.id == null\r\n  }\r\n\r\n  updateModel(changes: any) {\r\n    this.setState((prevState) => {\r\n      return { value: Object.assign({}, prevState.value, changes) }\r\n    })\r\n\r\n    if (!this.isNewItem()) {\r\n      this.props.onSave(changes)\r\n    }\r\n  }\r\n\r\n  getDate(date: string): Date {\r\n    if (!date) {\r\n      return null\r\n    }\r\n\r\n    const d = parseDate(date)\r\n\r\n    return isValidDate(d) ? d : null\r\n  }\r\n\r\n  formatImplementadoChoice(implementado: string | boolean) {\r\n    if (implementado === null || implementado === '') {\r\n      return ''\r\n    }\r\n\r\n    return implementado === true || implementado === '1' ? '1' : '0'\r\n  }\r\n\r\n  _onCreate(changes: any) {\r\n    if (_.isEmpty(this.state.value.hallazgo)) {\r\n      bootbox.alert('La descripción del hallazgo NO puede ser un campo vacío.')\r\n      return\r\n    }\r\n\r\n    this.props.onSave(Object.assign({}, this.state.value, changes))\r\n  }\r\n\r\n  onCreate = () => {\r\n    this._onCreate({ status: 'EN PROCESO' })\r\n  }\r\n\r\n  onCreateAndCompletado = () => {\r\n    this._onCreate({ status: 'COMPLETADO' })\r\n  }\r\n\r\n  onCompletado = () => {\r\n    this.props.onSave({ status: 'COMPLETADO' })\r\n  }\r\n\r\n  onRevisado = () => {\r\n    this.props.onSave({ status: 'REVISADO' })\r\n  }\r\n\r\n  onEditorChange = (field: keyof ProyectoHallazgo) => {\r\n    const handler = (editor: CKEDITOR.editor, closeModal: boolean, autosave: boolean, cb: () => void) => {\r\n      const value = editor.getData()\r\n      if (field == 'hallazgo' && !this.isNewItem() && _.size(_.str.trim(value)) == 0) {\r\n        bootbox.alert('La descripción del hallazgo NO puede ser un campo vacío.')\r\n        return\r\n      }\r\n\r\n      this.updateModel({ [field]: value })\r\n      if ($.isFunction(cb)) {\r\n        cb()\r\n      }\r\n    }\r\n\r\n    return this.attachHandler(field, handler)\r\n  }\r\n\r\n  onInputChange = (field: keyof ProyectoHallazgo) => {\r\n    return this.attachHandler(field, (ev: SyntheticEvent) => {\r\n      this.updateModel({ [field]: (ev.target as any).value })\r\n    })\r\n  }\r\n\r\n  onDateChange = (field: keyof ProyectoHallazgo) => {\r\n    return this.attachHandler(field, (value: Date) => {\r\n      this.updateModel({ [field]: formatDate(value, 'yyyy-MM-dd') })\r\n    })\r\n  }\r\n  onValueChange = (field: keyof ProyectoHallazgo) => {\r\n    return this.attachHandler(field, (value: string) => {\r\n      this.updateModel({ [field]: value })\r\n    })\r\n  }\r\n\r\n  onClickDelete = (ev: SyntheticEvent) => {\r\n    if ($.isFunction(this.props.onClickDelete)) {\r\n      this.props.onClickDelete(ev)\r\n    }\r\n  }\r\n\r\n  renderActions() {\r\n    const { item } = this.props\r\n\r\n    const rightActions = item.id !== null && (\r\n      <button className='ui button compact negative left floated' onClick={this.onClickDelete}>\r\n        <i className='icon trash' /> Eliminar\r\n      </button>\r\n    )\r\n\r\n    return item.id === null ? (\r\n      <div className='actions ab-status-actions'>\r\n        <button className='ui button compact green' onClick={this.onCreate}>\r\n          Crear\r\n        </button>\r\n\r\n        <button className='ui button compact green' onClick={this.onCreateAndCompletado}>\r\n          Crear y Completar\r\n        </button>\r\n      </div>\r\n    ) : (\r\n      <Fragment>\r\n        {rightActions}\r\n        <StatusButtonGroupActions\r\n          completado={{ permission: 'hallazgo_completado', onClick: this.onCompletado }}\r\n          revisado={{ permission: 'hallazgo_revisado', onClick: this.onRevisado, record: item }}\r\n        />\r\n      </Fragment>\r\n    )\r\n  }\r\n\r\n  renderItemHeader() {\r\n    const item = Object.assign(\r\n      { label: this.props.item.id ? HallazgoUtils.formatName(this.props.item.name) : 'Hallazgo Nuevo' },\r\n      this.props.item\r\n    )\r\n\r\n    return <MenuItemNewHeader item={item} />\r\n  }\r\n\r\n  render() {\r\n    const { item } = this.props\r\n    const { value } = this.state\r\n\r\n    return (\r\n      <Fragment>\r\n        <div className='content'>\r\n          {this.renderItemHeader()}\r\n\r\n          {item.id && (\r\n            <div className='description-text'>\r\n              <strong>NOTA:</strong> El hallazgo debe describir la situación actual, causa, impacto y recomendación.\r\n            </div>\r\n          )}\r\n          <EditorPreview\r\n            className={'editor-preview-hallazgo'}\r\n            wrapperClassName={cx(!item.id || 'ui segment')}\r\n            data={value.hallazgo}\r\n            inline={item.id == null}\r\n            ckeditorOptions={{\r\n              attach_disableText:\r\n                'Esta opción (adjuntar archivos) sólo estará disponible una vez haya guardado este hallazgo.',\r\n              height: item.id ? 300 : 150\r\n            }}\r\n            ckeditorUploadOptions={{ model: `${this.props.moduleParams.model}__hallazgo`, modelId: item.id }}\r\n            footer='AttachmentList'\r\n            onSave={this.onEditorChange('hallazgo')}\r\n            previewStyle={{ overflowY: 'auto', maxHeight: 200, width: '100%' }}\r\n            label='<div class=\"description-text\"><strong>NOTA:</strong> El hallazgo debe describir la situación actual, causa, impacto y recomendación</div>'\r\n          />\r\n\r\n          <hr />\r\n\r\n          <div className='ui segment'>\r\n            <EditorPreview\r\n              data={value.plan_accion}\r\n              prefixPreview='Descripción Plan de Acción: '\r\n              labelTitle='Descripción Plan de Acción:'\r\n              ckeditorOptions={{\r\n                attach_disableText:\r\n                  'Esta opción (adjuntar archivos) sólo estará disponible una vez haya guardado este hallazgo.'\r\n              }}\r\n              ckeditorUploadOptions={{ model: `${this.props.moduleParams.model}__plan_accion`, modelId: item.id }}\r\n              footer='AttachmentList'\r\n              onSave={this.onEditorChange('plan_accion')}\r\n            />\r\n          </div>\r\n\r\n          <div className='ui three column grid'>\r\n            <div className='column'>\r\n              <label htmlFor='hallazgo_modal__responsable'>Responsable del Plan Acción: </label>\r\n              <HallazgoResponsableInput\r\n                value={value.responsable}\r\n                onChange={this.onValueChange('responsable')}\r\n                attrs={{ placeholder: 'Escriba el Nombre', style: { display: 'inline-block' } }}\r\n              />\r\n            </div>\r\n\r\n            <div className='column'>\r\n              <label htmlFor='hallazgo_modal__fecha_implementado'>Fecha Implementación: </label>\r\n              <DatePicker\r\n                id='hallazgo_modal__fecha_implementado'\r\n                dateFormat='yyyy-MM-dd'\r\n                locale='es'\r\n                fixedHeight\r\n                placeholderText='AAAA-mm-dd'\r\n                className='react-datepicker--input'\r\n                selected={this.getDate(value.fecha_implementado)}\r\n                onChange={this.onDateChange('fecha_implementado')}\r\n              />\r\n            </div>\r\n\r\n            <div className='column right aligned'>\r\n              <label htmlFor='hallazgo_modal__implementado'>Estado Implementación: </label>\r\n              <select\r\n                id='hallazgo_modal__implementado'\r\n                value={this.formatImplementadoChoice(value.implementado)}\r\n                onChange={this.onInputChange('implementado')}\r\n              >\r\n                <option value=''>Pendiente</option>\r\n                <option value='0'>En Proceso</option>\r\n                <option value='1'>Hecho</option>\r\n              </select>\r\n            </div>\r\n          </div>\r\n        </div>\r\n        <div className='actions'>\r\n          {this.renderActions()}\r\n          <div className='clearfix' />\r\n        </div>\r\n      </Fragment>\r\n    )\r\n  }\r\n}\r\n\r\ntype HallazgoResponsableInputProps = {\r\n  value: string\r\n  onChange: (newValue: string) => void\r\n  attrs?: any\r\n}\r\n\r\nclass HallazgoResponsableInput extends PureComponent<HallazgoResponsableInputProps, { value: string }> {\r\n  users: { id: string; display: string }[]\r\n\r\n  mentionStyle = {\r\n    display: 'inline-block',\r\n    minWidth: '200px',\r\n    suggestions: {\r\n      list: {\r\n        backgroundColor: 'white',\r\n        border: '1px solid rgba(0,0,0,0.15)',\r\n        fontSize: 14\r\n      },\r\n      item: {\r\n        padding: '5px 15px',\r\n        borderBottom: '1px solid rgba(0,0,0,0.15)',\r\n        '&focused': {\r\n          backgroundColor: '#cee4e5'\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  constructor(props: HallazgoResponsableInputProps) {\r\n    super(props)\r\n\r\n    this.state = {\r\n      value: props.value\r\n    }\r\n\r\n    this.users = _.map(app.vars.proyecto_equipo, (user: any) => {\r\n      return {\r\n        id: user.user_id,\r\n        display: user.name\r\n      }\r\n    })\r\n  }\r\n\r\n  onChange = (event: SyntheticEvent, newValue: string, newPlainTextValue: string, mentions: any) => {\r\n    this.setState({ value: newValue })\r\n    this.props.onChange(newValue)\r\n  }\r\n\r\n  render() {\r\n    return (\r\n      <MentionsInput\r\n        singleLine\r\n        type='text'\r\n        value={this.state.value == null ? '' : this.state.value}\r\n        onChange={this.onChange}\r\n        allowSpaceInQuery\r\n        {...this.props.attrs}\r\n        className='mentions-input'\r\n        style={this.mentionStyle}\r\n      >\r\n        <Mention trigger='@' data={this.users} appendSpaceOnAdd />\r\n      </MentionsInput>\r\n    )\r\n  }\r\n}\r\n","import { PureComponent, Fragment, SyntheticEvent, createRef } from 'react'\r\n\r\nimport Transition from 'semantic-ui-react/dist/commonjs/modules/Transition/Transition'\r\nimport cx from 'classnames'\r\nimport { SidebarPanelHeader } from './panel_header'\r\nimport { DefaultErrorHandler } from '../../global/ErrorHandler'\r\n\r\ntype BaseMenuItemProps = {\r\n  open: boolean\r\n  image: string\r\n  counter: number\r\n  onClick: () => void\r\n  title: string\r\n}\r\n\r\nexport class BaseMenuItem extends PureComponent<BaseMenuItemProps> {\r\n  render() {\r\n    const image_path = public_path('images/sidebar_right/')\r\n\r\n    return (\r\n      <a\r\n        className={cx('item badged', !this.props.open || 'active')}\r\n        title={this.props.title}\r\n        onClick={this.props.onClick}\r\n      >\r\n        <img src={`${image_path}${this.props.image}.svg`} className='ui large image' /> {' '}\r\n        <div className={cx('ui mini circular floating label right', this.props.counter == 0 ? 'green' : 'red')}>\r\n          {this.props.counter}\r\n        </div>\r\n      </a>\r\n    )\r\n  }\r\n}\r\n\r\ntype BaseMenuElementProps = {\r\n  name: string\r\n  counter: number\r\n  title: string\r\n  icon: string\r\n  open: boolean\r\n  onToggle: (item: string) => void\r\n  onMountPanel?: () => void\r\n}\r\n\r\nexport class BaseMenuElement extends PureComponent<BaseMenuElementProps> {\r\n  onToggle = () => {\r\n    this.props.onToggle(this.props.open ? null : this.props.name)\r\n  }\r\n\r\n  onClose = (ev: SyntheticEvent) => {\r\n    ev.preventDefault()\r\n    this.props.onToggle(null)\r\n  }\r\n\r\n  render() {\r\n    return (\r\n      <Fragment>\r\n        <DefaultErrorHandler>\r\n          <BaseMenuItem\r\n            counter={this.props.counter}\r\n            open={this.props.open}\r\n            title={this.props.title}\r\n            image={this.props.icon}\r\n            onClick={this.onToggle}\r\n          />\r\n          {this.props.open && (\r\n            <Transition.Group animation='slide right' duration={1500}>\r\n              <div\r\n                className={`sidebar-fixed-content ui vertical right fixed menu menu-${this.props.name}`}\r\n                style={{ right: 45 }}\r\n              >\r\n                <SidebarPanelHeader title={this.props.title} onClose={this.onClose} onMount={this.props.onMountPanel} />\r\n                {this.props.children}\r\n              </div>\r\n            </Transition.Group>\r\n          )}\r\n        </DefaultErrorHandler>\r\n      </Fragment>\r\n    )\r\n  }\r\n}\r\n\r\nexport class MenuElementListPanel extends PureComponent<{ className?: string }> {\r\n  listRef = createRef<HTMLDivElement>()\r\n  listHeight: number = null\r\n\r\n  componentDidMount() {\r\n    if (this.listRef.current) {\r\n      this.calculateHeight()\r\n    }\r\n  }\r\n\r\n  componentDidUpdate() {\r\n    if (this.listRef.current && !this.listHeight) {\r\n      this.calculateHeight()\r\n    }\r\n  }\r\n\r\n  calculateHeight() {\r\n    const $list = $(this.listRef.current)\r\n    this.listHeight = window.innerHeight - $list.position().top - 30\r\n    $list.height(this.listHeight)\r\n  }\r\n\r\n  render() {\r\n    return (\r\n      <div className={`main-list ${this.props.className}`} ref={this.listRef}>\r\n        {this.props.children}\r\n      </div>\r\n    )\r\n  }\r\n}\r\n\r\ntype MenuElementListActionOptionsBase = {\r\n  label: string\r\n  permission?: string\r\n}\r\n\r\ntype MenuElementListActionOptionsCallback = MenuElementListActionOptionsBase & {\r\n  callback: (ev: SyntheticEvent) => void\r\n  url?: never\r\n}\r\ntype MenuElementListActionOptionsUrl = MenuElementListActionOptionsBase & { url: string; callback?: never }\r\n\r\ntype MenuElementListActionOptions = MenuElementListActionOptionsCallback | MenuElementListActionOptionsUrl\r\n\r\ntype MenuElementListActionsProps = {\r\n  actions: {\r\n    [s: string]: MenuElementListActionOptions\r\n  }\r\n}\r\nexport const MenuElementListActions = (props: MenuElementListActionsProps) => {\r\n  return (\r\n    <div className='pull-right sf_admin_td_actions'>\r\n      <div className='btn-group dropdown-modern'>\r\n        <a className='btn btn-mini dropdown-toggle' data-toggle='dropdown' href='#'>\r\n          <span className='icon-tc-ellipsis-v' />\r\n        </a>\r\n\r\n        <ul className='dropdown-menu pull-right'>\r\n          {_.map(props.actions, (action: MenuElementListActionOptions, key) => {\r\n            return (\r\n              user_has_role_permission(action.permission) && (\r\n                <li key={key}>\r\n                  {typeof action.url !== 'undefined' ? (\r\n                    <a href={url_for2(action.url)} target='_blank'>\r\n                      {action.label}\r\n                    </a>\r\n                  ) : (\r\n                    <a href='#' onClick={action.callback}>\r\n                      {action.label}\r\n                    </a>\r\n                  )}\r\n                </li>\r\n              )\r\n            )\r\n          })}\r\n        </ul>\r\n      </div>\r\n    </div>\r\n  )\r\n}\r\n","export class HallazgoHojaTrabajoModelManager implements MenuElementModelManager<ProyectoHallazgo> {\r\n  private static instance: HallazgoHojaTrabajoModelManager\r\n\r\n  static getInstance(): HallazgoHojaTrabajoModelManager {\r\n    if (!HallazgoHojaTrabajoModelManager.instance) {\r\n      HallazgoHojaTrabajoModelManager.instance = new this()\r\n    }\r\n\r\n    return HallazgoHojaTrabajoModelManager.instance\r\n  }\r\n\r\n  /**\r\n   * Descarga el listado de los hallazgos.\r\n   *\r\n   * @param props\r\n   */\r\n  getJson(props: DefaultMenuElementProps<ProyectoHallazgo>): Promise<ProyectoHallazgo[]> {\r\n    const { id_paso, id_visita } = props.moduleParams\r\n\r\n    return new Promise((resolve) => {\r\n      $.getJSON(url_for2(`proyecto/:id_proyecto/paso/${id_paso}/visita/${id_visita}/hallazgo/json`)).done((res) => {\r\n        resolve(_.isEmpty(res.response) ? [] : res.response)\r\n      })\r\n    })\r\n  }\r\n\r\n  createItem(props: DefaultMenuElementProps<ProyectoHallazgo>, data: any): Promise<ProyectoHallazgo> {\r\n    const { id_paso, id_visita } = props.moduleParams\r\n    const url = url_for2(`proyecto/:id_proyecto/paso/${id_paso}/visita/${id_visita}/hallazgo`)\r\n\r\n    return new Promise<ProyectoHallazgo>((resolve) => {\r\n      $.post(url, { data }).done((res) => {\r\n        resolve(res.response.record)\r\n      })\r\n    })\r\n  }\r\n\r\n  saveItem(props: DefaultMenuElementProps<ProyectoHallazgo>, item: any, data: any): Promise<ProyectoHallazgo> {\r\n    let url: string\r\n    if (_.isEqual(data, { status: 'COMPLETADO' })) {\r\n      url = `proyecto/:id_proyecto/paso/:id_paso/visita/:id_visita/hallazgo/:id/c`\r\n    } else if (_.isEqual(data, { status: 'REVISADO' })) {\r\n      url = `proyecto/:id_proyecto/paso/:id_paso/visita/:id_visita/hallazgo/:id/r`\r\n    } else {\r\n      url = `proyecto/:id_proyecto/paso/:id_paso/visita/:id_visita/hallazgo/:id`\r\n    }\r\n\r\n    const { id_paso, id_visita } = props.moduleParams\r\n\r\n    return new Promise<ProyectoHallazgo>((resolve) => {\r\n      $.post(url_for2(url, { id_paso, id_visita, id: item.id }), { data }).done((res) => {\r\n        resolve(res.response.record)\r\n      })\r\n    })\r\n  }\r\n\r\n  deleteItem(props: DefaultMenuElementProps<ProyectoHallazgo>, item: any): Promise<null> {\r\n    const { id_paso, id_visita } = props.moduleParams\r\n    const url = `proyecto/:id_proyecto/paso/:id_paso/visita/:id_visita/hallazgo/:id`\r\n\r\n    return new Promise<null>((resolve) => {\r\n      $.ajax({ url: url_for2(url, { id_paso, id_visita, id: item.id }), type: 'DELETE' }).done((res) => {\r\n        if (res.status == 1) {\r\n          resolve()\r\n        }\r\n      })\r\n    })\r\n  }\r\n\r\n  parseItems(items: any): any {\r\n    return items\r\n  }\r\n}\r\n\r\nexport class RevisionHojaTrabajoModelManager implements MenuElementModelManager<ProyectoRevisionTree> {\r\n  private static instance: RevisionHojaTrabajoModelManager\r\n\r\n  private hojaTrabajoContext: HojaTrabajoContextType\r\n\r\n  static getInstance(hojaTrabajoContext: HojaTrabajoContextType): RevisionHojaTrabajoModelManager {\r\n    if (!RevisionHojaTrabajoModelManager.instance) {\r\n      RevisionHojaTrabajoModelManager.instance = new this()\r\n      RevisionHojaTrabajoModelManager.instance.hojaTrabajoContext = hojaTrabajoContext\r\n    }\r\n\r\n    return RevisionHojaTrabajoModelManager.instance\r\n  }\r\n\r\n  /**\r\n   * Descarga el listado de los notas de revision.\r\n   *\r\n   * @param props\r\n   */\r\n  getJson(props: DefaultMenuElementProps<ProyectoRevisionTree>): Promise<ProyectoRevisionTree[]> {\r\n    const { id_paso, id_visita } = props.moduleParams\r\n\r\n    return new Promise((resolve) => {\r\n      $.getJSON(url_for2(`proyecto/:id_proyecto/paso/${id_paso}/visita/${id_visita}/revision`)).done((res) => {\r\n        resolve(_.isEmpty(res.response.revisiones) ? [] : this.parseItems(res.response.revisiones))\r\n      })\r\n    })\r\n  }\r\n\r\n  createItem(props: DefaultMenuElementProps<ProyectoRevisionTree>, data: any): Promise<ProyectoRevisionTree> {\r\n    const { id_paso, id_visita } = props.moduleParams\r\n    const url = url_for2(`proyecto/:id_proyecto/paso/${id_paso}/visita/${id_visita}/revision`)\r\n\r\n    return new Promise<ProyectoRevisionTree>((resolve) => {\r\n      $.post(url, data).done((res) => {\r\n        resolve(res.response.revision)\r\n\r\n        this.updateVisita(id_visita, res.response.paso_visita)\r\n      })\r\n    })\r\n  }\r\n\r\n  saveItem(props: DefaultMenuElementProps<ProyectoRevisionTree>, item: any, data: any): Promise<ProyectoRevisionTree> {\r\n    const { id_visita, id_paso } = props.moduleParams\r\n    const url = url_for2(`proyecto/:id_proyecto/paso/${id_paso}/visita/${id_visita}/revision/${item.id}`)\r\n\r\n    return new Promise<ProyectoRevisionTree>((resolve) => {\r\n      $.post(url, data).done((res) => {\r\n        resolve(res.response.revision)\r\n\r\n        this.updateVisita(id_visita, res.response.paso_visita)\r\n      })\r\n    })\r\n  }\r\n\r\n  deleteItem(props: DefaultMenuElementProps<ProyectoRevisionTree>, item: any): Promise<null> {\r\n    const { id_paso, id_visita } = props.moduleParams\r\n    const url = `proyecto/:id_proyecto/paso/:id_paso/visita/:id_visita/revision/:item_id`\r\n\r\n    return new Promise<null>((resolve) => {\r\n      $.ajax({ url: url_for2(url, { id_paso, id_visita, item_id: item.id }), type: 'DELETE' }).done((res) => {\r\n        resolve()\r\n\r\n        this.updateVisita(id_visita, res.response.paso_visita)\r\n      })\r\n    })\r\n  }\r\n\r\n  parseItems(items: any): any {\r\n    return items\r\n  }\r\n\r\n  updateVisita(id_visita: Readonly<string>, changes: any) {\r\n    const { hoja_trabajo, update } = this.hojaTrabajoContext\r\n\r\n    let hoja_trabajo_copy = Object.assign({}, hoja_trabajo)\r\n\r\n    hoja_trabajo_copy.visitas = _.mapValues(hoja_trabajo_copy.visitas, (item: ProyectoPasoVisita) => {\r\n      if (item.id_visita == id_visita) {\r\n        item = Object.assign({}, item, changes)\r\n      }\r\n      return item\r\n    })\r\n\r\n    update(hoja_trabajo_copy)\r\n  }\r\n}\r\n","import { PureComponent } from 'react'\r\n\r\nimport Modal from 'semantic-ui-react/dist/commonjs/modules/Modal/Modal'\r\nimport { AuthorIconLogDefaultWrapper } from '../../global/AuthorIconLog'\r\n\r\ntype MenuItemNewProps = {\r\n  isEditable: boolean\r\n  headerText: string\r\n  buttonText: string\r\n  onSave: (data: any) => Promise<null>\r\n  moduleParams: any\r\n  item: any\r\n  contentAs: React.ComponentType<MenuItemModalType>\r\n}\r\n\r\ntype MenuItemModalType = {\r\n  item: any\r\n  isEditable: boolean\r\n  moduleParams: any\r\n  onSave: (item: any) => void\r\n}\r\n\r\nexport class MenuItemNew extends PureComponent<MenuItemNewProps, { modalOpen: boolean }> {\r\n  state = {\r\n    modalOpen: false\r\n  }\r\n\r\n  onClick = () => {\r\n    this.setState({ modalOpen: true })\r\n  }\r\n\r\n  onCloseModal = () => {\r\n    this.setState({ modalOpen: false })\r\n  }\r\n\r\n  onSave = (data: ProyectoHallazgo) => {\r\n    this.props.onSave(data).then(() => {\r\n      this.onCloseModal()\r\n    })\r\n  }\r\n\r\n  render() {\r\n    if (!this.props.isEditable) {\r\n      return null\r\n    }\r\n\r\n    const MenuItemModal = this.props.contentAs\r\n\r\n    return (\r\n      <div className='_a-center'>\r\n        <button className='button ui right tiny compact plain green rounded' onClick={this.onClick}>\r\n          {this.props.buttonText} <i className='icon plus' />\r\n        </button>\r\n        {this.state.modalOpen && (\r\n          <Modal\r\n            open\r\n            dimmer='inverted'\r\n            className='modal-ab modal-sidebarmenuitem'\r\n            size='large'\r\n            closeIcon\r\n            closeOnDimmerClick={false}\r\n            closeOnEscape={false}\r\n            onClose={this.onCloseModal}\r\n          >\r\n            <Modal.Header>{this.props.headerText}</Modal.Header>\r\n            <MenuItemModal\r\n              onSave={this.onSave}\r\n              moduleParams={this.props.moduleParams}\r\n              isEditable={this.props.isEditable}\r\n              item={this.props.item}\r\n            />\r\n          </Modal>\r\n        )}\r\n      </div>\r\n    )\r\n  }\r\n}\r\n\r\ntype MenuItemNewHeaderProps = {\r\n  item: {\r\n    label: string\r\n    status: ProyectoModuleStatusEnum\r\n  } & IAuthorLog\r\n}\r\n\r\nexport const MenuItemNewHeader = (props: MenuItemNewHeaderProps) => {\r\n  const status = props.item.status || 'EN PROCESO'\r\n  return (\r\n    <div className='ui grid padded' style={{ marginBottom: 0 }}>\r\n      <div className='row' style={{ paddingTop: 0 }}>\r\n        <div className='column four wide'>\r\n          <strong style={{ fontWeight: 600 }}>{props.item.label}</strong>\r\n        </div>\r\n        <div className='column four wide'>\r\n          <span>Estado: </span>\r\n          <div className='lb-status-wrapper'>\r\n            <div className={`lb-status lb-status-${_.str.dasherize(status.toLowerCase())}`}>{status}</div>\r\n          </div>\r\n        </div>\r\n\r\n        <div className='column four wide'>\r\n          <AuthorIconLogDefaultWrapper model={props.item} />\r\n        </div>\r\n      </div>\r\n    </div>\r\n  )\r\n}\r\n","import { PureComponent } from 'react'\r\n\r\nimport { BaseMenuElement } from './menuitem'\r\nimport { MenuItemNew } from './menuitem__new'\r\nimport { AjusteModal } from './ajuste_modal'\r\nimport { AjusteList } from './ajuste_list'\r\nimport MenuItemAjusteContext from './menuitem_ajuste_context'\r\nimport { getNombreCuenta } from '../utils_ajuste'\r\n\r\ntype MenuItemAjusteState = {\r\n  items: ProyectoAjusteGroup[]\r\n}\r\n\r\ndeclare var app: any\r\n\r\nexport class MenuItemAjuste extends PureComponent<DefaultMenuElementProps<ProyectoAjusteGroup>, MenuItemAjusteState> {\r\n  cuentas: ProyectoAjusteCuenta[] = null\r\n\r\n  state: MenuItemAjusteState = {\r\n    items: null\r\n  }\r\n\r\n  parseAjustes = (input: any[]): ProyectoAjusteGroup[] => {\r\n    const self = this\r\n    let ajustes = _.groupBy(input, 'idx')\r\n\r\n    return _.map(ajustes, function(_row, idx) {\r\n      const row = _.map(_row, function(item) {\r\n        return {\r\n          id: item.id,\r\n          cuenta: item.cuenta,\r\n          debe: item.col == 'DEBE' ? item.valor : '',\r\n          haber: item.col == 'HABER' ? item.valor : '',\r\n          nombre_cuenta: self.getNombreCuenta(item.cuenta)\r\n        }\r\n      })\r\n\r\n      return Object.assign(\r\n        {},\r\n        {\r\n          idx,\r\n          items: row,\r\n          status: _row[0].status,\r\n          descripcion: _row[0].description,\r\n          id_visita: _row[0].id_proyecto_visita\r\n        },\r\n        _.pick(_row[0], [ 'fecha_completado', 'aplicado', 'fecha_revision', 'UpdateLog', 'RevisionLog' ])\r\n      )\r\n    })\r\n  }\r\n\r\n  getNombreCuenta(cuenta: string) {\r\n    return getNombreCuenta(this.cuentas, cuenta)\r\n  }\r\n\r\n  onCreateItem = (data: any) => {\r\n    return new Promise<null>((resolve) => {\r\n      $.blockUI(create_blockUI_loading_message('Creando ajuste'))\r\n      const { id_visita, id_paso } = this.props.moduleParams\r\n      $.post(url_for(`proyecto/${app.vars.idproyecto}/visita/${id_visita}/cifra-ajuste`), {\r\n        changes: data,\r\n        id_paso,\r\n        v: 2\r\n      }).done((res) => {\r\n        this.setState((prevState) => {\r\n          const items = [ ...prevState.items ]\r\n          items.push(this.parseAjustes(res.response.ajustes)[0])\r\n\r\n          return { items }\r\n        })\r\n\r\n        $.unblockUI()\r\n        resolve()\r\n      })\r\n    })\r\n  }\r\n\r\n  onMountPanel = () => {\r\n    if (this.state.items === null) {\r\n      const { id_visita } = this.props.moduleParams\r\n      $.getJSON(url_for(`proyecto/${app.vars.idproyecto}/visita/${id_visita}/cifra-ajuste`)).done((res) => {\r\n        this.cuentas = _.isEmpty(res.response.cuentas) ? [] : res.response.cuentas\r\n        app.vars.error_tolerable[id_visita] = res.response.error_tolerable\r\n\r\n        this.setState({\r\n          items: _.isEmpty(res.response.ajustes) ? [] : this.parseAjustes(res.response.ajustes)\r\n        })\r\n      })\r\n    }\r\n  }\r\n\r\n  onSaveItem = (item: ProyectoAjusteGroup, changes: any, blockingText?: string) => {\r\n    return new Promise<ProyectoAjusteGroup>((resolve) => {\r\n      const { id_visita, id_paso } = this.props.moduleParams\r\n      if (blockingText) {\r\n        setTimeout(() => $.blockUI(create_blockUI_loading_message(blockingText)), 1000 * 0.1)\r\n      }\r\n\r\n      $.post(url_for(`proyecto/${app.vars.idproyecto}/visita/${id_visita}/cifra-ajuste`), {\r\n        idx: item.idx,\r\n        changes,\r\n        id_paso,\r\n        v: 2\r\n      }).done((res) => {\r\n        const ajustes = this.parseAjustes(res.response.ajustes)\r\n        this.setState((prevState) => {\r\n          const items = _.map(prevState.items, (item) => {\r\n            if (item.idx == ajustes[0].idx) {\r\n              return ajustes[0]\r\n            } else {\r\n              return item\r\n            }\r\n          })\r\n          return { items }\r\n        })\r\n\r\n        if (blockingText) {\r\n          $.unblockUI()\r\n        }\r\n\r\n        resolve(ajustes[0])\r\n      })\r\n    })\r\n  }\r\n\r\n  onClickDeleteItem = (item: ProyectoAjusteGroup) => {\r\n    bootbox.warningConfirm(\r\n      `¿Desea eliminar el <strong>Ajuste #${item.idx}</strong>,\r\n      el cual contiene un total de ${_.size(item.items)} registros contables?`,\r\n      'No',\r\n      'Sí, Eliminar',\r\n      (r) => {\r\n        if (!r) {\r\n          return\r\n        }\r\n\r\n        const { id_visita } = this.props.moduleParams\r\n\r\n        $.blockUI(create_blockUI_loading_message('Eliminando ajustes'))\r\n        $.ajax(url_for(`proyecto/${app.vars.idproyecto}/visita/${id_visita}/cifra-ajuste/${item.idx}`), {\r\n          type: 'delete'\r\n        }).done((res) => {\r\n          this.setState((prevState) => {\r\n            const items = _.reject(prevState.items, { idx: item.idx })\r\n\r\n            return { items }\r\n          })\r\n\r\n          $.unblockUI()\r\n        })\r\n      }\r\n    )\r\n  }\r\n\r\n  renderContent() {\r\n    const itemNew: ProyectoAjusteGroup = {\r\n      idx: null,\r\n      status: 'NUEVO',\r\n      descripcion: '',\r\n      id_visita: this.props.moduleParams.id_visita,\r\n      items: _.fill(new Array(2), { cuenta: '', debe: null, haber: null, nombre_cuenta: '' }, 0, 2)\r\n    }\r\n\r\n    return (\r\n      <div className='content'>\r\n        {_.size(this.cuentas) > 0 && (\r\n          <MenuItemNew\r\n            moduleParams={this.props.moduleParams}\r\n            buttonText='Crear Ajuste'\r\n            headerText='Nuevo Ajuste'\r\n            isEditable={user_has_role_permission('ajustes_edit')}\r\n            onSave={this.onCreateItem}\r\n            item={itemNew}\r\n            contentAs={AjusteModal}\r\n          />\r\n        )}\r\n        {_.isArray(this.cuentas) && _.size(this.cuentas) == 0 ? (\r\n          <div className='ui message error' style={{ marginTop: 40 }}>\r\n            <i className='icon warning sign' />\r\n            <strong>Advertencia: </strong> Al parecer aún no se han cargado sumarias a esta visita.\r\n          </div>\r\n        ) : (\r\n          <AjusteList\r\n            items={this.state.items}\r\n            moduleParams={this.props.moduleParams}\r\n            isEditable={es_proyecto_editable() && user_has_role_permission('ajustes_edit')}\r\n            onSaveItem={this.onSaveItem}\r\n            onClickDeleteItem={this.onClickDeleteItem}\r\n          />\r\n        )}\r\n      </div>\r\n    )\r\n  }\r\n\r\n  render() {\r\n    return (\r\n      <BaseMenuElement\r\n        name='ajuste'\r\n        counter={this.state.items === null ? this.props.counter : _.size(this.state.items)}\r\n        icon='ajustes'\r\n        title='Ajustes'\r\n        open={this.props.open}\r\n        onToggle={this.props.onOpen}\r\n        onMountPanel={this.onMountPanel}\r\n      >\r\n        <MenuItemAjusteContext.Provider value={this.cuentas}>{this.renderContent()}</MenuItemAjusteContext.Provider>\r\n      </BaseMenuElement>\r\n    )\r\n  }\r\n}\r\n","import { createContext } from 'react'\r\n\r\nexport default createContext([])\r\n","import React, { PureComponent } from 'react'\r\n\r\nimport { BaseMenuElement } from './menuitem'\r\nimport { MenuItemNew } from './menuitem__new'\r\nimport { HallazgoList } from './hallazgo_list'\r\nimport { HallazgoUtils } from '../utils_hallazgo'\r\nimport { HallazgoModal } from './hallazgo_modal'\r\n\r\ntype MenuItemHallazgoState = {\r\n  items: ProyectoHallazgo[]\r\n}\r\n\r\nexport class MenuItemHallazgo extends PureComponent<DefaultMenuElementProps<ProyectoHallazgo>, MenuItemHallazgoState> {\r\n  state: MenuItemHallazgoState = {\r\n    items: null\r\n  }\r\n\r\n  addItem(data: any) {\r\n    this.setState((prevState) => {\r\n      const copy = [ ...prevState.items, data ]\r\n\r\n      return { items: copy }\r\n    })\r\n  }\r\n\r\n  updateItem(item: ProyectoHallazgo, data: any) {\r\n    this.setState((prevState) => {\r\n      const copy = _.map(prevState.items, (_item) => {\r\n        if (_item.id == item.id) {\r\n          return Object.assign({}, _item, data)\r\n        } else {\r\n          return _item\r\n        }\r\n      })\r\n\r\n      return { items: copy }\r\n    })\r\n  }\r\n\r\n  deleteItem(item: ProyectoHallazgo) {\r\n    this.setState((prevState) => {\r\n      const copy = _.reject(prevState.items, { id: item.id })\r\n\r\n      return { items: copy }\r\n    })\r\n  }\r\n\r\n  onMountPanel = () => {\r\n    if (this.state.items === null) {\r\n      this.props.modelManager.getJson(this.props).then((items) => {\r\n        this.setState({ items })\r\n      })\r\n    }\r\n  }\r\n\r\n  onCreateItem = (data: ProyectoHallazgo) => {\r\n    return new Promise<null>((resolve) => {\r\n      $.blockUI(create_blockUI_loading_message('Creando Hallazgo'))\r\n\r\n      this.props.modelManager.createItem(this.props, data).then((item) => {\r\n        this.addItem(item)\r\n        $.unblockUI()\r\n        resolve()\r\n      })\r\n    })\r\n  }\r\n\r\n  onSaveItem = (item: ProyectoHallazgo, changes: any, blockingText?: string) => {\r\n    return new Promise<ProyectoHallazgo>((resolve) => {\r\n      if (blockingText) {\r\n        $.blockUI(create_blockUI_loading_message(blockingText))\r\n      } else {\r\n        this.updateItem(item, changes)\r\n      }\r\n\r\n      this.props.modelManager.saveItem(this.props, item, changes).then((updatedItem) => {\r\n        this.updateItem(item, updatedItem)\r\n        if (blockingText) {\r\n          $.unblockUI()\r\n        }\r\n\r\n        resolve(updatedItem)\r\n      })\r\n    })\r\n  }\r\n\r\n  onClickDeleteItem = (item: ProyectoHallazgo) => {\r\n    bootbox.warningConfirm(\r\n      `¿Desea eliminar el hallazgo <strong>${HallazgoUtils.formatName(item.name)}</strong> ?`,\r\n      'No',\r\n      'Sí, Eliminar',\r\n      (answer: boolean) => {\r\n        if (!answer) {\r\n          return\r\n        }\r\n\r\n        $.blockUI(create_blockUI_loading_message('Eliminando Hallazgo'))\r\n\r\n        this.props.modelManager.deleteItem(this.props, item).then(() => {\r\n          this.deleteItem(item)\r\n          $.unblockUI()\r\n        })\r\n      }\r\n    )\r\n  }\r\n\r\n  render() {\r\n    return (\r\n      <BaseMenuElement\r\n        name='hallazgo'\r\n        counter={this.state.items === null ? this.props.counter : _.size(this.state.items)}\r\n        icon='hallazgos'\r\n        title='Hallazgos'\r\n        open={this.props.open}\r\n        onToggle={this.props.onOpen}\r\n        onMountPanel={this.onMountPanel}\r\n      >\r\n        <div className='content'>\r\n          <MenuItemNew\r\n            moduleParams={this.props.moduleParams}\r\n            buttonText='Crear Hallazgo'\r\n            headerText='Nuevo Hallazgo'\r\n            isEditable={es_proyecto_editable() && user_has_role_permission('hallazgo_create')}\r\n            item={createNewHallazgo()}\r\n            onSave={this.onCreateItem}\r\n            contentAs={HallazgoModal}\r\n          />\r\n          <HallazgoList\r\n            isEditable={es_proyecto_editable() && user_has_role_permission('hallazgo_edit')}\r\n            moduleParams={this.props.moduleParams}\r\n            items={this.state.items}\r\n            onSaveItem={this.onSaveItem}\r\n            onClickDeleteItem={this.onClickDeleteItem}\r\n          />\r\n        </div>\r\n      </BaseMenuElement>\r\n    )\r\n  }\r\n}\r\n\r\nfunction createNewHallazgo(): ProyectoHallazgo {\r\n  return {\r\n    id: null,\r\n    status: 'NUEVO',\r\n    implementado: null,\r\n    hallazgo: '',\r\n    RevisionLog: [],\r\n    UpdateLog: []\r\n  }\r\n}\r\n","import { PureComponent, SyntheticEvent } from 'react'\r\nimport { BaseMenuElement, MenuElementListPanel, MenuElementListActions } from './menuitem'\r\nimport AppMuestreoMas from '../../proyecto__muestreo/AppMuestreoMas'\r\nimport AppMuestreoMum from '../../proyecto__muestreo/AppMuestreoMum'\r\n\r\nimport Modal from 'semantic-ui-react/dist/commonjs/modules/Modal'\r\nimport { StatusDivBlock } from '../../global/StatusButtonAction'\r\n\r\ndeclare var _3Creatives: any\r\n\r\ntype MenuItemMuestreoState = {\r\n  items: ProyectoMuestreo[]\r\n}\r\n\r\nexport class MenuItemMuestreo extends PureComponent<DefaultMenuElementProps<ProyectoMuestreo>, MenuItemMuestreoState> {\r\n  state: MenuItemMuestreoState = {\r\n    items: null\r\n  }\r\n\r\n  onMountPanel = () => {\r\n    if (this.state.items === null) {\r\n      const { id_paso, id_visita } = this.props.moduleParams\r\n      $.getJSON(url_for2(`proyecto/:id_proyecto/paso/${id_paso}/visita/${id_visita}/muestreo/getJson`)).done((res) => {\r\n        this.setState({\r\n          items: _.isEmpty(res.response.muestreos) ? [] : this.parseItems(res.response.muestreos)\r\n        })\r\n      })\r\n    }\r\n  }\r\n\r\n  onClickDeleteItem = (item: ProyectoMuestreo) => {\r\n    bootbox.warningConfirm(\r\n      `¿Desea eliminar este muestreo <strong>${item.name}</strong>?`,\r\n      'No',\r\n      'Sí, Eliminar',\r\n      (r) => {\r\n        if (!r) {\r\n          return\r\n        }\r\n\r\n        const { id_paso, id_visita } = this.props.moduleParams\r\n\r\n        $.blockUI(create_blockUI_loading_message('Eliminando muestreo'))\r\n        $.ajax(url_for2(`proyecto/:id_proyecto/paso/${id_paso}/visita/${id_visita}/muestreo/${item.id}`), {\r\n          data: { _csrf_token: _3Creatives.CSRF_TOKEN },\r\n          type: 'delete'\r\n        }).done((res) => {\r\n          this.setState((prevState) => {\r\n            const items = _.reject(prevState.items, { id: item.id })\r\n\r\n            return { items }\r\n          })\r\n\r\n          $.unblockUI()\r\n        })\r\n      }\r\n    )\r\n  }\r\n\r\n  parseItems(items: any[]) {\r\n    return _.map(items, (item) => {\r\n      item.configValues = JSON.parse(item.config)\r\n\r\n      return item\r\n    })\r\n  }\r\n\r\n  render() {\r\n    const { id_paso, id_visita } = this.props.moduleParams\r\n\r\n    return (\r\n      <BaseMenuElement\r\n        name='muestreo'\r\n        counter={this.state.items === null ? this.props.counter : _.size(this.state.items)}\r\n        icon='muestreo'\r\n        title='Muestreo'\r\n        open={this.props.open}\r\n        onToggle={this.props.onOpen}\r\n        onMountPanel={this.onMountPanel}\r\n      >\r\n        <div className='content'>\r\n          {es_proyecto_editable() && (\r\n            <div className='_a-center'>\r\n              <a\r\n                className='button ui right tiny compact plain green rounded'\r\n                href={url_for2(`proyecto/:id_proyecto/paso/${id_paso}/visita/${id_visita}/muestreo/import`)}\r\n                target='_blank'\r\n              >\r\n                Nuevo Muestreo <i className='icon plus' />\r\n              </a>\r\n            </div>\r\n          )}\r\n\r\n          <MuestreoList\r\n            items={this.state.items}\r\n            moduleParams={this.props.moduleParams}\r\n            isEditable={es_proyecto_editable()}\r\n            onClickDeleteItem={this.onClickDeleteItem}\r\n          />\r\n        </div>\r\n      </BaseMenuElement>\r\n    )\r\n  }\r\n}\r\n\r\nclass MuestreoList extends PureComponent<DefaultMenuItemListProps<ProyectoMuestreo>> {\r\n  render() {\r\n    if (this.props.items === null) {\r\n      return (\r\n        <div style={{ height: 300, position: 'relative' }}>\r\n          <div className='ui active inverted text loader elastic olive'>Cargando Listado de Muestreos</div>\r\n        </div>\r\n      )\r\n    } else if (_.size(this.props.items) == 0) {\r\n      return <div className='empty nocontent'>0 Muestreos</div>\r\n    } else {\r\n      const { items } = this.props\r\n      return (\r\n        <MenuElementListPanel>\r\n          {_.map(items, (item) => {\r\n            return (\r\n              <div key={item.id} className='listitem muestreo-listitem'>\r\n                <MuestreoListItem\r\n                  item={item}\r\n                  moduleParams={this.props.moduleParams}\r\n                  onClickDelete={this.props.onClickDeleteItem}\r\n                />\r\n              </div>\r\n            )\r\n          })}\r\n        </MenuElementListPanel>\r\n      )\r\n    }\r\n  }\r\n}\r\n\r\ntype MuestreoListItemProps = {\r\n  moduleParams: any\r\n  item: ProyectoMuestreo\r\n  onClickDelete: (item: ProyectoMuestreo) => void\r\n}\r\n\r\nclass MuestreoListItem extends PureComponent<MuestreoListItemProps, { isModalOpen: boolean }> {\r\n  state = {\r\n    isModalOpen: false\r\n  }\r\n\r\n  getItemStatus() {\r\n    const { item } = this.props\r\n    switch (item.configValues.type) {\r\n      case 'mas':\r\n        return item.configValues.ficha_tecnica_mas_date ? 'COMPLETADO' : 'EN PROCESO'\r\n      case 'mum':\r\n        return item.configValues.ficha_tecnica_mum_date ? 'COMPLETADO' : 'EN PROCESO'\r\n      default:\r\n        return 'NUEVO'\r\n    }\r\n  }\r\n\r\n  onClickDelete = (ev: SyntheticEvent) => {\r\n    ev.preventDefault()\r\n    this.props.onClickDelete(this.props.item)\r\n  }\r\n\r\n  onClickItem = () => {\r\n    const { item } = this.props\r\n\r\n    if (!!item.configValues.type) {\r\n      this.setState({ isModalOpen: true })\r\n    }\r\n  }\r\n\r\n  renderModalContent() {\r\n    const { item } = this.props\r\n\r\n    switch (item.configValues.type) {\r\n      case 'mas':\r\n        return (\r\n          <AppMuestreoMas\r\n            data={item.configValues}\r\n            id_visita={this.props.moduleParams.id_visita}\r\n            id={this.props.item.id}\r\n            editable={false}\r\n          />\r\n        )\r\n      case 'mum':\r\n        return (\r\n          <AppMuestreoMum\r\n            data={item.configValues}\r\n            id_visita={this.props.moduleParams.id_visita}\r\n            id={this.props.item.id}\r\n            editable={false}\r\n          />\r\n        )\r\n    }\r\n  }\r\n\r\n  render() {\r\n    const { item, moduleParams } = this.props\r\n\r\n    return (\r\n      <div>\r\n        <MenuElementListActions\r\n          actions={{\r\n            goto: {\r\n              label: 'Ir al Muestreo',\r\n              url: `proyecto/:id_proyecto/paso/${moduleParams.id_paso}/visita/${moduleParams.id_visita}/muestreo/${item.id}`\r\n            },\r\n            delete: { label: 'Eliminar', callback: this.onClickDelete, permission: 'muestreo_delete' }\r\n          }}\r\n        />\r\n        <div>\r\n          <div className='row r1'>\r\n            <div className='pull-left r1_1'>\r\n              <span className='title-h1'>\r\n                {item.name}{' '}\r\n                <small className='ui horizontal mini label'>\r\n                  {(item.configValues.type ? item.configValues.type : 'SIN DEFINIR').toUpperCase()}\r\n                </small>\r\n                <StatusDivBlock\r\n                  wrapperClassName='pull-right text-mini'\r\n                  className='mini'\r\n                  hideLabel\r\n                  status={this.getItemStatus()}\r\n                />\r\n              </span>\r\n            </div>\r\n          </div>\r\n          <div className='ui segment basic' style={{ marginTop: 0 }} onClick={this.onClickItem}>\r\n            {!!item.configValues.type ? (\r\n              <table className='ui very compact celled small table'>\r\n                <thead>\r\n                  <tr>\r\n                    <th>Total Población</th>\r\n                    <th>Total Muestra</th>\r\n                    <th>Error Tolerable</th>\r\n                    <th>Error Proyectado</th>\r\n                  </tr>\r\n                </thead>\r\n                <tbody>\r\n                  <MuestreoListItemRow item={item} />\r\n                </tbody>\r\n              </table>\r\n            ) : (\r\n              <div className='_a-center'>\r\n                <a\r\n                  className='ui button orange'\r\n                  href={url_for2(\r\n                    `proyecto/:id_proyecto/paso/${moduleParams.id_paso}/visita/${moduleParams.id_visita}/muestreo/${item.id}`\r\n                  )}\r\n                >\r\n                  Configurar Muestreo\r\n                </a>\r\n              </div>\r\n            )}\r\n          </div>\r\n        </div>\r\n        {this.state.isModalOpen && (\r\n          <Modal\r\n            dimmer='inverted'\r\n            className='modal-muestreo modal-ab'\r\n            closeIcon\r\n            closeOnEscape\r\n            open\r\n            size='large'\r\n            onClose={() => this.setState({ isModalOpen: false })}\r\n          >\r\n            <Modal.Header>Muestreo {item.name}</Modal.Header>\r\n            <Modal.Content>{this.renderModalContent()}</Modal.Content>\r\n          </Modal>\r\n        )}\r\n      </div>\r\n    )\r\n  }\r\n}\r\n\r\nconst MuestreoListItemRow = (props: { item: ProyectoMuestreo }) => {\r\n  const { item } = props\r\n\r\n  const num = (string: string | number) => {\r\n    const v = parseFloat('' + string)\r\n\r\n    return isNaN(v) ? 0 : v\r\n  }\r\n\r\n  const getConfig = (config: string, defaultValue: number = null) => {\r\n    if (typeof item.configValues[config] === 'undefined') {\r\n      return defaultValue\r\n    }\r\n\r\n    return item.configValues[config]\r\n  }\r\n\r\n  const total_muestra = (() => {\r\n    if (\r\n      typeof item.configValues == 'undefined' ||\r\n      typeof item.configValues.type == 'undefined' ||\r\n      typeof item.configValues.muestras == 'undefined' ||\r\n      typeof item.configValues.muestras[item.configValues.type] == 'undefined'\r\n    ) {\r\n      return 0\r\n    }\r\n    const muestras = item.configValues.muestras[item.configValues.type]\r\n\r\n    return _.reduce(muestras, (acc: number, curr: any) => acc + num(curr.v), 0)\r\n  })()\r\n\r\n  switch (item.configValues.type) {\r\n    case 'mas':\r\n      const error_tolerable =\r\n        getConfig('E', 5) == -1 ? item.configValues.Ev : getConfig('E', 5) * item.configValues.M / 100\r\n\r\n      return (\r\n        <tr>\r\n          <td className='right aligned'>{accounting.formatNumber(item.configValues.M)}</td>\r\n\r\n          <td className='right aligned'>{accounting.formatNumber(total_muestra)}</td>\r\n          <td className='right aligned'>{accounting.formatNumber(num(error_tolerable))}</td>\r\n          <td className='right aligned'>{accounting.formatNumber(num(item.configValues.pry_1))}</td>\r\n        </tr>\r\n      )\r\n    case 'mum':\r\n      return (\r\n        <tr>\r\n          <td className='right aligned'>{accounting.formatNumber(item.configValues.M)}</td>\r\n          <td className='right aligned'>{accounting.formatNumber(total_muestra)}</td>\r\n\r\n          <td className='right aligned'>{accounting.formatNumber(num(item.configValues.e2__v2))}</td>\r\n          <td className='right aligned'>\r\n            {accounting.formatNumber(num(Math.abs(item.configValues.total_error_proyectado)))}\r\n          </td>\r\n        </tr>\r\n      )\r\n  }\r\n}\r\n","import { PureComponent, SyntheticEvent } from 'react'\r\n\r\nimport { BaseMenuElement } from './menuitem'\r\nimport RevisionList from './revision_list'\r\n\r\nimport Textarea from 'react-textarea-autosize'\r\n\r\ntype MenuItemRevisionState = {\r\n  items: ProyectoRevisionTree[]\r\n}\r\n\r\nexport class MenuItemRevision extends PureComponent<\r\n  DefaultMenuElementProps<ProyectoRevisionTree>,\r\n  MenuItemRevisionState\r\n> {\r\n  state: MenuItemRevisionState = {\r\n    items: null\r\n  }\r\n\r\n  parseItems = (input: any[]): ProyectoRevisionTree[] => {\r\n    return input\r\n  }\r\n\r\n  onMountPanel = () => {\r\n    if (this.state.items === null) {\r\n      this.props.modelManager.getJson(this.props).then((items) => {\r\n        this.setState({ items })\r\n      })\r\n    }\r\n  }\r\n\r\n  onCreateItem = (params: { text: string; status: 'NUEVO' | 'COMPLETADO' }, cb: () => void) => {\r\n    $.blockUI(create_blockUI_loading_message('Creando Nota de Revisión'))\r\n\r\n    this.props.modelManager\r\n      .createItem(this.props, { revision_text: params.text, op: params.status })\r\n      .then((revision) => {\r\n        this.setState((prevState) => {\r\n          const items = [ ...prevState.items ]\r\n          items.push(revision)\r\n\r\n          return { items }\r\n        })\r\n\r\n        cb()\r\n        $.unblockUI()\r\n      })\r\n  }\r\n\r\n  onSaveItem = (item: ProyectoRevisionTree, changes: any, blockingText?: string) => {\r\n    return new Promise<ProyectoRevisionTree>((resolve) => {\r\n      if (blockingText) {\r\n        setTimeout(() => $.blockUI(create_blockUI_loading_message(blockingText)), 1000 * 0.1)\r\n      }\r\n\r\n      this.props.modelManager.saveItem(this.props, item, changes).then((revision) => {\r\n        this.setState((prevState) => {\r\n          const items = _.map(prevState.items, (item) => {\r\n            return item.id == revision.id ? revision : item\r\n          })\r\n\r\n          return { items }\r\n        })\r\n\r\n        if (blockingText) {\r\n          $.unblockUI()\r\n        }\r\n\r\n        resolve(revision)\r\n      })\r\n    })\r\n  }\r\n\r\n  onClickDeleteItem = (item: ProyectoRevisionTree) => {\r\n    bootbox.warningConfirm(\r\n      `¿Desea eliminar esta Nota de Revisión <b>#${item.name}</b> ?`,\r\n      'No',\r\n      'Sí, Eliminar',\r\n      (r) => {\r\n        if (!r) {\r\n          return\r\n        }\r\n\r\n        $.blockUI(create_blockUI_loading_message('Eliminando Nota de Revisión'))\r\n\r\n        this.props.modelManager.deleteItem(this.props, item).then(() => {\r\n          this.setState((prevState) => {\r\n            const items = _.reject(prevState.items, { id: item.id })\r\n\r\n            return { items }\r\n          })\r\n          $.unblockUI()\r\n        })\r\n      }\r\n    )\r\n  }\r\n\r\n  renderContent() {\r\n    return (\r\n      <div className='content'>\r\n        <RevisionNewForm onSubmit={this.onCreateItem} />\r\n        <RevisionList\r\n          items={this.state.items}\r\n          moduleParams={this.props.moduleParams}\r\n          isEditable={es_proyecto_editable() && user_has_role_permission('revision_edit')}\r\n          onSaveItem={this.onSaveItem}\r\n          onClickDeleteItem={this.onClickDeleteItem}\r\n        />\r\n      </div>\r\n    )\r\n  }\r\n\r\n  render() {\r\n    return (\r\n      <BaseMenuElement\r\n        name='revision'\r\n        counter={\r\n          this.state.items === null ? this.props.counter : _.size(_.reject(this.state.items, { status: 'REVISADO' }))\r\n        }\r\n        icon='notas_de_revision'\r\n        title='Notas de Revisión'\r\n        open={this.props.open}\r\n        onToggle={this.props.onOpen}\r\n        onMountPanel={this.onMountPanel}\r\n      >\r\n        {this.renderContent()}\r\n      </BaseMenuElement>\r\n    )\r\n  }\r\n}\r\n\r\ntype RevisionNewFormProps = {\r\n  onSubmit: (params: { text: string; status: 'NUEVO' | 'COMPLETADO' }, cb: () => void) => void\r\n}\r\n\r\nclass RevisionNewForm extends PureComponent<RevisionNewFormProps, { text: string; isEditMode: boolean }> {\r\n  state = {\r\n    text: '',\r\n    isEditMode: false\r\n  }\r\n\r\n  onChange = (ev: SyntheticEvent) => {\r\n    this.setState({ text: (ev.target as any).value })\r\n  }\r\n\r\n  onTextareaKeyDown = (ev: React.KeyboardEvent) => {\r\n    if (ev.keyCode == 27) {\r\n      // on press Esc\r\n      this.onCancel()\r\n    }\r\n\r\n    if ((ev.ctrlKey || ev.metaKey) && (ev.keyCode == 13 || ev.keyCode == 10)) {\r\n      // on press ctrl + Enter\r\n      this.onSubmit('NUEVO')\r\n    }\r\n  }\r\n\r\n  onClickNew = () => {\r\n    this.setState({ isEditMode: true })\r\n  }\r\n\r\n  onCancel = () => {\r\n    this.setState({ isEditMode: false, text: '' })\r\n  }\r\n\r\n  onSubmit = (status: 'NUEVO' | 'COMPLETADO') => {\r\n    if (_.str.trim(this.state.text) == '') {\r\n      bootbox.alertError('La Nota de Revisión no puede estar vacía.')\r\n      return\r\n    }\r\n\r\n    this.props.onSubmit({ text: _.str.trim(this.state.text), status }, () => {\r\n      this.setState({ text: '', isEditMode: false })\r\n    })\r\n  }\r\n\r\n  render() {\r\n    if (!es_proyecto_editable() || !user_has_role_permission('revision_edit')) {\r\n      return null\r\n    }\r\n\r\n    return !this.state.isEditMode ? (\r\n      <div style={{ textAlign: 'center' }}>\r\n        <button className='ui button primary mini compact' onClick={this.onClickNew}>\r\n          Crear Nota\r\n        </button>\r\n      </div>\r\n    ) : (\r\n      <div>\r\n        <Textarea\r\n          minRows={2}\r\n          maxRows={8}\r\n          autoFocus\r\n          onChange={this.onChange}\r\n          value={this.state.text}\r\n          style={{ width: '98%' }}\r\n          onKeyDown={this.onTextareaKeyDown}\r\n          placeholder='Escriba aquí su Nota de Revisión'\r\n        />\r\n        <div style={{ marginTop: 8, textAlign: 'right' }}>\r\n          <button className='ui button negative mini compact' onClick={this.onCancel}>\r\n            Cancelar\r\n          </button>\r\n          <button className='ui button primary mini compact' onClick={() => this.onSubmit('NUEVO')}>\r\n            Guardar\r\n          </button>\r\n        </div>\r\n      </div>\r\n    )\r\n  }\r\n}\r\n","import { PureComponent, SyntheticEvent } from 'react'\r\nimport { invoke } from 'lodash'\r\n\r\ntype SidebarPanelHeaderProps = {\r\n  title: string\r\n  onClose: (ev: SyntheticEvent) => void\r\n  onMount?: () => void\r\n}\r\n\r\nexport class SidebarPanelHeader extends PureComponent<SidebarPanelHeaderProps> {\r\n  componentDidMount() {\r\n    invoke(this.props, 'onMount')\r\n  }\r\n  render() {\r\n    return (\r\n      <header>\r\n        <a href='#' className='close-link' onClick={this.props.onClose}>\r\n          <i className='ui icon close green' />\r\n        </a>\r\n        <div className='title'>{this.props.title}</div>\r\n      </header>\r\n    )\r\n  }\r\n}\r\n","import { PureComponent, SyntheticEvent, Fragment } from 'react'\r\nimport { MenuElementListPanel, MenuElementListActions } from './menuitem'\r\nimport { AuthorIconLogDefaultWrapper } from '../../global/AuthorIconLog'\r\nimport { StatusDivBlock } from '../../global/StatusButtonAction'\r\nimport Textarea from 'react-textarea-autosize'\r\nimport cx from 'classnames'\r\nimport Popup from 'semantic-ui-react/dist/commonjs/modules/Popup'\r\n\r\nexport default class RevisionList extends PureComponent<DefaultMenuItemListProps<ProyectoRevisionTree>> {\r\n  render() {\r\n    if (this.props.items === null) {\r\n      return (\r\n        <div style={{ height: 300, position: 'relative' }}>\r\n          <div className='ui active inverted text loader elastic olive'>Cargando Notas de Revisión</div>\r\n        </div>\r\n      )\r\n    } else if (_.size(this.props.items) == 0) {\r\n      return <div className='empty nocontent'>0 Notas de Revisión</div>\r\n    } else {\r\n      const { items } = this.props\r\n\r\n      const porRevisarItems = _.reject(items, { status: 'REVISADO' })\r\n      const revisadoItems = _.filter(items, { status: 'REVISADO' })\r\n\r\n      return (\r\n        <MenuElementListPanel className='revision-list'>\r\n          {_.size(porRevisarItems) == 0 ? (\r\n            <div className='empty nocontent'>0 Notas de Revisión Abiertas</div>\r\n          ) : (\r\n            _.map(porRevisarItems, (item: ProyectoRevisionTree) => {\r\n              return (\r\n                <div key={item.id} className='listitem revision-listitem'>\r\n                  <RevisionListItem\r\n                    item={item}\r\n                    isEditable={this.props.isEditable}\r\n                    onSave={this.props.onSaveItem}\r\n                    onClickDelete={this.props.onClickDeleteItem}\r\n                  />\r\n                </div>\r\n              )\r\n            })\r\n          )}\r\n\r\n          {_.size(revisadoItems) > 0 && <RevisionDisabledList items={revisadoItems} />}\r\n        </MenuElementListPanel>\r\n      )\r\n    }\r\n  }\r\n}\r\n\r\nclass RevisionDisabledList extends PureComponent<{ items: ProyectoRevisionTree[] }, { collapsed: boolean }> {\r\n  state = {\r\n    collapsed: true\r\n  }\r\n\r\n  toggle = () => {\r\n    this.setState((prevState) => {\r\n      return { collapsed: !prevState.collapsed }\r\n    })\r\n  }\r\n\r\n  render() {\r\n    const { items } = this.props\r\n\r\n    return (\r\n      <div style={{ marginTop: 20, marginBottom: 20, padding: '0 10px' }}>\r\n        <h4 className='row clickable' onClick={this.toggle}>\r\n          <i className={cx('icon caret', !this.state.collapsed ? 'down' : 'right')} /> Notas Revisadas\r\n          <span className='toggle-action'>[{this.state.collapsed ? 'Mostrar' : 'Ocultar'}]</span>\r\n          <span className='ui mini circular green label pull-right'>{_.size(items)}</span>\r\n        </h4>\r\n        {!this.state.collapsed && (\r\n          <div className='revision-list-closed'>\r\n            {_.map(items, (item: ProyectoRevisionTree) => {\r\n              return (\r\n                <div key={item.id} className='listitem revision-listitem'>\r\n                  <RevisionListItem item={item} isEditable={false} />\r\n                </div>\r\n              )\r\n            })}\r\n          </div>\r\n        )}\r\n      </div>\r\n    )\r\n  }\r\n}\r\n\r\ntype RevisionListItemState = {\r\n  isEditMode: boolean\r\n  isThreadOpen: boolean\r\n}\r\n\r\nclass RevisionListItem extends PureComponent<\r\n  DefaultMenuItemListItemProps<ProyectoRevisionTree>,\r\n  RevisionListItemState\r\n> {\r\n  state = {\r\n    isEditMode: false,\r\n    isThreadOpen: false\r\n  }\r\n\r\n  onClickEdit = () => {\r\n    this.setState({ isEditMode: true })\r\n  }\r\n\r\n  onClickDelete = (ev: SyntheticEvent) => {\r\n    ev.preventDefault()\r\n    this.props.onClickDelete(this.props.item)\r\n  }\r\n\r\n  onClickNewComment = () => {\r\n    if (this.props.isEditable) {\r\n      this.setState({ isThreadOpen: true })\r\n    }\r\n  }\r\n\r\n  onCancelNewComment = () => {\r\n    this.setState({ isThreadOpen: false })\r\n  }\r\n\r\n  onChange = (changes: any) => {\r\n    this.props.onSave(this.props.item, changes, 'Guardando cambios...').then(() => {\r\n      this.setState({ isEditMode: false })\r\n    })\r\n  }\r\n\r\n  onClickChangeStatus = (status: any) => {\r\n    this.props.onSave(this.props.item, { op: status }, 'Marcando como ' + status + '...')\r\n  }\r\n\r\n  onAddComment = (params: { text: string; status: string }) => {\r\n    const changes: any = { comment: params.text }\r\n    if (params.status) {\r\n      changes.op = params.status\r\n    }\r\n\r\n    this.props.onSave(this.props.item, changes, 'Guardando comentario...').then(() => {\r\n      this.setState({ isThreadOpen: false })\r\n    })\r\n  }\r\n\r\n  render() {\r\n    const { item } = this.props\r\n    return (\r\n      <div>\r\n        {this.props.isEditable && (\r\n          <MenuElementListActions\r\n            actions={{\r\n              delete: { label: 'Eliminar', callback: this.onClickDelete, permission: 'revision_delete' }\r\n            }}\r\n          />\r\n        )}\r\n        <div className='row header-item'>\r\n          <div className='pull-left'>\r\n            <span className='title-h1'>Nota #{item.name}</span>\r\n            <AuthorIconLogDefaultWrapper model={item} size='small' />\r\n          </div>\r\n          <StatusDivBlock\r\n            wrapperClassName='pull-right text-mini'\r\n            status={item.status || 'EN PROCESO'}\r\n            className='mini'\r\n            hideLabel\r\n          />\r\n        </div>\r\n\r\n        <div className='author-info'>\r\n          <i aria-hidden='true' className='user circle icon olive' style={{ float: 'left' }} />\r\n          <div className='content'>\r\n            <div className='header'>\r\n              {item.Creator.User.name}\r\n              <div className='pull-right description'>\r\n                {Date.create(item.Creator.ts).format('{d} {Mon} {year} {h}:{mm} {tt}')}\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        {this.props.isEditable && this.state.isEditMode ? (\r\n          <RevisionEditForm item={item} onSubmit={this.onChange} />\r\n        ) : (\r\n          <Fragment>\r\n            <p\r\n              onClick={this.onClickNewComment}\r\n              style={{ lineHeight: '1em' }}\r\n              dangerouslySetInnerHTML={{ __html: item.description.replace(/\\n/g, '<br/>') }}\r\n            />\r\n            <div className={cx('threadlist ui threaded comments', { empty: _.size(item.Comments) == 0 })}>\r\n              {this.state.isThreadOpen && (\r\n                <h5 className={cx('ui header', { dividing: _.size(item.Comments) == 0 })}>Comentarios</h5>\r\n              )}\r\n              {_.map(item.Comments, (comment) => {\r\n                return (\r\n                  <div className='comment' key={comment.id} onClick={this.onClickNewComment}>\r\n                    <div className='avatar'>\r\n                      <i\r\n                        className={cx('icon user circle', {\r\n                          green: comment.status == 'COMPLETADO',\r\n                          olive: comment.status == 'REVISADO'\r\n                        })}\r\n                      />\r\n                    </div>\r\n                    <div className='content'>\r\n                      <div className='author'>{comment.Creator.User.name}</div>\r\n                      <div className='metadata'>\r\n                        {Date.create(comment.Creator.ts).format('{d} {Mon} {year}  {h}:{mm} {tt}')}\r\n                      </div>\r\n                      <div className='text'>\r\n                        <p dangerouslySetInnerHTML={{ __html: comment.comentario }} />\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n                )\r\n              })}\r\n            </div>\r\n            {this.state.isThreadOpen && this.props.isEditable ? (\r\n              <RevisionComentarioForm parentItem={item} onSave={this.onAddComment} onCancel={this.onCancelNewComment} />\r\n            ) : (\r\n              this.props.isEditable && (\r\n                <div className='actions-wrapper'>\r\n                  <div className='actions'>\r\n                    <div className='group-actions'>\r\n                      <button className='ui button icon blue mini compact' onClick={this.onClickNewComment}>\r\n                        Responder\r\n                      </button>\r\n                    </div>\r\n                    <div className='group-actions right-actions'>\r\n                      {user_has_role_permission('revision_edit') && (\r\n                        <button\r\n                          className='ui button icon primary mini compact'\r\n                          onClick={() => this.onClickChangeStatus('COMPLETADO')}\r\n                        >\r\n                          <i className='icon check' /> Completar\r\n                        </button>\r\n                      )}\r\n\r\n                      {user_has_role_permission('revision_revisado') && (\r\n                        <Popup\r\n                          disabled={item.fecha_completado != null}\r\n                          className='disable-text'\r\n                          on='hover'\r\n                          basic\r\n                          content='Debe estar primero en estado COMPLETADO, para poder marcarla como REVISADA.'\r\n                          trigger={\r\n                            <div className='button-wrapper'>\r\n                              <button\r\n                                className='ui button mini compact olive'\r\n                                disabled={item.fecha_completado == null}\r\n                                onClick={() =>\r\n                                  item.fecha_completado == null ? void 0 : this.onClickChangeStatus('REVISADO')}\r\n                              >\r\n                                <i className='icon check fitted' />\r\n                                <i className='icon check' /> Revisado\r\n                              </button>\r\n                            </div>\r\n                          }\r\n                        />\r\n                      )}\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              )\r\n            )}\r\n          </Fragment>\r\n        )}\r\n      </div>\r\n    )\r\n  }\r\n}\r\n\r\ntype RevisionEditFormProps = {\r\n  item: ProyectoRevisionTree\r\n  onSubmit: (changes: { revision_text: string; op?: 'COMPLETADO' | 'REVISADO' }) => void\r\n}\r\n\r\ntype RevisionEditFormState = {\r\n  value: string\r\n}\r\n\r\nclass RevisionEditForm extends PureComponent<RevisionEditFormProps, RevisionEditFormState> {\r\n  constructor(props: RevisionEditFormProps) {\r\n    super(props)\r\n    this.state = {\r\n      value: this.props.item.description\r\n    }\r\n  }\r\n\r\n  onChange = (ev: SyntheticEvent) => {\r\n    this.setState({ value: (ev.target as any).value })\r\n  }\r\n\r\n  onSubmit = (status?: 'COMPLETADO' | 'REVISADO') => {\r\n    if (_.str.trim(this.state.value) == '') {\r\n      bootbox.alertError('La Nota de Revisión no puede estar vacía.')\r\n      return\r\n    }\r\n\r\n    const changes: any = { revision_text: _.str.trim(this.state.value) }\r\n    if (status) {\r\n      changes.op = status\r\n    }\r\n    this.props.onSubmit(changes)\r\n  }\r\n\r\n  render() {\r\n    return (\r\n      <Fragment>\r\n        <Textarea\r\n          minRows={2}\r\n          maxRows={8}\r\n          onChange={this.onChange}\r\n          value={this.state.value}\r\n          style={{ width: '98%' }}\r\n          placeholder='Escriba aquí su Nota de Revisión'\r\n        />\r\n\r\n        <div style={{ marginTop: 8, textAlign: 'right' }}>\r\n          <button className='ui button icon primary mini compact' onClick={() => this.onSubmit()}>\r\n            Guardar\r\n          </button>\r\n\r\n          <button className='ui button icon primary mini compact' onClick={() => this.onSubmit('COMPLETADO')}>\r\n            <i className='icon check' /> Completar\r\n          </button>\r\n\r\n          <Popup\r\n            disabled={this.props.item.fecha_completado != null}\r\n            className='disable-text'\r\n            on='hover'\r\n            basic\r\n            content='Debe estar primero en estado COMPLETADO, para poder marcarla como REVISADA.'\r\n            trigger={\r\n              <div className='button-wrapper'>\r\n                <button\r\n                  className='ui button mini compact olive'\r\n                  disabled={this.props.item.fecha_completado == null}\r\n                  onClick={() => (this.props.item.fecha_completado == null ? void 0 : this.onSubmit('REVISADO'))}\r\n                >\r\n                  <i className='icon check fitted' />\r\n                  <i className='icon check' /> Revisado\r\n                </button>\r\n              </div>\r\n            }\r\n          />\r\n        </div>\r\n      </Fragment>\r\n    )\r\n  }\r\n}\r\n\r\ntype RevisionComentarioFormProps = {\r\n  parentItem: ProyectoRevisionTree\r\n  onSave: (params: { text: string; status: string }) => void\r\n  onCancel: () => void\r\n}\r\nclass RevisionComentarioForm extends PureComponent<RevisionComentarioFormProps> {\r\n  cancelTimeout: number = null\r\n\r\n  state = {\r\n    value: ''\r\n  }\r\n\r\n  onChange = (ev: SyntheticEvent) => {\r\n    this.setState({ value: (ev.target as any).value })\r\n  }\r\n\r\n  onTextareaKeyDown = (ev: React.KeyboardEvent) => {\r\n    if (ev.keyCode == 27) {\r\n      // on press Esc\r\n      this.props.onCancel()\r\n      this.cancelTimeout = null\r\n    }\r\n\r\n    if ((ev.ctrlKey || ev.metaKey) && (ev.keyCode == 13 || ev.keyCode == 10)) {\r\n      // on press ctrl + Enter\r\n      this.onSubmit()\r\n    }\r\n  }\r\n\r\n  onSubmit = (status?: 'COMPLETADO' | 'REVISADO') => {\r\n    if (_.str.trim(this.state.value) == '' && !status) {\r\n      return\r\n    }\r\n\r\n    if (this.cancelTimeout != null) {\r\n      window.clearTimeout(this.cancelTimeout)\r\n      this.cancelTimeout = null\r\n    }\r\n\r\n    this.props.onSave({ text: _.str.trim(this.state.value), status })\r\n  }\r\n\r\n  onBlur = () => {\r\n    this.cancelTimeout = window.setTimeout(() => {\r\n      this.props.onCancel()\r\n    }, 1000 * 0.5)\r\n  }\r\n\r\n  render() {\r\n    return (\r\n      <div style={{ marginBottom: 30 }}>\r\n        <Textarea\r\n          minRows={2}\r\n          maxRows={5}\r\n          autoFocus\r\n          value={this.state.value}\r\n          onChange={this.onChange}\r\n          onKeyDown={this.onTextareaKeyDown}\r\n          placeholder='Escriba aquí su comentario'\r\n          style={{ width: '95%' }}\r\n          onBlur={() => this.onBlur()}\r\n        />\r\n\r\n        <div style={{ textAlign: 'right', marginTop: 5 }}>\r\n          <button className='ui button icon blue mini compact pull-left' onClick={() => this.onSubmit()}>\r\n            Enviar\r\n          </button>\r\n\r\n          <button className='ui button icon primary mini compact' onClick={() => this.onSubmit('COMPLETADO')}>\r\n            <i className='icon check' /> Completar\r\n          </button>\r\n\r\n          <Popup\r\n            disabled={this.props.parentItem.fecha_completado != null}\r\n            className='disable-text'\r\n            on='hover'\r\n            basic\r\n            content='Debe estar primero en estado COMPLETADO, para poder marcarla como REVISADA.'\r\n            trigger={\r\n              <div className='button-wrapper'>\r\n                <button\r\n                  className='ui button mini compact olive'\r\n                  disabled={this.props.parentItem.fecha_completado == null}\r\n                  onClick={() => (this.props.parentItem.fecha_completado == null ? void 0 : this.onSubmit('REVISADO'))}\r\n                >\r\n                  <i className='icon check fitted' />\r\n                  <i className='icon check' /> Revisado\r\n                </button>\r\n              </div>\r\n            }\r\n          />\r\n        </div>\r\n      </div>\r\n    )\r\n  }\r\n}\r\n","export namespace HojaTrabajoUtils {\r\n  export function getAllVisitasAfter(hoja_trabajo: HojaTrabajo, visitaPivot: ProyectoPasoVisita) {\r\n    let visitas: ProyectoPasoVisita[] = []\r\n    let found: boolean = false\r\n\r\n    _.forEach(hoja_trabajo.visitas, function(visita) {\r\n      if (found) {\r\n        visitas.push(visita)\r\n        return\r\n      }\r\n      if (visita.id == visitaPivot.id) {\r\n        found = true\r\n      }\r\n    })\r\n\r\n    return visitas\r\n  }\r\n}\r\n\r\nexport namespace HojaTrabajoUpdateUtils {\r\n  /**\r\n   *\r\n   * @param hoja_trabajo Hoja de trabajo a actualizar\r\n   * @param visita Visita a actualizar\r\n   * @param new_data Datos actualizados a aplicar a la visita\r\n   */\r\n  export function updateVisita(\r\n    hoja_trabajo: HojaTrabajo,\r\n    visita: ProyectoPasoVisita | { id: string },\r\n    new_data: Partial<ProyectoPasoVisita>\r\n  ) {\r\n    let hoja_trabajo_copy = Object.assign({}, hoja_trabajo)\r\n\r\n    hoja_trabajo_copy.visitas = _.mapValues(hoja_trabajo_copy.visitas, (item) => {\r\n      if (item.id == visita.id) {\r\n        item = Object.assign({}, item, new_data)\r\n      }\r\n      return item\r\n    })\r\n\r\n    return hoja_trabajo_copy\r\n  }\r\n\r\n  export function updateVisitas(\r\n    hoja_trabajo: HojaTrabajo,\r\n    new_data: { [id_visita: string]: Partial<ProyectoPasoVisita> }\r\n  ) {\r\n    _.forEach(new_data, (visita_new_data, id_visita) => {\r\n      const visita = _.findWhere(hoja_trabajo.visitas, { id_visita })\r\n      hoja_trabajo = updateVisita(hoja_trabajo, visita, visita_new_data)\r\n    })\r\n\r\n    return hoja_trabajo\r\n  }\r\n\r\n  export function updateField(hoja_trabajo: HojaTrabajo, field: keyof HojaTrabajo, new_data: any) {\r\n    let hoja_trabajo_copy = Object.assign({}, hoja_trabajo)\r\n\r\n    hoja_trabajo_copy[field] = Object.assign({}, hoja_trabajo_copy[field], new_data)\r\n\r\n    return hoja_trabajo_copy\r\n  }\r\n}\r\n","export const getNombreCuenta = (cuentas: ProyectoAjusteCuenta[], cuenta: string) => {\r\n  let found = _.findWhere(cuentas, { cuenta })\r\n\r\n  if (found) {\r\n    return found.nombre_cuenta\r\n  }\r\n\r\n  const cleanCuenta = function(c: string) {\r\n    return c.replace(/\\D/g, '')\r\n  }\r\n\r\n  found = _.findWhere(\r\n    _.map(cuentas, function(item) {\r\n      return { cuenta: cleanCuenta(item.cuenta), cuenta_real: item.cuenta_real, nombre_cuenta: item.nombre_cuenta }\r\n    }),\r\n    { cuenta: cleanCuenta(cuenta) }\r\n  )\r\n\r\n  return found ? found.nombre_cuenta : ''\r\n}\r\n","export namespace HallazgoUtils {\r\n  export function formatName(name: string) {\r\n    return ('' + name).match(/^\\d+$/) ? 'Hallazgo #' + name : name\r\n  }\r\n}\r\n","import htmlTruncate from 'html-truncate'\r\n\r\nexport function cleanSpacesFromHtml(text: string) {\r\n  if (text == null) {\r\n    return text\r\n  }\r\n\r\n  text = text.trim().replace(/\\r?\\n|\\r/g, '')\r\n  text = text.replace(/>\\s+</g, '><')\r\n  text = text.replace(/\\s{2,}/g, ' ')\r\n\r\n  return text\r\n}\r\n\r\nexport function truncateText(text: string, length: number = 300) {\r\n  if (text == null) {\r\n    return text\r\n  }\r\n\r\n  text = cleanSpacesFromHtml(text)\r\n  text = text.replace(/<table.*\\/table>/g, '<img src=\"/images/icon_tabular.png\" title=\"Tabla\" />') // Remove all tables\r\n\r\n  let html = htmlTruncate('' + text, length, { keepImageTag: true })\r\n\r\n  html = html.replace(/(min-)?width:.+?;/g, '')\r\n  html = html.replace(/(min-)?height:.+?;/g, '')\r\n  html = html.replace(/style=\".+?\"/g, '')\r\n\r\n  return html.trim()\r\n}\r\n","import { PureComponent, SyntheticEvent, Fragment } from 'react'\r\n\r\nimport cx from 'classnames'\r\nimport getvalue from 'get-value'\r\nimport { GenericTooltip } from '../global/Tooltip'\r\nimport EditorPreview from '../global/EditorPreview'\r\nimport { isEmpty, cacheMuestra, getCacheAllMuestra } from './utis'\r\nimport { TableMuestras, FormFichaTecnica } from './TableMuestra'\r\nimport { generarMuestras, calculateTamanoMuestra } from './utils_mas'\r\n\r\ndeclare var app: any\r\n\r\ntype AppMuestreoMasProps = {\r\n  id: string\r\n  id_visita: string\r\n  data: any\r\n  editable: boolean\r\n}\r\n\r\ntype AppMuestreoMasStateValueType = {\r\n  /** Nivel confianza */\r\n  Z: number\r\n  /** Porcentaje Error Tolerable */\r\n  E: number\r\n  /** Proporcion del Exito */\r\n  P: number\r\n  /** Tamaño de la muestra */\r\n  cf_1: number\r\n  /** Valor Error Tolerable */\r\n  Ev?: number\r\n\r\n  pry_1: number\r\n  pry_2: number\r\n  pry_3: 'SI' | 'NO'\r\n\r\n  conclusion_custom_mas: string\r\n}\r\n\r\ntype AppMuestreoMasState = {\r\n  step: number\r\n  values: AppMuestreoMasStateValueType\r\n  muestras: MuestraItem[]\r\n}\r\n\r\nfunction num(string: string | number) {\r\n  const value = parseFloat('' + string)\r\n\r\n  return isNaN(value) ? 0 : value\r\n}\r\n\r\nexport default class AppMuestreoMas extends PureComponent<AppMuestreoMasProps, AppMuestreoMasState> {\r\n  private handlers: { [s: string]: any } = {}\r\n\r\n  private hasModified: boolean = false\r\n\r\n  constructor(props: AppMuestreoMasProps) {\r\n    super(props)\r\n\r\n    const muestras = getvalue(props.data, 'muestras.mas', null)\r\n\r\n    const Z = isEmpty(props.data.Z) ? 90 : num(props.data.Z)\r\n    const E = isEmpty(props.data.E) ? (muestras === null ? -1 : 5) : num(props.data.E)\r\n    const P = isEmpty(props.data.P) ? 0.9 : num(props.data.P)\r\n\r\n    const cf_1 =\r\n      isEmpty(props.data.cf_1) && this.props.editable\r\n        ? calculateTamanoMuestra(props.data.N, P, Z, this.getErrorTolerable(E))\r\n        : num(props.data.cf_1)\r\n\r\n    this.state = {\r\n      step: 1,\r\n      values: {\r\n        Z,\r\n        E,\r\n        P,\r\n        cf_1,\r\n        pry_1: props.data.pry_1,\r\n        pry_2: props.data.pry_2,\r\n        pry_3: props.data.pry_3,\r\n        Ev: props.data.Ev,\r\n        conclusion_custom_mas: props.data.conclusion_custom_mas || ''\r\n      },\r\n      muestras:\r\n        muestras == null && this.props.editable\r\n          ? this.generarMuestras(cf_1)\r\n          : _.map(muestras, (muestra: MuestraItem) => {\r\n              if (!isEmpty(muestra.r)) {\r\n                muestra.r = parseFloat(muestra.r + '')\r\n              }\r\n              return muestra\r\n            })\r\n    }\r\n\r\n    if (muestras != null) {\r\n      _.forEach(muestras, (muestra) => cacheMuestra(muestra))\r\n    } else if (this.props.editable) {\r\n      $.blockUI(create_blockUI_loading_message('Guardando cambios'))\r\n\r\n      this.sendToServer({\r\n        type: 'mas',\r\n        muestras: this.state.muestras,\r\n        fields: _.omit(this.state.values, [ 'conclusion_custom_mas' ])\r\n      }).done(() => {\r\n        $.unblockUI()\r\n      })\r\n    }\r\n  }\r\n\r\n  isClosed() {\r\n    return !!this.props.data.ficha_tecnica_mas_date\r\n  }\r\n\r\n  isReadOnly() {\r\n    return !this.props.editable || !!this.props.data.ficha_tecnica_mas_date\r\n  }\r\n\r\n  attachHandler(field: string, handler: any) {\r\n    if (!this.handlers[field]) {\r\n      this.handlers[field] = handler\r\n    }\r\n\r\n    return this.handlers[field]\r\n  }\r\n\r\n  getErrorTolerable(E: number) {\r\n    if (E == -1) {\r\n      const materialidad = parseFloat(getvalue(app, 'vars.muestreo.materialidad.total_planeacion', 0))\r\n      return 100 * materialidad / this.props.data.M\r\n    } else {\r\n      return E\r\n    }\r\n  }\r\n\r\n  generarMuestras(tamano_muestra: number) {\r\n    const muestras = generarMuestras(app.vars.muestras, tamano_muestra)\r\n    const cache = getCacheAllMuestra()\r\n    _.forEach(muestras, (muestra, k) => {\r\n      if (typeof cache[muestra.cod] != 'undefined') {\r\n        muestras[k].r = cache[muestra.cod]\r\n      }\r\n    })\r\n\r\n    return muestras\r\n  }\r\n\r\n  isValidToStep3() {\r\n    return _.all(this.state.muestras, (muestra) => muestra.r != null)\r\n  }\r\n\r\n  sendToServer(params: any) {\r\n    if (this.isReadOnly()) {\r\n      return\r\n    }\r\n\r\n    params.t = 'mas'\r\n    if (typeof params.fields !== 'undefined') {\r\n      params.fields = _.map(params.fields, (value, key) => {\r\n        return { field: key, value }\r\n      })\r\n    }\r\n    return $.post(url_for(`proyecto_muestreo/${this.props.id}/config`), params)\r\n  }\r\n\r\n  onChangeSelect = (field: string) => {\r\n    return this.attachHandler(field, (ev: SyntheticEvent) => {\r\n      const value = (ev.target as any).value\r\n      this.setState((prevState) => {\r\n        const newValues: AppMuestreoMasStateValueType = Object.assign({}, prevState.values, {\r\n          [field]: parseFloat(value)\r\n        })\r\n\r\n        newValues.cf_1 = calculateTamanoMuestra(\r\n          this.props.data.N,\r\n          newValues.P,\r\n          newValues.Z,\r\n          this.getErrorTolerable(newValues.E)\r\n        )\r\n\r\n        newValues.Ev = this.getErrorTolerable(newValues.E) * this.props.data.M / 100\r\n\r\n        const muestras = this.generarMuestras(newValues.cf_1)\r\n\r\n        this.sendToServer({ muestras, fields: _.omit(newValues, [ 'conclusion_custom_mas' ]) })\r\n\r\n        return { values: newValues, muestras }\r\n      })\r\n    })\r\n  }\r\n\r\n  onChangeMuestra = (muestra: MuestraItem, persist: boolean) => {\r\n    if (this.isReadOnly()) {\r\n      return\r\n    }\r\n\r\n    const num = (num: any) => (isNaN(parseFloat(num)) ? 0 : parseFloat(num))\r\n\r\n    this.setState((prevState) => {\r\n      if (!this.hasModified) {\r\n        const prevValue = _.find(prevState.muestras, { cod: muestra.cod })\r\n        if (!_.isEqual(prevValue, muestra)) {\r\n          this.hasModified = true\r\n        }\r\n      }\r\n\r\n      const muestras = _.map(prevState.muestras, (_muestra) => {\r\n        return muestra.cod == _muestra.cod ? muestra : _muestra\r\n      })\r\n\r\n      if (!persist) {\r\n        return { muestras, values: prevState.values }\r\n      }\r\n\r\n      const values = { ...prevState.values }\r\n\r\n      let total_diff: number = 0\r\n      _.forEach(muestras, (muestra) => {\r\n        if (!isEmpty(muestra.v) && !isEmpty(muestra.r)) {\r\n          total_diff += muestra.v - muestra.r\r\n        }\r\n      })\r\n\r\n      const total_e = _.reduce(muestras, (acc: number, curr) => acc + num(curr.v), 0)\r\n\r\n      values.pry_1 = this.props.data.M * total_diff / total_e\r\n      values.pry_2 = 100 * values.pry_1 / this.props.data.M\r\n\r\n      const error_tolerable = this.getErrorTolerable(values.E)\r\n      const error_muestral: number = this.props.data.M * error_tolerable / 100\r\n\r\n      values.pry_3 = Math.abs(values.pry_1) > Math.abs(error_muestral) ? 'SI' : 'NO'\r\n\r\n      if (this.hasModified) {\r\n        this.sendToServer({ muestras, fields: _.omit(values, [ 'conclusion_custom_mas' ]) })\r\n        this.hasModified = false\r\n      }\r\n\r\n      return { muestras, values }\r\n    })\r\n    cacheMuestra(muestra)\r\n  }\r\n\r\n  onSaveConclusion = (editor: CKEDITOR.editor) => {\r\n    if (this.isReadOnly()) {\r\n      return\r\n    }\r\n\r\n    this.setState((prevState) => {\r\n      const values = { ...prevState.values }\r\n      values.conclusion_custom_mas = editor.getData()\r\n\r\n      this.sendToServer({ fields: { conclusion_custom: values.conclusion_custom_mas } })\r\n\r\n      return { values }\r\n    })\r\n  }\r\n\r\n  onClickNext = () => {\r\n    this.goToStep(this.state.step + 1)\r\n  }\r\n\r\n  onClickPrev = () => {\r\n    this.goToStep(this.state.step - 1)\r\n  }\r\n\r\n  goToStep = (step: number) => {\r\n    if (step == 3 && !this.isValidToStep3()) {\r\n      bootbox.alert(\r\n        'Debe ingresar el Valor según Auditoría de <u>TODAS</u> las operaciones de la muestra para continuar.'\r\n      )\r\n      return\r\n    }\r\n    this.setState({ step })\r\n  }\r\n\r\n  renderNavigation() {\r\n    const { step } = this.state\r\n    return (\r\n      <Fragment>\r\n        <nav className='nav-actions'>\r\n          {step > 1 && (\r\n            <button className='ui button primary left floated' onClick={this.onClickPrev}>\r\n              Anterior\r\n            </button>\r\n          )}\r\n          {step < 3 && (\r\n            <button className='ui button primary right floated' onClick={this.onClickNext}>\r\n              Siguiente\r\n            </button>\r\n          )}\r\n          <div className='clearfix' />\r\n        </nav>\r\n        {this.isClosed() &&\r\n        !this.isClosed() && (\r\n          <FormFichaTecnica isReadOnly id_muestreo={this.props.id} id_visita={this.props.id_visita} />\r\n        )}\r\n        {!this.props.editable && (\r\n          <div className='_a-center'>\r\n            <a\r\n              href={url_for2(\r\n                `proyecto/:id_proyecto/paso/${app.vars.idpaso}/visita/${this.props.id_visita}/muestreo/${this.props.id}`\r\n              )}\r\n              target='_blank'\r\n              className='btn btn-lg btn-edit'\r\n            >\r\n              Editar\r\n            </a>\r\n          </div>\r\n        )}\r\n      </Fragment>\r\n    )\r\n  }\r\n\r\n  renderProgressBar() {\r\n    const progress = _.size(_.filter(this.state.muestras, (muestra) => !isEmpty(muestra.r)))\r\n    const total = _.size(this.state.muestras)\r\n\r\n    return (\r\n      <div className='ui grid'>\r\n        <div className='column fifteen wide'>\r\n          <div className='ui tiny green progress' data-percent={num(Math.floor(100 * progress / total))}>\r\n            <div className='bar' style={{ width: `${Math.floor(100 * progress / total)}%` }}>\r\n              <div className='progress' />\r\n            </div>\r\n          </div>\r\n        </div>\r\n        <div className='column one wide' style={{ fontSize: 12, padding: 8 }}>\r\n          {progress} / {total}\r\n        </div>\r\n      </div>\r\n    )\r\n  }\r\n\r\n  renderStepContent() {\r\n    switch (this.state.step) {\r\n      case 1:\r\n        return this.renderStep1Content()\r\n      case 2:\r\n        return this.renderStep2Content()\r\n      case 3:\r\n        return this.renderStep3Content()\r\n    }\r\n  }\r\n\r\n  renderStep1Content() {\r\n    return (\r\n      <Fragment>\r\n        <div className='ui two column grid'>\r\n          <div className='column'>\r\n            <table className='ui table'>\r\n              <thead>\r\n                <tr>\r\n                  <th>Parámetros</th>\r\n                  <th>%</th>\r\n                </tr>\r\n              </thead>\r\n              <tbody>\r\n                <tr>\r\n                  <td>\r\n                    Error Tolerable\r\n                    <GenericTooltip text='@tooltip.muestreo.error_tolerable' title='Error Tolerable' wide />\r\n                  </td>\r\n                  <td>\r\n                    {this.isReadOnly() ? this.state.values.E == -1 ? (\r\n                      'Mat. Planeación'\r\n                    ) : (\r\n                      `${this.state.values.E}%`\r\n                    ) : (\r\n                      <select\r\n                        className='raw-select input-mini'\r\n                        value={this.state.values.E}\r\n                        onChange={this.onChangeSelect('E')}\r\n                      >\r\n                        <option value='-1'>Mat. Planeación</option>\r\n                        <option disabled>-</option>\r\n                        {_.map(_.range(3, 21), (v) => {\r\n                          return (\r\n                            <option key={v} value={v}>\r\n                              {v}%\r\n                            </option>\r\n                          )\r\n                        })}\r\n                      </select>\r\n                    )}\r\n                  </td>\r\n                </tr>\r\n                <tr>\r\n                  <td>\r\n                    Nivel de Confianza (z)\r\n                    <GenericTooltip text='@tooltip.muestreo.nivel_confianza' title='Nivel de Confianza' />\r\n                  </td>\r\n                  <td>\r\n                    {this.isReadOnly() ? (\r\n                      `${this.state.values.Z}%`\r\n                    ) : (\r\n                      <select\r\n                        className='raw-select input-mini'\r\n                        value={this.state.values.Z}\r\n                        onChange={this.onChangeSelect('Z')}\r\n                      >\r\n                        {_.map(_.range(50, 96), (v) => {\r\n                          return (\r\n                            <option key={v} value={`${v / 100}`}>\r\n                              {v}%\r\n                            </option>\r\n                          )\r\n                        })}\r\n                      </select>\r\n                    )}\r\n                  </td>\r\n                </tr>\r\n                <tr>\r\n                  <td>\r\n                    Error esperado (P)\r\n                    <GenericTooltip text='@tooltip.muestreo.error_esperado' title='Error esperado' />\r\n                  </td>\r\n                  <td>\r\n                    {this.isReadOnly() ? (\r\n                      `${this.state.values.P * 10}%`\r\n                    ) : (\r\n                      <select\r\n                        className='raw-select input-mini'\r\n                        value={this.state.values.P}\r\n                        onChange={this.onChangeSelect('P')}\r\n                      >\r\n                        {_.map(_.range(1, 10), (v) => {\r\n                          return (\r\n                            <option key={v} value={`0.${v}`}>\r\n                              {v}%\r\n                            </option>\r\n                          )\r\n                        })}\r\n                      </select>\r\n                    )}\r\n                  </td>\r\n                </tr>\r\n              </tbody>\r\n            </table>\r\n          </div>\r\n          <div className='column'>\r\n            <table className='ui table'>\r\n              <thead>\r\n                <tr>\r\n                  <th>Resultados</th>\r\n                  <th>Valor</th>\r\n                </tr>\r\n              </thead>\r\n              <tbody>\r\n                <tr>\r\n                  <td>Valor Contable de la Población</td>\r\n                  <td className='right aligned'>{accounting.formatNumber(this.props.data.M)}</td>\r\n                </tr>\r\n                <tr>\r\n                  <td>Tamaño de la Población</td>\r\n                  <td className='right aligned'>{accounting.formatNumber(this.props.data.N)}</td>\r\n                </tr>\r\n              </tbody>\r\n            </table>\r\n          </div>\r\n        </div>\r\n        <div className='b3'>\r\n          <span>\r\n            Tamaño de la Muestra (<em style={{ fontFamily: 'serif' }}>n</em>)<sup className='footnote'>[1]</sup>\r\n          </span>\r\n          <div className='math-equation'>\r\n            <table>\r\n              <tbody>\r\n                <tr>\r\n                  <td rowSpan={2}>&nbsp;</td>\r\n                  <td className='math-eq-var' style={{ fontSize: 11, borderBottom: '1px solid #333' }}>\r\n                    P * Q * z<sup>2</sup> * N{' '}\r\n                  </td>\r\n                  <td rowSpan={2}>&nbsp;</td>\r\n                </tr>\r\n                <tr>\r\n                  <td className='math-eq-var' style={{ fontSize: 11 }}>\r\n                    N * E<sup>2</sup> * z<sup>2</sup> * P * Q\r\n                  </td>\r\n                </tr>\r\n              </tbody>\r\n            </table>\r\n          </div>\r\n          <strong>{accounting.formatNumber(this.state.values.cf_1)} elementos</strong>\r\n        </div>\r\n        <div className='footnotes'>[1] {getvalue(app.vars.texts, 'tooltip.muestreo.footnote_tamanomuestra_mas')}</div>\r\n        {this.renderNavigation()}\r\n      </Fragment>\r\n    )\r\n  }\r\n\r\n  renderStep2Content() {\r\n    return (\r\n      <Fragment>\r\n        {this.renderProgressBar()}\r\n        <div>\r\n          <TableMuestras muestras={this.state.muestras} readonly={this.isReadOnly()} onChange={this.onChangeMuestra} />\r\n        </div>\r\n        {this.renderNavigation()}\r\n      </Fragment>\r\n    )\r\n  }\r\n\r\n  renderStep3Content() {\r\n    const num = (num: any) => (isNaN(parseFloat(num)) ? 0 : parseFloat(num))\r\n    const sumV = _.reduce(this.state.muestras, (acc: number, curr) => acc + num(curr.v), 0)\r\n    const sumR = _.reduce(this.state.muestras, (acc: number, curr) => acc + num(curr.r), 0)\r\n\r\n    return (\r\n      <Fragment>\r\n        <div>\r\n          <table className='ui table'>\r\n            <thead>\r\n              <tr>\r\n                <th>Resultados</th>\r\n                <th>Valor</th>\r\n              </tr>\r\n            </thead>\r\n            <tbody>\r\n              <tr>\r\n                <td>\r\n                  <div\r\n                    style={{\r\n                      display: 'inline-block',\r\n                      verticalAlign: 'top',\r\n                      marginTop: 10\r\n                    }}\r\n                  >\r\n                    Tamaño de la muestra\r\n                  </div>\r\n                  <div className='math-equation'>\r\n                    <table>\r\n                      <tbody>\r\n                        <tr>\r\n                          <td rowSpan={2}>&nbsp;</td>\r\n                          <td className='math-eq-var' style={{ fontSize: 11, borderBottom: '1px solid #333' }}>\r\n                            P * Q * z<sup>2</sup> * N{' '}\r\n                          </td>\r\n                          <td rowSpan={2}>&nbsp;</td>\r\n                        </tr>\r\n                        <tr>\r\n                          <td className='math-eq-var' style={{ fontSize: 11 }}>\r\n                            N * E<sup>2</sup> * z<sup>2</sup> * P * Q\r\n                          </td>\r\n                        </tr>\r\n                      </tbody>\r\n                    </table>\r\n                  </div>\r\n                </td>\r\n                <td className='right aligned'>{accounting.formatNumber(this.state.values.cf_1)}</td>\r\n              </tr>\r\n\r\n              <tr>\r\n                <td>Valor error tolerable</td>\r\n                <td className='right aligned'>\r\n                  {accounting.formatNumber(this.props.data.M * this.getErrorTolerable(this.state.values.E) / 100)}\r\n                </td>\r\n              </tr>\r\n\r\n              <tr>\r\n                <td>Valor contable de la muestra</td>\r\n                <td className='right aligned'>{accounting.formatNumber(sumV)}</td>\r\n              </tr>\r\n\r\n              <tr>\r\n                <td>Valor errores encontrados por el auditor</td>\r\n                <td className='right aligned'>{accounting.formatNumber(sumV - sumR)}</td>\r\n              </tr>\r\n            </tbody>\r\n          </table>\r\n\r\n          <table className='ui table'>\r\n            <thead>\r\n              <tr>\r\n                <th colSpan={2}>\r\n                  Proyección de error <em>No aplica para pruebas de controles</em>\r\n                </th>\r\n              </tr>\r\n            </thead>\r\n            <tbody>\r\n              <tr>\r\n                <td>Proyección de los errores en la población</td>\r\n                <td className='right aligned'>{accounting.formatNumber(this.state.values.pry_1)}</td>\r\n              </tr>\r\n\r\n              <tr>\r\n                <td>Índice de error proyectado</td>\r\n                <td className='right aligned'>{accounting.formatNumber(this.state.values.pry_2)}%</td>\r\n              </tr>\r\n\r\n              <tr>\r\n                <td>\r\n                  Error proyectado es <u>superior</u> al Error tolerable\r\n                </td>\r\n                <td className={cx('right aligned', 'rs-' + this.state.values.pry_3)}>{this.state.values.pry_3}</td>\r\n              </tr>\r\n            </tbody>\r\n          </table>\r\n\r\n          <div className='ui segment'>\r\n            <EditorPreview\r\n              editable={!this.isReadOnly()}\r\n              label='Conclusión:'\r\n              prefixPreview='Conclusión:'\r\n              data={this.state.values.conclusion_custom_mas}\r\n              ckeditorOptions='basic'\r\n              onSave={this.onSaveConclusion}\r\n            />\r\n          </div>\r\n        </div>\r\n        {this.renderNavigation()}\r\n\r\n        {!this.isClosed() && (\r\n          <FormFichaTecnica isReadOnly={false} id_muestreo={this.props.id} id_visita={this.props.id_visita} />\r\n        )}\r\n        {!this.props.editable &&\r\n        !this.isClosed() && (\r\n          <div className='_a-center'>\r\n            <a\r\n              href={url_for2(\r\n                `proyecto/:id_proyecto/paso/${app.vars.idpaso}/visita/${this.props.id_visita}/muestreo/${this.props.id}`\r\n              )}\r\n              target='_blank'\r\n              className='btn btn-lg btn-edit'\r\n            >\r\n              Editar\r\n            </a>\r\n          </div>\r\n        )}\r\n      </Fragment>\r\n    )\r\n  }\r\n\r\n  render() {\r\n    const { step } = this.state\r\n\r\n    return (\r\n      <div id='mainpane-mas'>\r\n        {this.isClosed() && (\r\n          <div className='alert alert-block alert-info'>\r\n            <span className='icon-info-sign' /> <strong>NOTA:</strong> La ficha técnica perteneciente a este muestreo ya\r\n            fue generada, por lo tanto los parámetros y registros de esta muestra utilizando esta metodología\r\n            <strong> NO</strong> pueden ser modificados.\r\n          </div>\r\n        )}\r\n        <div className='ui top attached steps ordered'>\r\n          <div\r\n            className={cx({ active: step == 1, completed: step > 1 }, 'step link first')}\r\n            onClick={() => this.goToStep(1)}\r\n          >\r\n            <div className='content'>\r\n              <div className='title'>Cálculo del Tamaño de la Muestra</div>\r\n            </div>\r\n          </div>\r\n          <div\r\n            className={cx({ active: step == 2, completed: step > 2 }, 'step link ')}\r\n            onClick={() => this.goToStep(2)}\r\n          >\r\n            <div className='content'>\r\n              <div className='title'>Muestra y Evaluación de Resultados</div>\r\n            </div>\r\n          </div>\r\n          <div\r\n            className={cx({ active: step == 3, completed: step > 3 }, 'step link last')}\r\n            onClick={() => this.goToStep(3)}\r\n          >\r\n            <div className='content'>\r\n              <div className='title'>Conclusión</div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n        <div className='ui segment attached'>\r\n          <div>{this.renderStepContent()}</div>\r\n        </div>\r\n      </div>\r\n    )\r\n  }\r\n}\r\n","import { PureComponent, SyntheticEvent, Fragment } from 'react'\r\n\r\nimport cx from 'classnames'\r\nimport getvalue from 'get-value'\r\nimport { GenericTooltip } from '../global/Tooltip'\r\nimport { calculateFactorConfianza, calculateTamanoMuestra, generarMuestras, calculatePrecision } from './utils_mum'\r\nimport { isEmpty, cacheMuestra, getCacheAllMuestra } from './utis'\r\nimport EditorPreview from '../global/EditorPreview'\r\nimport { TableMuestras, TableErrores, ConclusionTooltip, FormFichaTecnica } from './TableMuestra'\r\n\r\ndeclare var app: any\r\n\r\ntype AppMuestreoMumProps = {\r\n  id: string\r\n  id_visita: string\r\n  data: any\r\n  editable: boolean\r\n}\r\n\r\ntype AppMuestreoMumStateValueType = {\r\n  /** Nivel confianza */\r\n  Z2: number\r\n  /** Porcentaje Error Máximo Tolerable */\r\n  E2: number\r\n  /**Error maximo tolerable */\r\n  e2__v2: number\r\n  total_error_proyectado: number\r\n  tolerancia: number\r\n  /** Factor confianza */\r\n  cg2_1: number\r\n  /** Tamaño de la muestra */\r\n  cg2_3: number\r\n  /** Intervalo */\r\n  cg2_4: number\r\n  conclusion_custom: string\r\n}\r\n\r\ntype AppMuestreoMumState = {\r\n  step: number\r\n  values: AppMuestreoMumStateValueType\r\n  muestras: MuestraItem[]\r\n}\r\n\r\nfunction num(string: string | number) {\r\n  const value = parseFloat('' + string)\r\n\r\n  return isNaN(value) ? 0 : value\r\n}\r\n\r\nexport default class AppMuestreoMum extends PureComponent<AppMuestreoMumProps, AppMuestreoMumState> {\r\n  private handlers: { [s: string]: any } = {}\r\n\r\n  private hasModified: boolean = false\r\n\r\n  constructor(props: AppMuestreoMumProps) {\r\n    super(props)\r\n\r\n    const muestras = getvalue(props.data, 'muestras.mum', null)\r\n\r\n    const Z2 = isEmpty(props.data.Z2) ? 90 : num(props.data.Z2)\r\n    const E2 = isEmpty(props.data.E2) ? (muestras === null ? -1 : 5) : num(props.data.E2)\r\n\r\n    const error_maximo =\r\n      isEmpty(props.data.e2__v2) && this.props.editable ? props.data.M * E2 / 100 : num(props.data.e2__v2)\r\n    const factor_confianza =\r\n      isEmpty(props.data.cg2_1) && this.props.editable ? calculateFactorConfianza(Z2) : num(props.data.cg2_1)\r\n    const tamano_muestra =\r\n      isEmpty(props.data.cg2_3) && this.props.editable\r\n        ? calculateTamanoMuestra(this.props.data.M, factor_confianza, error_maximo)\r\n        : num(props.data.cg2_3)\r\n    const intervalo =\r\n      isEmpty(props.data.cg2_4) && this.props.editable\r\n        ? Math.floor(this.props.data.M / tamano_muestra)\r\n        : num(props.data.cg2_4)\r\n\r\n    this.state = {\r\n      step: 1,\r\n      values: {\r\n        Z2,\r\n        E2,\r\n        e2__v2: error_maximo,\r\n        total_error_proyectado: props.data.total_error_proyectado,\r\n        tolerancia: props.data.tolerancia,\r\n        cg2_1: factor_confianza,\r\n        cg2_3: tamano_muestra,\r\n        cg2_4: intervalo,\r\n        conclusion_custom: props.data.conclusion_custom || ''\r\n      },\r\n      muestras:\r\n        muestras == null && this.props.editable\r\n          ? this.generarMuestras(tamano_muestra, intervalo)\r\n          : _.map(muestras, (muestra: MuestraItem) => {\r\n              if (!isEmpty(muestra.r)) {\r\n                muestra.r = num(muestra.r + '')\r\n              }\r\n              return muestra\r\n            })\r\n    }\r\n\r\n    if (muestras != null) {\r\n      _.forEach(muestras, (muestra) => cacheMuestra(muestra))\r\n    } else if (this.props.editable) {\r\n      $.blockUI(create_blockUI_loading_message('Guardando cambios'))\r\n\r\n      this.sendToServer({\r\n        type: 'mum',\r\n        muestras: this.state.muestras,\r\n        fields: _.omit(this.state.values, [ 'conclusion_custom' ])\r\n      }).done(() => {\r\n        $.unblockUI()\r\n      })\r\n    }\r\n  }\r\n\r\n  isClosed() {\r\n    return !!this.props.data.ficha_tecnica_mum_date\r\n  }\r\n\r\n  isReadOnly() {\r\n    return !this.props.editable || !!this.props.data.ficha_tecnica_mum_date\r\n  }\r\n\r\n  attachHandler(field: string, handler: any) {\r\n    if (!this.handlers[field]) {\r\n      this.handlers[field] = handler\r\n    }\r\n\r\n    return this.handlers[field]\r\n  }\r\n\r\n  generarMuestras(tamano_muestra: number, intervalo: number) {\r\n    const muestras = generarMuestras(app.vars.muestras, tamano_muestra, intervalo)\r\n    const cache = getCacheAllMuestra()\r\n    _.forEach(muestras, (muestra, k) => {\r\n      if (typeof cache[muestra.cod] != 'undefined') {\r\n        muestras[k].r = cache[muestra.cod]\r\n      }\r\n    })\r\n\r\n    return muestras\r\n  }\r\n\r\n  isValidToStep3() {\r\n    return _.all(this.state.muestras, (muestra) => muestra.r != null)\r\n  }\r\n\r\n  sendToServer(params: any) {\r\n    if (this.isReadOnly()) {\r\n      return\r\n    }\r\n\r\n    params.t = 'mum'\r\n    if (typeof params.fields !== 'undefined') {\r\n      params.fields = _.map(params.fields, (value, key) => {\r\n        return { field: key, value }\r\n      })\r\n    }\r\n    return $.post(url_for(`proyecto_muestreo/${app.vars.ID_MUESTREO}/config`), params)\r\n  }\r\n\r\n  onChangeSelect = (field: string) => {\r\n    return this.attachHandler(field, (ev: SyntheticEvent) => {\r\n      const value = (ev.target as any).value\r\n      this.setState((prevState) => {\r\n        const newValues: AppMuestreoMumStateValueType = Object.assign({}, prevState.values, {\r\n          [field]: parseInt(value)\r\n        })\r\n\r\n        const materialidad = parseFloat(getvalue(app, 'vars.muestreo.materialidad.total_planeacion', 0))\r\n        newValues.e2__v2 =\r\n          newValues.E2 == -1\r\n            ? this.props.data.M * (100 * materialidad / this.props.data.M) / 100\r\n            : this.props.data.M * newValues.E2 / 100\r\n        newValues.cg2_1 = calculateFactorConfianza(newValues.Z2)\r\n        newValues.cg2_3 = calculateTamanoMuestra(this.props.data.M, newValues.cg2_1, newValues.e2__v2)\r\n        newValues.cg2_4 = Math.floor(this.props.data.M / newValues.cg2_3)\r\n\r\n        const muestras = this.generarMuestras(newValues.cg2_3, newValues.cg2_4)\r\n\r\n        this.sendToServer({ muestras, fields: _.omit(newValues, [ 'conclusion_custom' ]) })\r\n\r\n        return { values: newValues, muestras }\r\n      })\r\n    })\r\n  }\r\n\r\n  onChangeMuestra = (muestra: MuestraItem, persist: boolean) => {\r\n    if (this.isReadOnly()) {\r\n      return\r\n    }\r\n\r\n    this.setState((prevState) => {\r\n      if (!this.hasModified) {\r\n        const prevValue = _.find(prevState.muestras, { cod: muestra.cod })\r\n        if (!_.isEqual(prevValue, muestra)) {\r\n          this.hasModified = true\r\n        }\r\n      }\r\n\r\n      const muestras = _.map(prevState.muestras, (_muestra) => {\r\n        return muestra.cod == _muestra.cod ? muestra : _muestra\r\n      })\r\n\r\n      if (!persist) {\r\n        return { muestras, values: prevState.values }\r\n      }\r\n\r\n      const values = { ...prevState.values }\r\n\r\n      const muestrasErradas = _.filter(muestras, (muestra) => !isEmpty(muestra.r) && muestra.v - muestra.r != 0)\r\n\r\n      values.total_error_proyectado = _.reduce(\r\n        muestrasErradas,\r\n        (acc: number, muestra) => {\r\n          const error_proyectado =\r\n            muestra.v > values.cg2_4 ? muestra.v - muestra.r : values.cg2_4 * ((muestra.v - muestra.r) / muestra.v)\r\n\r\n          return error_proyectado + acc\r\n        },\r\n        0\r\n      )\r\n\r\n      values.tolerancia = calculatePrecision(muestras, values.cg2_4, values.cg2_1, values.Z2)\r\n\r\n      if (this.hasModified) {\r\n        this.sendToServer({ muestras, fields: _.omit(values, [ 'conclusion_custom' ]) })\r\n        this.hasModified = false\r\n      }\r\n\r\n      return { muestras, values }\r\n    })\r\n    cacheMuestra(muestra)\r\n  }\r\n\r\n  onSaveConclusion = (editor: CKEDITOR.editor) => {\r\n    if (this.isReadOnly()) {\r\n      return\r\n    }\r\n\r\n    this.setState((prevState) => {\r\n      const values = { ...prevState.values }\r\n      values.conclusion_custom = editor.getData()\r\n\r\n      this.sendToServer({ fields: { conclusion_custom: values.conclusion_custom } })\r\n\r\n      return { values }\r\n    })\r\n  }\r\n\r\n  onClickNext = () => {\r\n    this.goToStep(this.state.step + 1)\r\n  }\r\n\r\n  onClickPrev = () => {\r\n    this.goToStep(this.state.step - 1)\r\n  }\r\n\r\n  goToStep = (step: number) => {\r\n    if (step == 3 && !this.isValidToStep3()) {\r\n      bootbox.alert(\r\n        'Debe ingresar el Valor según Auditoría de <u>TODAS</u> las operaciones de la muestra para continuar.'\r\n      )\r\n      return\r\n    }\r\n    this.setState({ step })\r\n  }\r\n\r\n  renderNavigation() {\r\n    const { step } = this.state\r\n    return (\r\n      <Fragment>\r\n        <nav className='nav-actions'>\r\n          {step > 1 && (\r\n            <button className='ui button primary left floated' onClick={this.onClickPrev}>\r\n              Anterior\r\n            </button>\r\n          )}\r\n          {step < 3 && (\r\n            <button className='ui button primary right floated' onClick={this.onClickNext}>\r\n              Siguiente\r\n            </button>\r\n          )}\r\n          <div className='clearfix' />\r\n        </nav>\r\n        {this.isClosed() && (\r\n          <FormFichaTecnica isReadOnly id_muestreo={this.props.id} id_visita={this.props.id_visita} />\r\n        )}\r\n        {!this.props.editable &&\r\n        !this.isClosed() && (\r\n          <div className='_a-center'>\r\n            <a\r\n              href={url_for2(\r\n                `proyecto/:id_proyecto/paso/${app.vars.idpaso}/visita/${this.props.id_visita}/muestreo/${this.props.id}`\r\n              )}\r\n              target='_blank'\r\n              className='btn btn-lg btn-edit'\r\n            >\r\n              Editar\r\n            </a>\r\n          </div>\r\n        )}\r\n      </Fragment>\r\n    )\r\n  }\r\n\r\n  renderProgressBar() {\r\n    const progress = _.size(_.filter(this.state.muestras, (muestra) => !isEmpty(muestra.r)))\r\n    const total = _.size(this.state.muestras)\r\n\r\n    return (\r\n      <div className='ui grid'>\r\n        <div className='column fifteen wide'>\r\n          <div className='ui tiny green progress' data-percent={num(Math.floor(100 * progress / total))}>\r\n            <div className='bar' style={{ width: `${Math.floor(100 * progress / total)}%` }}>\r\n              <div className='progress' />\r\n            </div>\r\n          </div>\r\n        </div>\r\n        <div className='column one wide' style={{ fontSize: 12, padding: 8 }}>\r\n          {progress} / {total}\r\n        </div>\r\n      </div>\r\n    )\r\n  }\r\n\r\n  renderStepContent() {\r\n    switch (this.state.step) {\r\n      case 1:\r\n        return this.renderStep1Content()\r\n      case 2:\r\n        return this.renderStep2Content()\r\n      case 3:\r\n        return this.renderStep3Content()\r\n    }\r\n  }\r\n\r\n  renderStep1Content() {\r\n    return (\r\n      <Fragment>\r\n        <div className='ui two column grid'>\r\n          <div className='column'>\r\n            <table className='ui table'>\r\n              <thead>\r\n                <tr>\r\n                  <th>Parámetros</th>\r\n                  <th>%</th>\r\n                  <th>Valor</th>\r\n                </tr>\r\n              </thead>\r\n              <tbody>\r\n                <tr>\r\n                  <td>\r\n                    Nivel de Confianza\r\n                    <GenericTooltip text='@tooltip.muestreo.nivel_confianza' title='Nivel de Confianza' />\r\n                  </td>\r\n                  <td>\r\n                    {this.isReadOnly() ? (\r\n                      `${this.state.values.Z2}%`\r\n                    ) : (\r\n                      <select\r\n                        className='raw-select input-mini'\r\n                        value={this.state.values.Z2}\r\n                        onChange={this.onChangeSelect('Z2')}\r\n                      >\r\n                        {_.map(_.range(50, 96), (v) => {\r\n                          return (\r\n                            <option key={v} value={v}>\r\n                              {v}%\r\n                            </option>\r\n                          )\r\n                        })}\r\n                      </select>\r\n                    )}\r\n                  </td>\r\n                  <td className='right aligned'>{100 - this.state.values.Z2}</td>\r\n                </tr>\r\n                <tr>\r\n                  <td>\r\n                    Error Máximo Tolerable\r\n                    <GenericTooltip\r\n                      text='@tooltip.muestreo.error_maximo_tolerable'\r\n                      title='Error Máximo Tolerable'\r\n                      wide\r\n                    />\r\n                  </td>\r\n                  <td>\r\n                    {this.isReadOnly() ? this.state.values.E2 == -1 ? (\r\n                      'Mat. Planeación'\r\n                    ) : (\r\n                      `${this.state.values.E2}%`\r\n                    ) : (\r\n                      <select\r\n                        className={cx('raw-select input-mini', 'e2-' + this.state.values.E2)}\r\n                        value={this.state.values.E2}\r\n                        onChange={this.onChangeSelect('E2')}\r\n                      >\r\n                        <option value='-1'>Mat. Planeación</option>\r\n                        <option disabled>-</option>\r\n                        {_.map(_.range(1, 11), (v) => {\r\n                          return (\r\n                            <option key={v} value={v}>\r\n                              {v}%\r\n                            </option>\r\n                          )\r\n                        })}\r\n                      </select>\r\n                    )}\r\n                  </td>\r\n                  <td className='right aligned'>{accounting.formatNumber(this.state.values.e2__v2)}</td>\r\n                </tr>\r\n              </tbody>\r\n            </table>\r\n          </div>\r\n          <div className='column'>\r\n            <table className='ui table'>\r\n              <thead>\r\n                <tr>\r\n                  <th>Resultados</th>\r\n                  <th>Valor</th>\r\n                </tr>\r\n              </thead>\r\n              <tbody>\r\n                <tr>\r\n                  <td>Tamaño de la Población</td>\r\n                  <td className='right aligned'>{accounting.formatNumber(this.props.data.N)}</td>\r\n                </tr>\r\n                <tr>\r\n                  <td>Valor Contable de la Población</td>\r\n                  <td className='right aligned'>{accounting.formatNumber(this.props.data.M)}</td>\r\n                </tr>\r\n                <tr>\r\n                  <td>Factor de Confianza</td>\r\n                  <td className='right aligned'>{accounting.formatNumber(this.state.values.cg2_1, 2)}</td>\r\n                </tr>\r\n                <tr>\r\n                  <td>\r\n                    <span style={{ display: 'inline-block', verticalAlign: 'top' }}>\r\n                      Intervalo de Muestreo\r\n                      <GenericTooltip text='@tooltip.muestreo.intervalo' title='Intervalo de Muestreo' />\r\n                    </span>\r\n                    <div className='math-equation'>\r\n                      <table>\r\n                        <tbody>\r\n                          <tr>\r\n                            <td className='math-eq-var' style={{ fontSize: 9, borderBottom: '1px solid #333' }}>\r\n                              Valor contable de la poblacion\r\n                            </td>\r\n                          </tr>\r\n                          <tr>\r\n                            <td className='math-eq-var' style={{ fontSize: 9 }}>\r\n                              Tamaño de la muestra\r\n                            </td>\r\n                          </tr>\r\n                        </tbody>\r\n                      </table>\r\n                    </div>\r\n                  </td>\r\n                  <td className='right aligned'>{accounting.formatNumber(this.state.values.cg2_4)}</td>\r\n                </tr>\r\n              </tbody>\r\n            </table>\r\n          </div>\r\n        </div>\r\n        <div className='b3'>\r\n          <span>\r\n            Tamaño de la Muestra (<em style={{ fontFamily: 'serif' }}>n</em>)<sup className='footnote'>[1]</sup>\r\n          </span>\r\n          <div className='math-equation'>\r\n            <table>\r\n              <tbody>\r\n                <tr>\r\n                  <td className='math-eq-var' rowSpan={2} style={{ fontSize: 9 }}>\r\n                    n =\r\n                  </td>\r\n                  <td className='math-eq-var' style={{ fontSize: 11, borderBottom: '1px solid #333' }}>\r\n                    Factor de confianza\r\n                  </td>\r\n                </tr>\r\n                <tr>\r\n                  <td className='math-eq-var' style={{ fontSize: 11 }}>\r\n                    Error tolerable (en porcentaje)\r\n                  </td>\r\n                </tr>\r\n              </tbody>\r\n            </table>\r\n          </div>\r\n          <strong>{accounting.formatNumber(this.state.values.cg2_3)} elementos</strong>\r\n        </div>\r\n        <div className='footnotes'>[1] {getvalue(app.vars.texts, 'tooltip.muestreo.footnote_tamanomuestra_mum')}</div>\r\n        {this.renderNavigation()}\r\n      </Fragment>\r\n    )\r\n  }\r\n\r\n  renderStep2Content() {\r\n    return (\r\n      <Fragment>\r\n        {this.renderProgressBar()}\r\n        <div>\r\n          <TableMuestras muestras={this.state.muestras} readonly={this.isReadOnly()} onChange={this.onChangeMuestra} />\r\n        </div>\r\n        {this.renderNavigation()}\r\n      </Fragment>\r\n    )\r\n  }\r\n\r\n  renderStep3Content() {\r\n    const muestrasErradas = _.filter(\r\n      this.state.muestras,\r\n      (muestra) => !isEmpty(muestra.r) && muestra.v - muestra.r != 0\r\n    )\r\n\r\n    const total_error_proyectado = this.state.values.total_error_proyectado\r\n    const precision = this.state.values.tolerancia\r\n\r\n    return (\r\n      <Fragment>\r\n        <div>\r\n          <TableErrores muestras={muestrasErradas} intervalo={this.state.values.cg2_4} />\r\n          <table className='ui table'>\r\n            <thead>\r\n              <tr>\r\n                <th>Resultados</th>\r\n                <th>Valor</th>\r\n              </tr>\r\n            </thead>\r\n            <tbody>\r\n              <tr>\r\n                <td>a) Error proyectado</td>\r\n                <td className='right aligned'>{accounting.formatNumber(Math.abs(total_error_proyectado))}</td>\r\n              </tr>\r\n              <tr>\r\n                <td>\r\n                  b) Precisión\r\n                  <GenericTooltip text='@tooltip.muestreo.precision' title='Precision' />\r\n                </td>\r\n                <td className='right aligned'>{accounting.formatNumber(Math.abs(precision))}</td>\r\n              </tr>\r\n              <tr className='strong'>\r\n                <td>c) Límite superior del error (a+b)</td>\r\n                <td className='right aligned'>\r\n                  {accounting.formatNumber(\r\n                    Math.abs(parseFloat(total_error_proyectado + '')) + Math.abs(parseFloat(precision + ''))\r\n                  )}\r\n                </td>\r\n              </tr>\r\n              <tr className='strong'>\r\n                <td>d) Error máximo tolerable</td>\r\n                <td className='right aligned'>{accounting.formatNumber(this.state.values.e2__v2)}</td>\r\n              </tr>\r\n            </tbody>\r\n          </table>\r\n          <div className='ui segment'>\r\n            <EditorPreview\r\n              editable={!this.isReadOnly()}\r\n              label='Conclusión:'\r\n              prefixPreview='Conclusión:'\r\n              data={this.state.values.conclusion_custom}\r\n              ckeditorOptions='basic'\r\n              onSave={this.onSaveConclusion}\r\n            />\r\n            <ConclusionTooltip />\r\n          </div>\r\n        </div>\r\n        {this.renderNavigation()}\r\n        {!this.isClosed() && (\r\n          <FormFichaTecnica isReadOnly={false} id_muestreo={this.props.id} id_visita={this.props.id_visita} />\r\n        )}\r\n        {!this.props.editable &&\r\n        !this.isClosed() && (\r\n          <div className='_a-center'>\r\n            <a\r\n              href={url_for2(\r\n                `proyecto/:id_proyecto/paso/${app.vars.idpaso}/visita/${this.props.id_visita}/muestreo/${this.props.id}`\r\n              )}\r\n              target='_blank'\r\n              className='btn btn-lg btn-edit'\r\n            >\r\n              Editar\r\n            </a>\r\n          </div>\r\n        )}\r\n      </Fragment>\r\n    )\r\n  }\r\n\r\n  render() {\r\n    const { step } = this.state\r\n\r\n    return (\r\n      <div id='mainpane-mum'>\r\n        {this.isClosed() && (\r\n          <div className='alert alert-block alert-info'>\r\n            <span className='icon-info-sign' /> <strong>NOTA:</strong> La ficha técnica perteneciente a este muestreo ya\r\n            fue generada, por lo tanto los parámetros y registros de esta muestra utilizando esta metodología\r\n            <strong> NO</strong> pueden ser modificados.\r\n          </div>\r\n        )}\r\n        <div className='ui top attached steps ordered'>\r\n          <div\r\n            className={cx({ active: step == 1, completed: step > 1 }, 'step link first')}\r\n            onClick={() => this.goToStep(1)}\r\n          >\r\n            <div className='content'>\r\n              <div className='title'>Cálculo del Tamaño de la Muestra</div>\r\n            </div>\r\n          </div>\r\n          <div\r\n            className={cx({ active: step == 2, completed: step > 2 }, 'step link ')}\r\n            onClick={() => this.goToStep(2)}\r\n          >\r\n            <div className='content'>\r\n              <div className='title'>Muestra y Evaluación de Resultados</div>\r\n            </div>\r\n          </div>\r\n          <div\r\n            className={cx({ active: step == 3, completed: step > 3 }, 'step link last')}\r\n            onClick={() => this.goToStep(3)}\r\n          >\r\n            <div className='content'>\r\n              <div className='title'>Conclusión</div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n        <div className='ui segment attached'>\r\n          <div>{this.renderStepContent()}</div>\r\n        </div>\r\n      </div>\r\n    )\r\n  }\r\n}\r\n","import { PureComponent, createRef, SyntheticEvent, useState } from 'react'\r\nimport getvalue from 'get-value'\r\nimport cx from 'classnames'\r\nimport InputAutoNumeric from '../global/InputAutoNumeric'\r\nimport { isEmpty } from './utis'\r\n\r\ndeclare var app: any\r\n\r\ntype TableMuestrasProps = {\r\n  muestras: MuestraItem[]\r\n  onChange: (muestra: MuestraItem, persist: boolean) => void\r\n  readonly: boolean\r\n}\r\n\r\nexport class TableMuestras extends PureComponent<TableMuestrasProps> {\r\n  tableRef = createRef<HTMLTableElement>()\r\n  renderTotals() {\r\n    const num = (num: any) => (isNaN(parseFloat(num)) ? 0 : parseFloat(num))\r\n    const sumV = _.reduce(this.props.muestras, (acc: number, curr) => acc + num(curr.v), 0)\r\n    const sumR = _.reduce(this.props.muestras, (acc: number, curr) => acc + num(curr.r), 0)\r\n    const sumD = _.reduce(this.props.muestras, (acc: number, curr) => acc + num(curr.v - curr.r), 0)\r\n\r\n    return (\r\n      <tfoot>\r\n        <tr>\r\n          <td colSpan={2}>TOTALES</td>\r\n          <td className='right aligned'>{accounting.formatNumber(sumV)}</td>\r\n          <td className='right aligned'>{sumR != 0 ? accounting.formatNumber(sumR) : ''}</td>\r\n          <td className='right aligned'>{sumD != 0 ? accounting.formatNumber(sumD) : ''}</td>\r\n          <td className='right aligned'>{accounting.formatNumber(Math.floor(100 * sumD / sumV))}%</td>\r\n        </tr>\r\n      </tfoot>\r\n    )\r\n  }\r\n\r\n  componentDidMount() {\r\n    $(this.tableRef.current).floatThead()\r\n  }\r\n\r\n  componentWillUnmount() {\r\n    $(this.tableRef.current).floatThead('destroy')\r\n  }\r\n\r\n  componentDidUpdate() {\r\n    const $table = $(this.tableRef.current)\r\n\r\n    setTimeout(function() {\r\n      $table.floatThead('reflow')\r\n    }, 1000)\r\n  }\r\n\r\n  render() {\r\n    return (\r\n      <table ref={this.tableRef} className='ui celled table compact table-muestras' id='table-muestreo-mum-evaluacion'>\r\n        <thead>\r\n          <tr>\r\n            <th>#</th>\r\n            <th>Documento</th>\r\n            <th>Valor en libros ($)</th>\r\n            <th>Valor según auditoría ($)</th>\r\n            <th>Valor Error Absoluto ($)</th>\r\n            <th>Error Porcentual (%)</th>\r\n          </tr>\r\n        </thead>\r\n        <tbody>\r\n          {_.map(this.props.muestras, (muestra, k) => {\r\n            return (\r\n              <TableMuestraRow\r\n                key={muestra.cod}\r\n                index={k + 1}\r\n                muestra={muestra}\r\n                readonly={this.props.readonly}\r\n                onChange={this.props.onChange}\r\n              />\r\n            )\r\n          })}\r\n        </tbody>\r\n        {this.renderTotals()}\r\n      </table>\r\n    )\r\n  }\r\n}\r\n\r\ntype TableMuestraRowProps = {\r\n  muestra: MuestraItem\r\n  index: number\r\n  onChange: (muestra: MuestraItem, persist: boolean) => void\r\n  readonly: boolean\r\n}\r\n\r\nclass TableMuestraRow extends PureComponent<TableMuestraRowProps, { value: number }> {\r\n  constructor(props: TableMuestraRowProps) {\r\n    super(props)\r\n    this.state = {\r\n      value: props.muestra.r\r\n    }\r\n  }\r\n\r\n  onChange = (ev: SyntheticEvent, value: number) => {\r\n    if ((ev.target as any).value === '') {\r\n      value = null\r\n    }\r\n\r\n    this.setState({ value })\r\n\r\n    this.props.onChange(Object.assign({}, this.props.muestra, { r: value }), false)\r\n  }\r\n\r\n  onBlur = (ev: SyntheticEvent, value: number) => {\r\n    if ((ev.target as any).value === '') {\r\n      value = null\r\n    }\r\n\r\n    this.setState({ value })\r\n\r\n    this.props.onChange(Object.assign({}, this.props.muestra, { r: value }), true)\r\n  }\r\n\r\n  renderDiffPercent() {\r\n    const { muestra } = this.props\r\n    const valor_diff: number = muestra.v - this.state.value\r\n    const retval = 100 * valor_diff / muestra.v\r\n\r\n    return parseInt(retval + '') === 0 ? 0 : accounting.formatNumber(retval)\r\n  }\r\n\r\n  render() {\r\n    const { muestra } = this.props\r\n\r\n    return (\r\n      <tr key={muestra.cod}>\r\n        <td>{this.props.index}</td>\r\n        <td>{muestra.cod}</td>\r\n        <td className='right aligned'>{accounting.formatNumber(muestra.v)}</td>\r\n        <td className='right aligned'>\r\n          <InputAutoNumeric\r\n            isEditable={!this.props.readonly}\r\n            value={this.state.value}\r\n            onChange={this.onChange}\r\n            onDrop={this.onChange}\r\n            onBlur={this.onBlur}\r\n          />\r\n        </td>\r\n        <td className='right aligned'>\r\n          {isEmpty(this.state.value) ? '' : accounting.formatNumber(muestra.v - this.state.value)}\r\n        </td>\r\n        <td className='right aligned'>{isEmpty(this.state.value) ? '' : this.renderDiffPercent() + '%'}</td>\r\n      </tr>\r\n    )\r\n  }\r\n}\r\n\r\ntype TableErroresProps = {\r\n  muestras: MuestraItem[]\r\n  intervalo: number\r\n}\r\n\r\nexport const TableErrores = (props: TableErroresProps) => {\r\n  if (!_.size(props.muestras)) {\r\n    return (\r\n      <div className='ui message success icon'>\r\n        <i className='icon large checkmark' />\r\n        <div className='content'>\r\n          <div className='header'>0 partidas con errores</div>\r\n          <p>No se hallaron partidas con error según auditoría.</p>\r\n        </div>\r\n      </div>\r\n    )\r\n  } else {\r\n    let total_error_proyectado = 0\r\n    return (\r\n      <table className='ui table compact celled' id='table-mum-muestraserradas'>\r\n        <caption>Partidas que contienen error según auditoría</caption>\r\n        <thead>\r\n          <tr>\r\n            <th>Cód.</th>\r\n            <th>Valor en libros ($)</th>\r\n            <th>Valor en auditoría ($)</th>\r\n            <th>Error ($)</th>\r\n            <th>Índice de Error (%)</th>\r\n            <th>Error proyectado al intervalo</th>\r\n          </tr>\r\n        </thead>\r\n        <tbody>\r\n          {_.map(props.muestras, (muestra) => {\r\n            const error_proyectado =\r\n              muestra.v > props.intervalo\r\n                ? muestra.v - muestra.r\r\n                : props.intervalo * ((muestra.v - muestra.r) / muestra.v)\r\n\r\n            total_error_proyectado += error_proyectado\r\n\r\n            return (\r\n              <tr key={muestra.cod} className={cx({ g2: muestra.v > props.intervalo })}>\r\n                <td>{muestra.cod}</td>\r\n                <td className='right aligned'>{accounting.formatNumber(muestra.v)}</td>\r\n                <td className='right aligned'>{accounting.formatNumber(muestra.r)}</td>\r\n                <td className='right aligned'>{accounting.formatNumber(muestra.v - muestra.r)}</td>\r\n                <td className='right aligned'>{accounting.formatNumber(100 * (muestra.v - muestra.r) / muestra.v)}%</td>\r\n                <td className='right aligned'>{accounting.formatNumber(error_proyectado)}</td>\r\n              </tr>\r\n            )\r\n          })}\r\n        </tbody>\r\n        <tfoot>\r\n          <tr className='totals'>\r\n            <td>{_.size(props.muestras)} partidas</td>\r\n            <td className='right aligned' colSpan={4}>\r\n              Total Error Proyectado\r\n            </td>\r\n            <td className='right aligned'>{accounting.formatNumber(total_error_proyectado)}</td>\r\n          </tr>\r\n        </tfoot>\r\n      </table>\r\n    )\r\n  }\r\n}\r\n\r\nexport const ConclusionTooltip = () => {\r\n  const [ open, setOpen ] = useState(false)\r\n\r\n  const onClick = (ev: SyntheticEvent) => {\r\n    ev.preventDefault()\r\n    setOpen(!open)\r\n  }\r\n\r\n  return (\r\n    <div>\r\n      <a href='#' style={{ display: 'block', textAlign: 'right', marginBottom: 5 }} onClick={onClick}>\r\n        <i className='info circle icon' /> {open ? 'Ocultar' : 'Mostrar'} sugerencia\r\n      </a>\r\n      {open && (\r\n        <div\r\n          className='conclusion-tooltip'\r\n          dangerouslySetInnerHTML={{ __html: getvalue(app.vars.texts, 'tooltip.muestreo.conclusion') }}\r\n        />\r\n      )}\r\n      <div className='clearfix' />\r\n    </div>\r\n  )\r\n}\r\n\r\nexport class FormFichaTecnica extends PureComponent<{ isReadOnly: boolean; id_muestreo: string; id_visita: string }> {\r\n  formRef = createRef<HTMLFormElement>()\r\n\r\n  onClick = (ev: SyntheticEvent) => {\r\n    ev.preventDefault()\r\n    ev.stopPropagation()\r\n\r\n    if (this.props.isReadOnly) {\r\n      $(this.formRef.current).submit()\r\n    } else {\r\n      bootbox.warningConfirm(\r\n        '¿Desea generar la ficha técnica para esta muestra?.<br><br>Tenga en cuenta que una vez generada la ficha técnica, esta muestra ya no podrá ser modificada.',\r\n        'Cancelar',\r\n        'Aceptar',\r\n        (r) => {\r\n          if (r) {\r\n            $(this.formRef.current).submit()\r\n            setTimeout(function() {\r\n              location.reload()\r\n            }, 1000)\r\n          }\r\n        }\r\n      )\r\n    }\r\n  }\r\n\r\n  render() {\r\n    return (\r\n      <form\r\n        ref={this.formRef}\r\n        data-submit-block='off'\r\n        target='_blank'\r\n        action={url_for2(\r\n          `proyecto/:id_proyecto/paso/${app.vars.idpaso}/visita/${this.props.id_visita}/muestreo/${this.props\r\n            .id_muestreo}/pdf.pdf`\r\n        )}\r\n        method='post'\r\n        id='fichatecnicaform'\r\n      >\r\n        <button type='button' className='btn btn-lg btn-warning' onClick={this.onClick}>\r\n          <span className='icon-moon-file-pdf' /> Ver Ficha Técnica\r\n        </button>\r\n      </form>\r\n    )\r\n  }\r\n}\r\n","/// <reference path=\"./index.d.ts\" />\r\n\r\ndeclare var jStat: any\r\n\r\nexport const calculateTamanoMuestra = (cf_n: number, cf_p: number, cf_z: number, cf_e: number) => {\r\n  const cf_q: number = Math.round((1 - cf_p) * 10) / 10\r\n\r\n  const n1: number = cf_p * cf_q\r\n  const n2: number = Math.abs(jStat.studentt.inv((1 - cf_z) / 2, 100000))\r\n  const n3: number = Math.pow(cf_e / 100 / n2, 2)\r\n  const n4: number = n1 / cf_n\r\n\r\n  return Math.round(n1 / (n3 + n4))\r\n}\r\n\r\nexport const generarMuestras = (muestrasOriginal: MuestraItem[], tamano_muestra: number) => {\r\n  let muestras = _.clone(muestrasOriginal, true)\r\n\r\n  muestras = _.shuffle(muestras) // desordena\r\n  muestras = _.take(muestras, tamano_muestra) // toma las N primeras\r\n  muestras = _.sortBy(muestras, 'cod') // Las vuelve a ordenar\r\n\r\n  return muestras\r\n}\r\n","/// <reference path=\"./index.d.ts\" />\r\n\r\ndeclare var jStat: any\r\n\r\nconst roundup2 = (number: number): number => {\r\n  let rounded_number = Math.round(number * 100) / 100\r\n\r\n  if (rounded_number < number) {\r\n    rounded_number += 0.01\r\n  }\r\n\r\n  return rounded_number\r\n}\r\n\r\nconst gammaInv = (probability: number, alpha: number): number => {\r\n  return jStat.gamma.inv(probability, alpha, 1)\r\n}\r\n\r\nexport const calculateFactorConfianza = (nivel_confianza: number): number => {\r\n  return roundup2(gammaInv(nivel_confianza / 100, 1))\r\n}\r\n\r\nexport const calculateTamanoMuestra = (\r\n  volumen_poblacion: number,\r\n  factor_confianza: number,\r\n  error_tolerable: number\r\n) => {\r\n  return Math.round(volumen_poblacion * factor_confianza / error_tolerable)\r\n}\r\n\r\nexport const generarMuestras = (muestrasOriginal: MuestraItem[], tamano_muestra: number, intervalo: number) => {\r\n  let muestras = _.clone(muestrasOriginal, true)\r\n  muestras = _.filter(muestras, (item) => item.v > 0)\r\n\r\n  const muestras_e = _.filter(muestras, (item) => item.v >= intervalo)\r\n\r\n  if (muestras_e.length > tamano_muestra) {\r\n    muestras = _.take(_.sortBy(muestras_e, 'v'), tamano_muestra)\r\n  } else {\r\n    let muestras_s = _.filter(muestras, (item) => item.v < intervalo)\r\n    let volumen_s = 0\r\n    muestras_s.forEach((item) => {\r\n      volumen_s += item.v\r\n    })\r\n\r\n    const tamano_muestra_s = tamano_muestra - muestras_e.length\r\n    const intervalo_s = volumen_s / tamano_muestra_s\r\n    const seed_s = Math.floor(Math.random() * intervalo_s) + 1\r\n    let muestras_s_tmp = _.shuffle(muestras_s)\r\n    muestras_s = []\r\n\r\n    let interval_k = 0\r\n    let interval_acumulado = 0\r\n    for (let k in muestras_s_tmp) {\r\n      if (interval_k >= tamano_muestra_s) {\r\n        break\r\n      }\r\n\r\n      const item = muestras_s_tmp[k]\r\n      interval_acumulado += item.v\r\n\r\n      const acumulado_item = seed_s + interval_k * intervalo_s\r\n      if (interval_acumulado >= acumulado_item) {\r\n        muestras_s.push(item)\r\n        interval_k++\r\n      }\r\n    }\r\n\r\n    muestras = _.union(muestras_e, muestras_s)\r\n  }\r\n\r\n  muestras = _.sortBy(muestras, 'cod') // Las ordeno por codigo\r\n\r\n  return muestras\r\n}\r\n\r\nexport const calculatePrecision = (\r\n  muestras: MuestraItem[],\r\n  intervalo: number,\r\n  factor_confianza: number,\r\n  nivel_confianza: number\r\n) => {\r\n  const hasMuestrasErradas = (muestra: MuestraItem) => {\r\n    const diff = muestra.v - muestra.r\r\n    return !isNaN(diff) && diff != 0\r\n  }\r\n\r\n  if (!_.any(muestras, hasMuestrasErradas)) {\r\n    // Si no hay muestras con errores, la precision es 0.\r\n    return 0\r\n  }\r\n\r\n  const riesgo_aceptacion: number = Math.floor(100 - nivel_confianza)\r\n\r\n  let tolerancia_incremental: number = 0\r\n  let items_inferiores: { error_proyectado: number }[] = []\r\n\r\n  _.each(muestras, (muestra) => {\r\n    const diff: number = muestra.v - muestra.r\r\n    if (!isNaN(diff)) {\r\n      if (diff == 0) {\r\n        return\r\n      }\r\n\r\n      const contaminacion = (muestra.v - muestra.r) / muestra.v\r\n      const error_proyectado = muestra.v > intervalo ? muestra.v - muestra.r : contaminacion * intervalo\r\n\r\n      if (muestra.v <= intervalo) {\r\n        items_inferiores.push({ error_proyectado })\r\n      }\r\n    }\r\n  })\r\n\r\n  items_inferiores = _.sortBy(items_inferiores, 'error_proyectado').reverse()\r\n  let total_error_proyectado_inferiores: number = 0\r\n  for (let k in items_inferiores) {\r\n    let factor_incremental = roundup2(gammaInv(1 - riesgo_aceptacion / 100, 1 + parseInt(k) + 1))\r\n    factor_incremental -= roundup2(gammaInv(1 - riesgo_aceptacion / 100, 1 + parseInt(k)))\r\n    factor_incremental = Math.round(factor_incremental * 100) / 100\r\n\r\n    tolerancia_incremental += items_inferiores[k]['error_proyectado'] * factor_incremental\r\n    total_error_proyectado_inferiores += items_inferiores[k]['error_proyectado']\r\n  }\r\n\r\n  const precision_basica: number = intervalo * factor_confianza\r\n\r\n  tolerancia_incremental -= total_error_proyectado_inferiores\r\n\r\n  return precision_basica + tolerancia_incremental\r\n}\r\n","declare var app: any\r\n\r\nexport const isEmpty = (value: any) => {\r\n  if (_.isNumber(value)) {\r\n    return false\r\n  }\r\n\r\n  return _.size(value) == 0\r\n}\r\n\r\nexport const cacheMuestra = (muestra: MuestraItem) => {\r\n  const cacheKey = `muestras_${app.vars.ID_MUESTREO}`\r\n  let muestras: { [s: string]: number }\r\n  let muestrasBackup = localStorage.getItem(cacheKey)\r\n  muestras = !muestrasBackup ? {} : JSON.parse(muestrasBackup)\r\n  if (isEmpty(muestra.r)) {\r\n    muestras = _.omit(muestras, muestra.cod)\r\n  } else {\r\n    muestras[muestra.cod] = parseFloat(muestra.r + '')\r\n  }\r\n\r\n  localStorage.setItem(cacheKey, JSON.stringify(muestras))\r\n}\r\n\r\nexport const getCacheAllMuestra = () => {\r\n  const cacheKey = `muestras_${app.vars.ID_MUESTREO}`\r\n  let muestras: { [s: string]: number }\r\n  let muestrasBackup = localStorage.getItem(cacheKey)\r\n  muestras = !muestrasBackup ? {} : JSON.parse(muestrasBackup)\r\n\r\n  return muestras\r\n}\r\n","module.exports = React;","module.exports = ReactDOM;"],"sourceRoot":""}